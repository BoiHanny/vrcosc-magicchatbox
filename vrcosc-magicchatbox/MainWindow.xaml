<Window
    x:Class="vrcosc_magicchatbox.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:vrcosc_magicchatbox.Classes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:vrcosc_magicchatbox.ViewModels"
    Title="MagicChatbox by BoiHanny"
    Width="900"
    Height="675"
    MinWidth="1000"
    MinHeight="500"
    VerticalAlignment="Bottom"
    d:DataContext="{d:DesignInstance Type=vm:ViewModel,
                                     IsDesignTimeCreatable=True}"
    IsEnabled="{Binding AppIsEnabled, UpdateSourceTrigger=PropertyChanged}"
    Opacity="{Binding AppOpacity, UpdateSourceTrigger=PropertyChanged}"
    Topmost="{Binding Topmost, UpdateSourceTrigger=PropertyChanged}"
    WindowStartupLocation="CenterScreen"
    WindowStyle="SingleBorderWindow"
    mc:Ignorable="d">

    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="55"
            CornerRadius="0"
            GlassFrameThickness="1"
            ResizeBorderThickness="8"
            UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>

    <Window.DataContext>
        <vm:ViewModel />
    </Window.DataContext>

    <Window.Resources>
        <ResourceDictionary>
            <local:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />

            <local:CharacterCountToBoolConverter x:Key="CharacterCountToBoolConverter" />
            <local:BoolToBlurEffectConverter x:Key="BoolToBlurEffectConverter" />
            <local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter" />
            <local:InverseBoolToHiddenConverter x:Key="InverseBoolToHiddenConverter" />
            <local:InvertBooleanConverter x:Key="InvertBooleanConverter" />
            <local:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
            <local:EnumDescriptionConverter x:Key="EnumDescriptionConverter" />
            <local:ColumnWidthConverter x:Key="ColumnWidthConverter" />
            <Style x:Key="FocusVisual">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Rectangle
                                Margin="2"
                                SnapsToDevicePixels="true"
                                Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                StrokeDashArray="1 2"
                                StrokeThickness="1" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="CharacterCountTextStyle" TargetType="TextBlock">
                <Setter Property="Foreground" Value="#94CCBF" />
                <Setter Property="Opacity" Value="0.3" />
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IntelliChatModule.Settings.IntelliChatTxt.Length, Converter={StaticResource CharacterCountToBoolConverter}}" Value="True">
                        <Setter Property="Foreground" Value="PaleVioletRed" />
                        <Setter Property="Opacity" Value="1" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <SolidColorBrush x:Key="Button.Static.Background" Color="#FFDDDDDD" />
            <SolidColorBrush x:Key="Button.Static.Border" Color="#FF707070" />
            <SolidColorBrush x:Key="Button.MouseOver.Background" Color="#FFBEE6FD" />
            <SolidColorBrush x:Key="Button.MouseOver.Border" Color="#FF3C7FB1" />
            <SolidColorBrush x:Key="Button.Pressed.Background" Color="#FFC4E5F6" />
            <SolidColorBrush x:Key="Button.Pressed.Border" Color="#FF2C628B" />
            <SolidColorBrush x:Key="Button.Disabled.Background" Color="#FFF4F4F4" />
            <SolidColorBrush x:Key="Button.Disabled.Border" Color="#FFADB2B5" />
            <SolidColorBrush x:Key="Button.Disabled.Foreground" Color="#FF838383" />
            <Style x:Key="Activatebutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5,0,0,5"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#564BA0" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#564BA0" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#5D559B" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#5D559B" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="Favbutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="0,5,5,0"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#564BA0" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#564BA0" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#5D559B" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#5D559B" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="Deletebutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#56477F" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#56477F" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#625191" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#625191" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="DisconnectPulsoid" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#A32222" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#A32222" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#BD4444" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#BD4444" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="CancelEditbutton" TargetType="{x:Type Button}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsDefaulted" Value="true">
                                    <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#7F0000" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#7F0000" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#8C0000" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#8C0000" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource Button.Disabled.Background}" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource Button.Disabled.Border}" />
                                    <Setter TargetName="contentPresenter" Property="TextElement.Foreground" Value="{StaticResource Button.Disabled.Foreground}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="Editbutton" TargetType="{x:Type ToggleButton}">
                <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}" />
                <Setter Property="Background" Value="{StaticResource Button.Static.Background}" />
                <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}" />
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Padding" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                            <Border
                                x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5,0,0,5"
                                SnapsToDevicePixels="true">
                                <ContentPresenter
                                    x:Name="contentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Focusable="False"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#564BA0" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#564BA0" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#5D559B" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#5D559B" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="true">
                                    <Setter TargetName="border" Property="Background" Value="#240F53" />
                                    <Setter TargetName="border" Property="BorderBrush" Value="#240F53" />

                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>


    <Border
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        Background="#FF240E55"
        BorderBrush="#FF240E55"
        BorderThickness="1">
        <Border.Effect>
            <BlurEffect
                d:Radius="0"
                KernelType="Gaussian"
                Radius="{Binding MainWindowBlurEffect}" />
        </Border.Effect>
        <Grid HorizontalAlignment="Stretch" Background="#FF3B3054">


            <Grid.RowDefinitions>
                <RowDefinition Height="55" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="225" />
            </Grid.ColumnDefinitions>



            <Grid
                Grid.Row="1"
                d:Visibility="Collapsed"
                Background="#FF3B3054"
                Visibility="{Binding MenuItem_1_Visibility}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="31" />
                    <RowDefinition Height="35" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="40" />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>

                <Grid Background="#FF41375C">
                    <StackPanel
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <TextBlock
                            Grid.Column="0"
                            FontFamily="Albert Sans Thin"
                            FontSize="16"
                            Foreground="#AAA3B7"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Text="Here you can add ur personal message to the chatbox!">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="10"
                                    Opacity="1"
                                    ShadowDepth="0"
                                    Color="#251153" />
                            </TextBlock.Effect>
                        </TextBlock>
                    </StackPanel>
                </Grid>
                <ScrollViewer
                    Name="Statusitems"
                    Grid.Row="2"
                    Visibility="Visible">
                    <ItemsControl
                        Width="710"
                        Height="auto"
                        Margin="5"
                        ItemsSource="{Binding StatusList}">
                        <ItemsControl.Resources>
                            <Style x:Key="ActiveStatusText" TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsActive}" Value="True">
                                        <Setter Property="Foreground" Value="#FF9DDAA8" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsActive}" Value="False">
                                        <Setter Property="Foreground" Value="LightGray" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                            <Style x:Key="ActiveStatusTextEdit" TargetType="TextBox">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsActive}" Value="True">
                                        <Setter Property="Foreground" Value="#FF9DDAA8" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsActive}" Value="False">
                                        <Setter Property="Foreground" Value="LightGray" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ItemsControl.Resources>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Margin="5"
                                    Background="DarkSlateBlue"
                                    CornerRadius="5">
                                    <Grid>
                                        <Border
                                            Width="auto"
                                            Height="auto"
                                            Background="DarkSlateBlue"
                                            BorderThickness="0"
                                            CornerRadius="5">
                                            <Border.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="8"
                                                    Direction="0"
                                                    Opacity="0.9"
                                                    RenderingBias="Performance"
                                                    ShadowDepth="0"
                                                    Color="black" />
                                            </Border.Effect>
                                        </Border>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="35" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="35" />
                                                <ColumnDefinition Width="30" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="25" />
                                                <ColumnDefinition Width="35" />
                                            </Grid.ColumnDefinitions>
                                            <Border
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Background="#3A1F73">
                                                <Image
                                                    Width="22"
                                                    Height="22"
                                                    Source="/Img/Icons/ActivatedStatus_ico.png"
                                                    Stretch="Uniform">
                                                    <Image.Effect>
                                                        <DropShadowEffect
                                                            BlurRadius="15"
                                                            RenderingBias="Performance"
                                                            ShadowDepth="0"
                                                            Color="LimeGreen" />
                                                    </Image.Effect>
                                                </Image>
                                            </Border>



                                            <ToggleButton
                                                x:Name="Editbutton"
                                                Grid.Row="0"
                                                Grid.Column="3"
                                                Width="25"
                                                Height="35"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#483472"
                                                BorderThickness="0"
                                                Checked="Editbutton_Checked"
                                                Cursor="Hand"
                                                IsChecked="{Binding IsEditing}"
                                                Style="{DynamicResource Editbutton}"
                                                Tag="{Binding}"
                                                Unchecked="Editbutton_Checked">
                                                <Grid>
                                                    <Image
                                                        Width="15"
                                                        Height="15"
                                                        RenderOptions.BitmapScalingMode="Linear"
                                                        Source="/Img/Icons/Edit_ico.png" />
                                                </Grid>
                                            </ToggleButton>

                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Margin="8,0,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Comfortaa Light"
                                                FontSize="16"
                                                Foreground="DarkSlateBlue"
                                                Style="{StaticResource ActiveStatusText}"
                                                Text="{Binding msg}"
                                                Visibility="{Binding IsEditing, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="18"
                                                        Opacity="0.7"
                                                        RenderingBias="Performance"
                                                        ShadowDepth="0"
                                                        Color="WhiteSmoke" />
                                                </TextBlock.Effect>
                                            </TextBlock>

                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Margin="8,0,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Comfortaa Light"
                                                FontSize="16"
                                                Style="{StaticResource ActiveStatusText}"
                                                Text="{Binding msg}"
                                                Visibility="{Binding IsEditing, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBox
                                                x:Name="EditTextBox"
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Margin="7,0,30,0"
                                                VerticalAlignment="Center"
                                                local:TextBoxBehaviour.HandleEnterKey="True"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                FontFamily="Comfortaa Light"
                                                FontSize="16"
                                                FontWeight="Medium"
                                                IsReadOnly="{Binding IsEditing, Converter={StaticResource InvertBooleanConverter}, UpdateSourceTrigger=PropertyChanged}"
                                                Style="{StaticResource ActiveStatusTextEdit}"
                                                Text="{Binding editMsg}"
                                                Visibility="{Binding IsEditing, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                <TextBox.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="18"
                                                        Opacity="0.9"
                                                        RenderingBias="Performance"
                                                        ShadowDepth="0"
                                                        Color="#B0E6FC" />
                                                </TextBox.Effect>
                                            </TextBox>



                                            <Button
                                                x:Name="CancelEditbutton"
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Width="20"
                                                Height="20"
                                                Margin="0,0,5,0"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Center"
                                                Background="#6B0000"
                                                BorderThickness="0"
                                                Click="CancelEditbutton_Click"
                                                Cursor="Hand"
                                                Style="{DynamicResource CancelEditbutton}"
                                                Tag="{Binding}"
                                                Visibility="{Binding IsEditing, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                <Grid>
                                                    <Image
                                                        Width="15"
                                                        Height="15"
                                                        Source="/Img/Icons/Cross_ico.png" />
                                                </Grid>
                                            </Button>

                                            <Button
                                                Name="Activatebutton"
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Width="35"
                                                Height="35"
                                                Margin="0,0,0,0"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#3A1F73"
                                                BorderThickness="0"
                                                Command="{Binding DataContext.ActivateStatusCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                CommandParameter="{Binding}"
                                                Cursor="Hand"
                                                Style="{DynamicResource Activatebutton}"
                                                Visibility="{Binding IsActive, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                <Image
                                                    Width="22"
                                                    Height="22"
                                                    Source="/Img/Icons/ActivateStatus_ico.png"
                                                    Stretch="Uniform" />
                                            </Button>

                                            <Button
                                                x:Name="Deletebutton"
                                                Grid.Row="0"
                                                Grid.Column="1"
                                                Width="30"
                                                Height="35"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#3F2970"
                                                BorderThickness="0"
                                                Click="DeleteButton_Click"
                                                Cursor="Hand"
                                                Style="{DynamicResource Deletebutton}"
                                                Tag="{Binding}">
                                                <Grid>
                                                    <Image
                                                        Width="20"
                                                        Height="20"
                                                        Source="/Img/Icons/Delete_ico.png" />
                                                </Grid>
                                            </Button>

                                            <Button
                                                Name="Favbutton"
                                                Grid.Row="0"
                                                Grid.Column="4"
                                                Width="35"
                                                Height="35"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Background="#3A1F73"
                                                BorderThickness="0"
                                                Click="Favbutton_Click"
                                                Cursor="Hand"
                                                Style="{DynamicResource Favbutton}">
                                                <Grid>
                                                    <Image Width="22" Height="22">
                                                        <Image.Style>
                                                            <Style>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding UseInCycle}" Value="True">
                                                                        <Setter Property="Image.Source" Value="/Img/Icons/Unfavorite_ico.png" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding UseInCycle}" Value="False">
                                                                        <Setter Property="Image.Source" Value="/Img/Icons/Favorite_ico.png" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Image.Style>
                                                    </Image>
                                                    <CheckBox
                                                        Width="35"
                                                        Height="35"
                                                        IsChecked="{Binding UseInCycle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        Opacity="0" />
                                                </Grid>
                                            </Button>

                                        </Grid>
                                    </Grid>

                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
                <Grid
                    Grid.Row="4"
                    Width="auto"
                    Height="auto"
                    Margin="0,10"
                    HorizontalAlignment="Center">

                    <Button
                        x:Name="AddFav"
                        Width="75"
                        HorizontalAlignment="Right"
                        Click="AddFav_Click"
                        Content="Create"
                        Style="{DynamicResource Status_Button_style}" />

                    <StackPanel Orientation="Horizontal">
                        <Grid>
                            <TextBox
                                x:Name="NewFavText"
                                Width="630"
                                MinHeight="40"
                                Margin="-15,0,70,0"
                                Padding="8,0,58,0"
                                HorizontalContentAlignment="Left"
                                VerticalContentAlignment="Center"
                                Background="#FF7B7195"
                                BorderThickness="0"
                                FontSize="15"
                                Foreground="#FF240E54"
                                KeyDown="FavBox_KeyDown"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Text="{Binding NewStatusItemTxt, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                TextAlignment="Left"
                                TextChanged="NewFavText_TextChanged">
                                <TextBox.Resources>
                                    <Style TargetType="{x:Type Border}">
                                        <Setter Property="CornerRadius" Value="5" />
                                    </Style>
                                </TextBox.Resources>
                                <TextBox.Effect>
                                    <DropShadowEffect
                                        BlurRadius="5"
                                        Direction="-23"
                                        RenderingBias="Performance"
                                        ShadowDepth="0"
                                        Color="DarkBlue" />
                                </TextBox.Effect>
                            </TextBox>

                            <TextBlock
                                Width="auto"
                                Margin="0,0,78,0"
                                Padding="0,3,0,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="{Binding StatusBoxColor}"
                                Text="{Binding StatusBoxCount}" />

                            <TextBlock
                                Width="630"
                                Height="40"
                                Margin="-15,0,70,0"
                                Padding="8,9,5,0"
                                VerticalAlignment="Center"
                                FontSize="15"
                                Foreground="#FF3D2F5F"
                                IsHitTestVisible="False"
                                Text="Create here a new status"
                                TextAlignment="Left">
                                <TextBlock.Style>
                                    <Style TargetType="{x:Type TextBlock}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Text, ElementName=NewFavText}" Value="">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding ElementName=NewFavText, Path=IsFocused}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>

                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </StackPanel>



                </Grid>
                <Grid
                    Grid.Row="3"
                    HorizontalAlignment="Stretch"
                    Background="#FF493F65">
                    <Grid.Effect>
                        <DropShadowEffect
                            BlurRadius="10"
                            Direction="90"
                            Opacity="0.5"
                            RenderingBias="Performance"
                            ShadowDepth="5"
                            Color="#FF7F759A" />
                    </Grid.Effect>
                    <TextBlock
                        Grid.Column="0"
                        Margin="16,0,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontFamily="Albert Sans Thin"
                        FontSize="16"
                        Foreground="#FF9983AD"
                        Text="{Binding StatusTopBarTxt}" />

                </Grid>
                <Grid Grid.Row="1" Background="#FF493F65">
                    <Grid.Effect>
                        <DropShadowEffect
                            BlurRadius="10"
                            Direction="-90"
                            Opacity="0.5"
                            RenderingBias="Performance"
                            ShadowDepth="5"
                            Color="#FF7F759A" />
                    </Grid.Effect>
                    <StackPanel
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Button
                            x:Name="SortUsed"
                            Width="auto"
                            Height="25"
                            Margin="3,0,3,0"
                            Padding="5,0"
                            Click="SortUsed_Click"
                            Content="Recently used"
                            Style="{DynamicResource Status_Button_style}" />
                        <Button
                            x:Name="SortFav"
                            Width="auto"
                            Height="25"
                            Margin="3,0,3,0"
                            Padding="5,0"
                            Click="SortFav_Click"
                            Content="My 💛 cycles"
                            Style="{DynamicResource Status_Button_style}" />
                        <Button
                            x:Name="SortDate"
                            Width="auto"
                            Height="25"
                            Margin="3,0,3,0"
                            Padding="5,0"
                            Click="SortDate_Click"
                            Content="Creation date"
                            Style="{DynamicResource Status_Button_style}" />
                        <Button
                            x:Name="SortEdited"
                            Width="auto"
                            Height="25"
                            Margin="3,0,3,0"
                            Padding="5,0"
                            Click="SortEdited_Click"
                            Content="Edit date"
                            Style="{DynamicResource Status_Button_style}" />

                        <ToggleButton
                            Width="85"
                            Height="25"
                            Margin="3,0,3,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Content="Auto 💛 cycle"
                            IsChecked="{Binding CycleStatus, Mode=TwoWay}"
                            Style="{StaticResource GlowyToggleButton}" />
                        <Button
                            x:Name="Settings"
                            Width="auto"
                            Margin="3,0,3,0"
                            Command="{Binding ActivateSettingCommand}"
                            CommandParameter="Settings_Status"
                            Opacity="0.6"
                            Style="{DynamicResource LINK_Button_style}">
                            <StackPanel Orientation="Horizontal">
                                <Image
                                    Width="18"
                                    Height="18"
                                    RenderOptions.BitmapScalingMode="HighQuality"
                                    Source="/Img/Icons/Next_ico.png" />
                            </StackPanel>
                        </Button>
                    </StackPanel>

                </Grid>
            </Grid>

            <ScrollViewer
                Grid.Row="1"
                d:Visibility="Collapsed"
                Background="#FF3B3054"
                Visibility="{Binding MenuItem_3_Visibility}">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_Status, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Status options"
                                TextOptions.TextRenderingMode="ClearType" />

                        </Grid>


                        <Grid
                            x:Name="Settings_Status_Grid"
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            Visibility="{Binding Settings_Status, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel Margin="5">

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">

                                    <CheckBox
                                        x:Name="StatusIconPrefix_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding PrefixIconStatus, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Add 💬 as prefix for the personal status
                                    </CheckBox>



                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">

                                    <StackPanel>
                                        <CheckBox
                                            x:Name="EnableEmojiShuffle_checkbox"
                                            Height="20"
                                            Margin="5"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding EnableEmojiShuffle, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Enable custom prefix icon shuffle
                                        </CheckBox>
                                        <StackPanel Visibility="{Binding EnableEmojiShuffle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Width="auto"
                                                Padding="4,0,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                Foreground="#FF9983AD"
                                                Text="Make sure to add the emojis you want to cycle through in the text box below, separated by a space a comma." />
                                            <TextBox
                                                Height="26"
                                                MinWidth="50"
                                                MaxWidth="630"
                                                Margin="4,3,0,10"
                                                Padding="5,0,5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding EmojiListString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock
                                                Width="auto"
                                                Padding="4,5,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                Foreground="#FF9983AD"
                                                Text="Here you can add your custom emojis to cycle through." />
                                            <StackPanel Orientation="Horizontal">

                                                <TextBox
                                                    x:Name="EmojiNew"
                                                    Width="auto"
                                                    Height="30"
                                                    MinWidth="25"
                                                    Margin="5"
                                                    Padding="5,0,5,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalContentAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    PreviewKeyUp="EmojiNew_PreviewKeyUp"
                                                    Text="" />
                                                <Button
                                                    x:Name="AddEmojiButton"
                                                    Width="auto"
                                                    Height="30"
                                                    Padding="5"
                                                    Click="AddEmojiButton_Click"
                                                    Style="{StaticResource Status_Button_style}">
                                                    <Button.ContentTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image
                                                                    Width="21"
                                                                    Height="18"
                                                                    Margin="0,0,3,0"
                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                    Source="/Img/Icons/Add.png" />
                                                                <TextBlock
                                                                    Margin="0,-2,5,0"
                                                                    VerticalAlignment="Center"
                                                                    FontSize="14"
                                                                    Text="Add emoji to cycle" />
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </Button.ContentTemplate>
                                                </Button>
                                            </StackPanel>
                                        </StackPanel>







                                    </StackPanel>




                                </Border>
                                <Border
                                    Margin="5,5,0,5"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding IzuruBaeMode, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <Border.Background>
                                        <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                            <GradientStop Color="#FF40365B" />
                                            <GradientStop Offset="1" Color="#FFEA005E" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <StackPanel>
                                        <Grid>
                                            <TextBlock
                                                Padding="4,5,9,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="17"
                                                FontWeight="DemiBold"
                                                Foreground="White"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                Text="IzuruBae's custom status icon">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="5"
                                                        Direction="0"
                                                        ShadowDepth="0"
                                                        Color="White" />
                                                </TextBlock.Effect>
                                            </TextBlock>
                                        </Grid>
                                        <StackPanel Margin="5,4,0,5" Orientation="Horizontal">
                                            <TextBlock
                                                Padding="0,0,4,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="White"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                Text="Make it like:">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="5"
                                                        Direction="0"
                                                        ShadowDepth="0"
                                                        Color="White" />
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBox
                                                x:Name="CustomIcon"
                                                Width="auto"
                                                Height="auto"
                                                MinWidth="20"
                                                Margin="0,0,0,0"
                                                Padding="5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="White"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding EggPrefixIconStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                TextAlignment="Center" />
                                        </StackPanel>
                                    </StackPanel>



                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="CycleStatus_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding CycleStatus, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Cycle status items that are marked with 💛
                                    </CheckBox>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding CycleStatus, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">

                                    <CheckBox
                                        x:Name="IsRandomCycling_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding IsRandomCycling, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Cycle status items in random order
                                    </CheckBox>


                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding CycleStatus, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5" Orientation="Horizontal">
                                        <TextBlock
                                            Padding="0,0,9,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="Cycle to the next every" />
                                        <TextBox
                                            x:Name="SwitchStatusInterval"
                                            Width="auto"
                                            Height="auto"
                                            Margin="0,0,0,0"
                                            Padding="5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding SwitchStatusInterval, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            TextAlignment="Center" />
                                        <TextBlock
                                            Padding="5,0,5,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="seconds" />

                                    </StackPanel>

                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="AFK Detection" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="You can show a custom message when you are AFK" />

                                        <CheckBox
                                            x:Name="EnableAFKDetectCheck"
                                            Height="20"
                                            Margin="4,5,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding AfkModule.Settings.EnableAfkDetection, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Enable AFK detection
                                        </CheckBox>

                                        <CheckBox
                                            Height="20"
                                            Margin="4,5,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding AfkModule.Settings.ActivateInVR, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Enable When in VR
                                        </CheckBox>


                                        <StackPanel Margin="5" Orientation="Horizontal">
                                            <TextBlock
                                                Padding="0,0,4,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="Timeout time in" />
                                            <TextBox
                                                x:Name="TimeoutTime"
                                                Width="auto"
                                                Height="auto"
                                                Margin="0,0,0,0"
                                                Padding="5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding AfkModule.Settings.AfkTimeout, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                TextAlignment="Center" />

                                            <TextBlock
                                                Padding="4,0,2,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="seconds" />

                                            <TextBlock
                                                Margin="0,-5,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="12"
                                                FontStyle="Italic"
                                                Foreground="#FF9983AD"
                                                Text="{Binding AfkModule.FriendlyTimeoutTime, UpdateSourceTrigger=PropertyChanged}" />

                                        </StackPanel>

                                        <CheckBox
                                            Height="20"
                                            Margin="4,5,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding AfkModule.Settings.ShowPrefixIcon, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Show prefix icon
                                        </CheckBox>

                                        <CheckBox
                                            Height="20"
                                            Margin="4,5,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding AfkModule.Settings.ShowAFKTime, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Show how long you are AFK
                                        </CheckBox>
                                        <CheckBox
                                            Height="20"
                                            Margin="4,5,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding AfkModule.Settings.UseSmallLettersForDuration, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Visibility="{Binding AfkModule.Settings.ShowAFKTime, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            Use small letters for duration suffix
                                        </CheckBox>
                                        <TextBlock
                                            Padding="4,5,9,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="AFK style" />
                                        <StackPanel Margin="4,0,0,0" Orientation="Horizontal">

                                            <TextBox
                                                Width="auto"
                                                Height="26"
                                                Margin="0,3,0,0"
                                                Padding="5,0,5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding AfkModule.Settings.AfkPrefix, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Visibility="{Binding AfkModule.Settings.ShowPrefixIcon, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBox
                                                Width="auto"
                                                Height="26"
                                                Margin="5,3,0,0"
                                                Padding="5,0,5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding AfkModule.Settings.AfkMessageForTimeStamp, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Visibility="{Binding AfkModule.Settings.ShowAFKTime, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBox
                                                Width="auto"
                                                Height="26"
                                                Margin="4,3,0,0"
                                                Padding="5,0,5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding AfkModule.Settings.AfkMessageWithoutTimeStamp, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Visibility="{Binding AfkModule.Settings.ShowAFKTime, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                        </StackPanel>
                                        <StackPanel Visibility="{Binding BussyBoysMode, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">

                                            <TextBlock
                                                Padding="4,15,9,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="19"
                                                Foreground="#FF9983AD"
                                                Text="Bussy Boys (custom counting from date and more)" />

                                            <CheckBox
                                                Height="20"
                                                Margin="4,5,4,4"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding BussyBoysMultiMODE, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}">
                                                Allow personal AFK + Status
                                            </CheckBox>

                                            <CheckBox
                                                Height="20"
                                                Margin="4,5,4,4"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding BussyBoysDateEnable, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}">
                                                Start custom counting ↴
                                            </CheckBox>

                                            <DatePicker
                                                Width="250"
                                                Margin="3,5,4,4"
                                                HorizontalAlignment="Left"
                                                BorderThickness="0"
                                                Foreground="#FF240E54"
                                                IsTodayHighlighted="True"
                                                Opacity="0.5"
                                                SelectedDate="{Binding BussyBoysDate, Mode=TwoWay}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                        </Grid>
                    </Grid>
                    <Grid Grid.Row="1" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">

                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_HeartRate, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Pulsoid heart rate options"
                                TextOptions.TextRenderingMode="ClearType" />

                            <TextBlock
                                x:Name="LearnMoreAboutHeartbtn"
                                Width="auto"
                                Margin="205,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FF31B7B4"
                                MouseUp="LearnMoreAboutHeartbtn_MouseUp"
                                Text="Learn more"
                                TextDecorations="Underline" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            d:Visibility="Collapsed"
                            Visibility="{Binding Settings_HeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <Border
                                    Width="500"
                                    Height="auto"
                                    Margin="0,0,10,15"
                                    HorizontalAlignment="Left"
                                    CornerRadius="5">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0.3,0" EndPoint="0.5,1">
                                            <GradientStop Color="#05B4A8" />
                                            <GradientStop Offset="1" Color="#403670" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <Border.Effect>
                                        <DropShadowEffect
                                            BlurRadius="25"
                                            Direction="-90"
                                            Opacity="0.9"
                                            RenderingBias="Performance"
                                            ShadowDepth="5"
                                            Color="#05B4A8" />
                                    </Border.Effect>
                                    <Grid Margin="3">

                                        <StackPanel Orientation="Vertical">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock
                                                    Width="auto"
                                                    Padding="5,5,0,0"
                                                    HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Top"
                                                    Background="Transparent"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="20"
                                                    FontWeight="Bold"
                                                    Foreground="Gold"
                                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                    Text="15% OFF"
                                                    TextWrapping="Wrap">
                                                    <TextBlock.Effect>
                                                        <DropShadowEffect
                                                            BlurRadius="20"
                                                            Opacity="1"
                                                            RenderingBias="Performance"
                                                            ShadowDepth="0"
                                                            Color="BlueViolet" />
                                                    </TextBlock.Effect>
                                                </TextBlock>
                                                <TextBlock
                                                    Width="auto"
                                                    Padding="5,5,0,0"
                                                    HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Top"
                                                    Background="Transparent"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="20"
                                                    FontWeight="Bold"
                                                    Foreground="#FF240E55"
                                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                    Text="every month on your"
                                                    TextWrapping="Wrap">
                                                    <TextBlock.Effect>
                                                        <DropShadowEffect
                                                            BlurRadius="20"
                                                            Opacity="1"
                                                            RenderingBias="Performance"
                                                            ShadowDepth="0"
                                                            Color="Purple" />
                                                    </TextBlock.Effect>
                                                </TextBlock>
                                                <TextBlock
                                                    Width="auto"
                                                    Padding="5,5,0,0"
                                                    HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Top"
                                                    Background="Transparent"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="20"
                                                    FontWeight="Bold"
                                                    Foreground="Gold"
                                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                    Text="BRO PLAN"
                                                    TextWrapping="Wrap">
                                                    <TextBlock.Effect>
                                                        <DropShadowEffect
                                                            BlurRadius="20"
                                                            Opacity="1"
                                                            RenderingBias="Performance"
                                                            ShadowDepth="0"
                                                            Color="Gold" />
                                                    </TextBlock.Effect>
                                                </TextBlock>
                                            </StackPanel>
                                            <TextBlock
                                                Width="auto"
                                                Padding="7,0,0,0"
                                                HorizontalAlignment="Stretch"
                                                VerticalAlignment="Top"
                                                Background="Transparent"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                FontStyle="Italic"
                                                FontWeight="Medium"
                                                Foreground="DarkGoldenrod"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                Text="Discount applies to new subscriptions only (cancel possible)"
                                                TextWrapping="Wrap">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="7"
                                                        Opacity="1"
                                                        RenderingBias="Performance"
                                                        ShadowDepth="0"
                                                        Color="Purple" />
                                                </TextBlock.Effect>
                                            </TextBlock>


                                        </StackPanel>
                                        <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                                            <Button
                                                Name="PulsoidLearnMoreAboutDiscount_btn"
                                                Height="auto"
                                                Margin="2,0,0,0"
                                                VerticalAlignment="Stretch"
                                                Click="PulsoidLearnMoreAboutDiscount_btn_Click"
                                                Opacity="0.8"
                                                Style="{DynamicResource Status_Button_style}">
                                                <Image
                                                    Width="18"
                                                    Margin="2"
                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                    Source="/Img/Icons/Info_ico.png" />
                                            </Button>
                                            <Button
                                                Name="ApplyLinkPulsoid_btn"
                                                Width="auto"
                                                Height="auto"
                                                Margin="2,0,0,0"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Stretch"
                                                Click="ApplyLinkPulsoid_btn_Click"
                                                Opacity="0.8"
                                                Style="{DynamicResource Status_Button_style}">
                                                <Image
                                                    Width="25"
                                                    Margin="2"
                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                    Source="/Img/Icons/Apply_ico.png" />
                                            </Button>
                                        </StackPanel>








                                    </Grid>

                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Orientation="Horizontal">
                                        <Button
                                            x:Name="ConnectWithPulsoid"
                                            Width="auto"
                                            Height="30"
                                            Padding="5"
                                            Click="ConnectWithPulsoid_Click"
                                            Style="{StaticResource Status_Button_style}"
                                            Visibility="{Binding PulsoidAuthConnected, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image
                                                            Width="21"
                                                            Height="18"
                                                            Margin="0,0,3,0"
                                                            Source="/Img/Icons/Pulsoid.png" />
                                                        <TextBlock
                                                            Margin="0,-2,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            Text="Connect with Pulsoid" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                        <Button
                                            x:Name="ConnectedWithPulsoid"
                                            Width="auto"
                                            Height="30"
                                            Padding="5"
                                            d:Visibility="Visible"
                                            Click="ConnectWithPulsoid_Click"
                                            Style="{StaticResource Status_Button_style}"
                                            Visibility="{Binding PulsoidAuthConnected, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image
                                                            Width="15"
                                                            Height="15"
                                                            Margin="2,0,5,0"
                                                            VerticalAlignment="Center"
                                                            Source="/Img/Icons/yes.png" />
                                                        <TextBlock
                                                            Margin="0,-2,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            Text="Connected with Pulsoid" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                        <Button
                                            x:Name="DisconnectPulsoid"
                                            Grid.Row="0"
                                            Grid.Column="1"
                                            Width="20"
                                            Height="30"
                                            Margin="-5,0,0,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            d:Visibility="Visible"
                                            Background="#8A0000"
                                            BorderThickness="0"
                                            Click="DisconnectPulsoid_Click"
                                            Cursor="Hand"
                                            Style="{DynamicResource DisconnectPulsoid}"
                                            Visibility="{Binding PulsoidAuthConnected, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <Grid>
                                                <Image
                                                    Width="15"
                                                    Height="15"
                                                    RenderOptions.BitmapScalingMode="Linear"
                                                    Source="/Img/Icons/Cross_v1_ico.png" />
                                            </Grid>
                                        </Button>
                                        <Border Visibility="{Binding HeartRateConnector.PulsoidAccessError, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Margin="5,0,0,0"
                                                VerticalAlignment="Center"
                                                Effect="{StaticResource TextBlockShadowEffect}"
                                                FontFamily="Comfortaa Light"
                                                FontSize="12"
                                                FontWeight="Bold"
                                                Foreground="LightSeaGreen"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                Text="No device connected"
                                                Visibility="{Binding HeartRateConnector.PulsoidDeviceOnline, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                        </Border>
                                        <TextBlock
                                            Width="400"
                                            Padding="10,4,0,4"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Foreground="PaleVioletRed"
                                            Text="{Binding HeartRateConnector.PulsoidAccessErrorTxt, UpdateSourceTrigger=PropertyChanged}"
                                            TextWrapping="Wrap"
                                            Visibility="{Binding HeartRateConnector.PulsoidAccessError, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Opacity="0.8"
                                    Visibility="{Binding PulsoidAuthConnected, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            x:Name="ManualPulsoidAuthBtn"
                                            Padding="0,0,9,0"
                                            VerticalAlignment="Center"
                                            Cursor="Hand"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            MouseUp="ManualPulsoidAuthBtn_MouseUp"
                                            Text="Manual web authorization" />
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">

                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="2,0,0,2"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Example: ❤️ 88 bpm. Gives a little heart icon as a prefix." />
                                        <CheckBox
                                            x:Name="MagicHeartRateICON_checkbox"
                                            Margin="2,0"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.MagicHeartIconPrefix, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Show prefix icon in front of the heart rate
                                        </CheckBox>
                                    </StackPanel>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding HeartRateConnector.Settings.MagicHeartIconPrefix, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="2,0,0,4"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Cycle through different heart symbols (❤️, 💖, 💗, etc.) every time your heart rate updates." />
                                        <CheckBox
                                            x:Name="MagicHeartRateIcons_checkbox"
                                            Margin="2,0"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.MagicHeartRateIcons, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Auto change heart rate prefix icons
                                        </CheckBox>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Pulsoid ˢᵗᵃᵗˢ" />

                                        <TextBlock
                                            Width="auto"
                                            Margin="2,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="You can show stats over a selected time period." />

                                        <CheckBox
                                            x:Name="EnableStats"
                                            Height="20"
                                            Margin="4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.PulsoidStatsEnabled, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Enable Pulsoid ˢᵗᵃᵗˢ
                                        </CheckBox>

                                        <StackPanel Visibility="{Binding HeartRateConnector.Settings.PulsoidStatsEnabled, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Width="auto"
                                                Margin="4,2"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                Foreground="#FF9983AD"
                                                Text="Select the timeframe you want to show the stats for." />
                                            <ComboBox
                                                x:Name="PulsoidTimeFrame_combo"
                                                Width="100"
                                                Height="25"
                                                Margin="4,4"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                ItemsSource="{Binding HeartRateConnector.Settings.StatisticsTimeRanges, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Opacity="0.3"
                                                SelectedItem="{Binding HeartRateConnector.Settings.SelectedStatisticsTimeRange, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>



                                            <TextBlock
                                                Width="auto"
                                                Padding="4,10,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                Foreground="#FF9983AD"
                                                Text="Pick the stats you want to show that is collected over your selected time frame." />



                                            <CheckBox
                                                x:Name="ShowCalories"
                                                Height="20"
                                                Margin="4,4,2,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.ShowCalories, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Show calories
                                            </CheckBox>

                                            <CheckBox
                                                x:Name="AverageHeartRate"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.ShowAverageHeartRate, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Show average heart rate
                                            </CheckBox>

                                            <CheckBox
                                                x:Name="MaximumHeartRate"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.ShowMaximumHeartRate, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Show maximum heart rate
                                            </CheckBox>

                                            <CheckBox
                                                x:Name="MinimumHeartRate"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.ShowMinimumHeartRate, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Show minimum heart rate
                                            </CheckBox>



                                            <CheckBox
                                                x:Name="RecordedTime"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.ShowDuration, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Show recorded time over selected time frame
                                            </CheckBox>

                                            <CheckBox
                                                x:Name="ShowSelectTimeInRecordedTime"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.ShowStatsTimeRange, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click"
                                                Visibility="{Binding HeartRateConnector.Settings.ShowDuration, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                Show selected time like (24h) frame in recorded time stat
                                            </CheckBox>

                                            <CheckBox
                                                x:Name="HideCurrentHeartRate"
                                                Height="20"
                                                Margin="4,12,4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.HideCurrentHeartRate, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Hide current heart rate when showing stats
                                            </CheckBox>
                                            <CheckBox
                                                x:Name="PlaceTrendIndicatorBehindStats"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.TrendIndicatorBehindStats, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Place trend indicator behind stats
                                            </CheckBox>


                                        </StackPanel>





                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Pulsoid to OSC" />

                                        <TextBlock
                                            Width="auto"
                                            Margin="2,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="With Pulsoid to OSC you can send your heart rate to your VRChat Avatar." />

                                        <CheckBox
                                            x:Name="EnableOSCStats"
                                            Height="20"
                                            Margin="4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding IntgrHeartRate_OSC, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Enable OSC support
                                        </CheckBox>

                                        <StackPanel Margin="0,10,0,0" Visibility="{Binding IntgrHeartRate_OSC, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <CheckBox
                                                x:Name="sentMCBHeartrateInfo_checkbox"
                                                Height="20"
                                                Margin="4,4"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.SentMCBHeartrateInfo, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Send magic info to OSC, like trend indicator and max, min, avg heart rate.
                                            </CheckBox>
                                            <CheckBox
                                                x:Name="sentMCBHeartrateInfoLegacy_checkbox"
                                                Height="20"
                                                Margin="4,2"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.SentMCBHeartrateInfoLegacy, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click"
                                                Visibility="{Binding HeartRateConnector.Settings.SentMCBHeartrateInfo, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                Send magic info as legacy values to OSC
                                            </CheckBox>

                                            <CheckBox
                                                x:Name="SmoothOSCHeartRate_checkbox"
                                                Height="20"
                                                Margin="4,10,4,0"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.SmoothOSCHeartRate, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Smooth heart rate to OSC
                                            </CheckBox>

                                            <StackPanel Margin="4,4,0,0" Visibility="{Binding HeartRateConnector.Settings.SmoothOSCHeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                <StackPanel
                                                    Margin="0,5,0,5"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                                    <TextBlock
                                                        VerticalAlignment="Center"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="15"
                                                        Foreground="#FF9983AD"
                                                        Text="Use last" />
                                                    <TextBox
                                                        x:Name="SmoothOSCHeartRate_INT"
                                                        Width="auto"
                                                        MinWidth="20"
                                                        Margin="5,0"
                                                        Padding="3,0"
                                                        VerticalAlignment="Center"
                                                        Background="#FF7B7195"
                                                        BorderThickness="0"
                                                        FontSize="15"
                                                        Foreground="#FF240E54"
                                                        Text="{Binding HeartRateConnector.Settings.SmoothOSCHeartRateTimeSpan, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    <TextBlock
                                                        VerticalAlignment="Center"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="15"
                                                        Foreground="#FF9983AD"
                                                        Text="received heart rate updates from the network to show smooth heart rate changes." />
                                                </StackPanel>
                                                <TextBlock
                                                    Width="auto"
                                                    Margin="2,0"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="13"
                                                    FontStyle="Italic"
                                                    Foreground="#FF9983AD"
                                                    Opacity="0.5"
                                                    Text="By using a heartrate band, you get way more updates from the network than you would get from a watch." />
                                            </StackPanel>
                                        </StackPanel>





                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding HeartRateConnector.Settings.MagicHeartIconPrefix, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,0"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Example: If below 60 BPM, shows 'sleepy'; if above 100 BPM, shows 'hot'." />
                                        <CheckBox
                                            x:Name="ShowTemperatureText_checkbox"
                                            Margin="4,2"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.ShowTemperatureText, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Show temperature status
                                        </CheckBox>
                                        <StackPanel Margin="4,5,0,0" Visibility="{Binding HeartRateConnector.Settings.ShowTemperatureText, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock
                                                    Padding="0,0,9,0"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Lower than" />
                                                <TextBox
                                                    x:Name="LowTemperatureThreshold"
                                                    Width="35"
                                                    Height="auto"
                                                    Margin="0,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalContentAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.LowTemperatureThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    TextAlignment="Center" />
                                                <TextBlock
                                                    Padding="5,0,5,0"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="show" />
                                                <TextBox
                                                    x:Name="LowHeartRateText"
                                                    Height="auto"
                                                    MinWidth="60"
                                                    Padding="3,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalContentAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.LowHeartRateText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                            <StackPanel Margin="0,5,0,5" Orientation="Horizontal">
                                                <TextBlock
                                                    Padding="0,0,5,0"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Higher than" />
                                                <TextBox
                                                    x:Name="HighTemperatureThreshold"
                                                    Width="35"
                                                    Height="auto"
                                                    HorizontalAlignment="Left"
                                                    VerticalContentAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.HighTemperatureThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    TextAlignment="Center" />
                                                <TextBlock
                                                    Padding="5,0,4,0"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="show" />
                                                <TextBox
                                                    x:Name="HighwHeartRateText"
                                                    Height="auto"
                                                    MinWidth="60"
                                                    Margin="0,0,0,0"
                                                    Padding="3,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalContentAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.HighHeartRateText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,0"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Monitors changes in heart rate over time, showing up/down arrows if you accelerate or decelerate quickly." />
                                        <CheckBox
                                            x:Name="ShowHeartRateTrendIndicator"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.ShowHeartRateTrendIndicator, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Trend suffix indicators ⤴️ ⤵️
                                        </CheckBox>
                                        <StackPanel Margin="0,6,0,0" Visibility="{Binding HeartRateConnector.Settings.ShowHeartRateTrendIndicator, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Margin="4,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="Trend symbols" />
                                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">

                                                <ComboBox
                                                    x:Name="PulsoidTrendSymbols"
                                                    Width="100"
                                                    Height="25"
                                                    Margin="4,2"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    DisplayMemberPath="CombinedTrendSymbol"
                                                    ItemsSource="{Binding HeartRateConnector.Settings.PulsoidTrendSymbols, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Opacity="0.3"
                                                    SelectedItem="{Binding HeartRateConnector.Settings.SelectedPulsoidTrendSymbol, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                            <StackPanel
                                                Margin="4,5,0,10"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Use last" />
                                                <TextBox
                                                    x:Name="HeartRateTrendIndicatorSampleRate_INT"
                                                    Width="auto"
                                                    MinWidth="20"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.HeartRateTrendIndicatorSampleRate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="heart rate scans to identify trends." />
                                            </StackPanel>


                                            <TextBlock
                                                Width="auto"
                                                Padding="4,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="Trend sensitivity" />
                                            <StackPanel Margin="3,0" Orientation="Horizontal">

                                                <TextBlock
                                                    Width="auto"
                                                    Padding="2,5,5,5"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="13"
                                                    Foreground="#FF7D7397"
                                                    Text="Quick" />
                                                <Slider
                                                    x:Name="HeartRateTrendIndicatorSensitivitySlider"
                                                    Width="134.5"
                                                    Height="12"
                                                    Margin="2.2,0,4.5,0"
                                                    Maximum="1"
                                                    Minimum="0"
                                                    Style="{StaticResource CustomSlider}"
                                                    Value="{Binding Path=HeartRateConnector.Settings.HeartRateTrendIndicatorSensitivity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    Width="auto"
                                                    Padding="5,0"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="13"
                                                    Foreground="#FF7D7397"
                                                    Text="Slow" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,0"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Applies a moving average over a few seconds so the displayed BPM doesn't jump too wildly." />
                                        <CheckBox
                                            x:Name="SmoothHeartRate_checkbox"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.SmoothHeartRate, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Smooth heart rate to Chatbox
                                        </CheckBox>
                                        <StackPanel Margin="4,4,0,0" Visibility="{Binding HeartRateConnector.Settings.SmoothHeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Use last" />
                                                <TextBox
                                                    x:Name="SmoothHeartRate_INT"
                                                    Width="auto"
                                                    MinWidth="20"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.SmoothHeartRateTimeSpan, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="heart rate scans to show smooth heart rate changes." />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Any heart rate above the max threshold gets compressed into a smaller range to avoid extremely high values" />
                                        <CheckBox
                                            x:Name="ThrottleHR"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.ThrottleHR, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Enable Heart Rate Throttling
                                        </CheckBox>

                                        <StackPanel Margin="4,5,0,0" Visibility="{Binding HeartRateConnector.Settings.ThrottleHR, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">



                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">

                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Max Heart Rate:" />
                                                <TextBox
                                                    x:Name="throttleRangeMin"
                                                    Width="auto"
                                                    MinWidth="20"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.ThrottleHRMax, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="BPM" />

                                            </StackPanel>

                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Max Overflow:" />

                                                <TextBox
                                                    x:Name="throttleHRMax"
                                                    Width="auto"
                                                    MinWidth="20"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.ThrottleMaxAdditional, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="BPM" />
                                            </StackPanel>
                                            <TextBlock
                                                Width="auto"
                                                Margin="0,0,0,5"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                FontStyle="Italic"
                                                Foreground="#FF9983AD"
                                                Opacity="0.5"
                                                Text="Max Overflow adds a small extra range above the cutoff to gently scale heart-rate spikes instead of cutting them off abruptly." />


                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,2,0,3"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Applies a constant offset to your measured BPM. Useful if your sensor is known to be +5 BPM off. use - to remove BPM" />
                                        <CheckBox
                                            x:Name="ApplyHeartRateAdjustment_checkbox"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.ApplyHeartRateAdjustment, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Heart rate adjustment
                                        </CheckBox>

                                        <StackPanel Margin="4,5,0,0" Visibility="{Binding HeartRateConnector.Settings.ApplyHeartRateAdjustment, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Adjust heart-rate by" />
                                                <TextBox
                                                    x:Name="HeartRateAdjustment"
                                                    Width="auto"
                                                    MinWidth="20"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.HeartRateAdjustment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="BPM" />
                                            </StackPanel>


                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,2"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Marks your heart rate as 'offline' if it stops updating for too long." />
                                        <CheckBox
                                            x:Name="EnableHeartRateOfflineCheck_checkbox"
                                            Height="22"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.EnableHeartRateOfflineCheck, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Check for offline heart rate
                                        </CheckBox>
                                        <StackPanel Margin="4,5,0,0" Visibility="{Binding HeartRateConnector.Settings.EnableHeartRateOfflineCheck, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,0"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="If the heart rate is unchanged for" />
                                                <TextBox
                                                    x:Name="UnchangedHeartRateLimit_INT"
                                                    Width="auto"
                                                    MinWidth="20"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.UnchangedHeartRateTimeoutInSec, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="seconds, then the heart rate is considered offline." />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,0"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Adds 'bpm' after the heart rate, e.g. '85 bpm' instead of just '85'." />
                                        <CheckBox
                                            x:Name="ShowBPMSuffix_checkbox"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.ShowBPMSuffix, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Show BPM suffix
                                        </CheckBox>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,2"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="If disabled, sends only new style parameters (/avatar/parameters/HR, etc.) for a simpler, faster update." />
                                        <CheckBox
                                            x:Name="DisableLegacyOSCSupport_checkbox"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.DisableLegacySupport, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Disable legacy OSC support (improved performance)
                                        </CheckBox>
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Width="auto"
                                            Margin="4,3,0,2"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="If checked, you'll see a short label (like 'Heart Rate:') before the BPM." />
                                        <CheckBox
                                            x:Name="HeartRateTitle_checkbox"
                                            Height="20"
                                            Margin="4,2"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HeartRateConnector.Settings.HeartRateTitle, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Show heart-rate title
                                        </CheckBox>

                                        <StackPanel Margin="0,10,0,0" Visibility="{Binding HeartRateConnector.Settings.HeartRateTitle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Margin="4,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="The title is shown above/before the heart rate." />
                                            <StackPanel
                                                Margin="4,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Show off as:" />
                                                <TextBox
                                                    x:Name="HeartRateTitleCustom"
                                                    Width="auto"
                                                    MinWidth="50"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding HeartRateConnector.Settings.CurrentHeartRateTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                            <CheckBox
                                                x:Name="HeartRateTitleStackMethod_checkbox"
                                                Height="20"
                                                Margin="4,3"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding HeartRateConnector.Settings.SeparateTitleWithEnter, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click">
                                                Seperate with enter
                                            </CheckBox>

                                        </StackPanel>

                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="2" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_Time, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Time options"
                                TextOptions.TextRenderingMode="ClearType" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            Visibility="{Binding Settings_Time, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <CheckBox
                                    x:Name="PrefixTime_checkbox"
                                    Height="22"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding PrefixTime, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Show 'My time:' in front of the time integration
                                </CheckBox>

                                <CheckBox
                                    x:Name="Time24H_checkbox"
                                    Height="20"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding Time24H, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    24-Hour time format
                                </CheckBox>
                                <CheckBox
                                    x:Name="UseSystemCultureForTime"
                                    Height="20"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    Content="Use current system culture for formating time"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding UseSystemCulture, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click" />
                                <CheckBox
                                    x:Name="AutoSetDaylight_checkbox"
                                    Height="20"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding AutoSetDaylight, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Auto daylight saving time
                                </CheckBox>
                                <CheckBox
                                    x:Name="DaylightSavingTime_checkbox"
                                    Height="20"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding UseDaylightSavingTime, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click"
                                    Visibility="{Binding AutoSetDaylight, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    Daylight saving time
                                </CheckBox>
                                <CheckBox
                                    x:Name="TimeShowTimeZone_checkbox"
                                    Height="20"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding TimeShowTimeZone, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Custom time zone
                                </CheckBox>
                                <StackPanel
                                    Width="auto"
                                    Height="22"
                                    Margin="0,0,0,15"
                                    HorizontalAlignment="Left"
                                    Orientation="Horizontal"
                                    Visibility="{Binding TimeShowTimeZone, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">

                                    <ComboBox
                                        x:Name="TimeZoneComboBox"
                                        Width="183"
                                        Height="21"
                                        BorderBrush="#FF020000"
                                        DisplayMemberPath="Value"
                                        FontSize="11.5"
                                        ItemsSource="{Binding TimezoneFriendlyNames, UpdateSourceTrigger=PropertyChanged}"
                                        Opacity="0.4"
                                        SelectedValue="{Binding SelectedTimeZone, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValuePath="Key" />
                                    <TextBlock
                                        Margin="10,2,5,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="16"
                                        Foreground="#FFB9B5C1"
                                        Text="Convert your local time to a standard time zone" />
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="3" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_OpenAI, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="OpenAI options"
                                TextOptions.TextRenderingMode="ClearType" />
                            <TextBlock
                                x:Name="LearnMoreAboutOpenAIbtn"
                                Width="auto"
                                Margin="10,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FF31B7B4"
                                MouseUp="LearnMoreAboutOpenAIbtn_MouseUp"
                                Text="Terms of use"
                                TextDecorations="Underline" />
                            <TextBlock
                                x:Name="MyUsageBtn"
                                Width="auto"
                                Margin="10,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FF31B7B4"
                                MouseUp="MyUsageBtn_MouseUp"
                                Text="My usage"
                                TextDecorations="Underline" />

                        </StackPanel>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,0,0,0"
                            Visibility="{Binding Settings_OpenAI, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>

                                <Border
                                    Margin="0,5,0,10"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Orientation="Horizontal">
                                        <Button
                                            x:Name="ConnectWithOpenAI"
                                            Width="auto"
                                            Height="30"
                                            Padding="5"
                                            Click="ConnectWithOpenAI_Click"
                                            Style="{StaticResource Status_Button_style}"
                                            Visibility="{Binding OpenAIConnected, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image
                                                            Width="21"
                                                            Height="18"
                                                            Margin="0,0,3,0"
                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                            Source="/Img/Icons/OpenAI.png" />
                                                        <TextBlock
                                                            Margin="0,-2,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            Text="Connect with OpenAI" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                        <Button
                                            x:Name="ConnectedWithOpenAI"
                                            Width="185"
                                            Height="30"
                                            Padding="5"
                                            HorizontalAlignment="Left"
                                            d:Visibility="Visible"
                                            Style="{StaticResource Status_Button_style}"
                                            Visibility="{Binding OpenAIConnected, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image
                                                            Width="15"
                                                            Height="15"
                                                            Margin="2,0,5,0"
                                                            VerticalAlignment="Center"
                                                            Source="/Img/Icons/yes.png" />
                                                        <TextBlock
                                                            Margin="0,-2,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            Text="Connected with OpenAI" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                        <Button
                                            x:Name="DisconnectOpenAI"
                                            Grid.Row="0"
                                            Grid.Column="1"
                                            Width="20"
                                            Height="30"
                                            Margin="-5,0,0,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            d:Visibility="Visible"
                                            Background="#8A0000"
                                            BorderThickness="0"
                                            Click="DisconnectOpenAI_Click"
                                            Cursor="Hand"
                                            Style="{DynamicResource DisconnectPulsoid}"
                                            Visibility="{Binding OpenAIConnected, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <Grid>
                                                <Image
                                                    Width="15"
                                                    Height="15"
                                                    RenderOptions.BitmapScalingMode="Linear"
                                                    Source="/Img/Icons/Cross_v1_ico.png" />
                                            </Grid>
                                        </Button>
                                        <TextBlock
                                            Width="400"
                                            Padding="10,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="PaleVioletRed"
                                            Text="{Binding OpenAIAccessErrorTxt, UpdateSourceTrigger=PropertyChanged}"
                                            TextWrapping="Wrap"
                                            Visibility="{Binding OpenAIAccessError, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <CheckBox
                                            x:Name="PerformModerationCheck"
                                            Height="20"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding IntelliChatModule.Settings.IntelliChatPerformModeration, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Enable free moderation checks to safeguard your content and OpenAI account
                                        </CheckBox>

                                    </StackPanel>
                                </Border>


                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Magic improve" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="With Magic improve, you can transform your chat message in anything you can think of" />
                                        <TextBlock
                                            Width="auto"
                                            Padding="2,14,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Select your preferred writing style for the quick-access button in the chat window below" />
                                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                            <ComboBox
                                                x:Name="WritingStylesComboBox"
                                                Width="200"
                                                Height="25"
                                                Margin="2,4"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                DisplayMemberPath="StyleName"
                                                ItemsSource="{Binding IntelliChatModule.Settings.SupportedWritingStyles, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Opacity="0.3"
                                                SelectedItem="{Binding IntelliChatModule.Settings.SelectedWritingStyle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock
                                                Width="auto"
                                                Padding="2,2,0,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="12"
                                                FontWeight="DemiBold"
                                                Foreground="#FF9983AD"
                                                Text="{Binding IntelliChatModule.Settings.SelectedWritingStyle.StyleDescription}" />
                                        </StackPanel>

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,7,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="OpenAI Model:" />
                                        <ComboBox
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding IntelliChatModule.AvailableChatModels}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding IntelliChatModule.Settings.PerformBeautifySentenceModel, Mode=TwoWay}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>



                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Magic translate" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="With translation, you can pick every language you can think of or that is known by the AI (that a lot!)" />

                                        <CheckBox
                                            x:Name="AutoDetectLang"
                                            Height="20"
                                            Margin="2,14,0,0"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding IntelliChatModule.Settings.AutolanguageSelection, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Visibility="Collapsed">
                                            Automatically detect language (less tokens)
                                        </CheckBox>

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,14,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Select your preferred language for the quick-access button in the chat window below" />

                                        <ComboBox
                                            x:Name="SelectedTranslateLanguageComboBox"
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            DisplayMemberPath="Language"
                                            ItemsSource="{Binding IntelliChatModule.Settings.SupportedLanguages, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="0.3"
                                            SelectedItem="{Binding IntelliChatModule.Settings.SelectedTranslateLanguage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />


                                        <TextBlock
                                            Width="auto"
                                            Padding="2,7,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="OpenAI Model:" />
                                        <ComboBox
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding IntelliChatModule.AvailableChatModels}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding IntelliChatModule.Settings.PerformLanguageTranslationModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>


                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Speech to text" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="With speech to text, you can transform your voice into text" />
                                        <TextBlock
                                            Width="auto"
                                            Padding="2,14,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Select your preferred recording device to use for text to speech" />
                                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                            <ComboBox
                                                x:Name="SelectedDeviceComboBox"
                                                Width="200"
                                                Height="25"
                                                Margin="2,4"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                DisplayMemberPath="DeviceName"
                                                ItemsSource="{Binding WhisperModule.Settings.AvailableDevices}"
                                                Opacity="0.3"
                                                SelectedValue="{Binding WhisperModule.Settings.SelectedDeviceIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                SelectedValuePath="DeviceIndex" />

                                        </StackPanel>
                                        <TextBlock
                                            Width="600"
                                            Padding="2,14,0,5"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="You can speak any language you want, the AI will try to understand it. If you want to translate it."
                                            TextWrapping="Wrap" />
                                        <CheckBox
                                            x:Name="TranslateToCustomLanguage"
                                            Height="20"
                                            Margin="4,0,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding WhisperModule.Settings.TranslateToCustomLanguage, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Enable translation
                                        </CheckBox>
                                        <TextBlock
                                            Width="auto"
                                            Padding="2,8,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Select your preferred speech to text language"
                                            Visibility="{Binding WhisperModule.Settings.TranslateToCustomLanguage, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                        <StackPanel
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Visibility="{Binding WhisperModule.Settings.TranslateToCustomLanguage, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <ComboBox
                                                x:Name="SelectedSpeechToTextLanguageComboBox"
                                                Width="200"
                                                Height="25"
                                                Margin="2,4"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                DisplayMemberPath="Language"
                                                ItemsSource="{Binding WhisperModule.Settings.SpeechToTextLanguages}"
                                                Opacity="0.3"
                                                SelectedValue="{Binding WhisperModule.Settings.SelectedSpeechToTextLanguage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                        </StackPanel>

                                        <StackPanel Margin="0,5,0,4" Orientation="Horizontal">
                                            <TextBlock
                                                Width="auto"
                                                Padding="3,10,0,0"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="Disable after" />
                                            <TextBox
                                                x:Name="SilenceAutoTurnOffDurationINT"
                                                Width="auto"
                                                Height="26"
                                                Margin="4,3,3,0"
                                                Padding="3,0,3,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding WhisperModule.Settings.SilenceAutoTurnOffDuration, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock
                                                Width="auto"
                                                Padding="0,10,0,0"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="milliseconds of silence" />


                                        </StackPanel>

                                        <CheckBox
                                            x:Name="SendAftersilence"
                                            Height="20"
                                            Margin="4,10,4,4"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding WhisperModule.Settings.SendAftersilence, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Sent Speech to text after silence
                                        </CheckBox>

                                        <TextBlock
                                            Width="auto"
                                            Padding="4,16,0,5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="Adjust the noise gate threshold" />

                                        <StackPanel Margin="4,0,0,7" Orientation="Horizontal">
                                            <Slider
                                                x:Name="NoiseGateThreshold"
                                                Width="134.5"
                                                Height="12"
                                                Margin="2.2,0,4.5,0"
                                                IsSnapToTickEnabled="True"
                                                Maximum="1.0"
                                                Minimum="0.0"
                                                SmallChange="0.01"
                                                Style="{StaticResource CustomSlider}"
                                                TickFrequency="0.01"
                                                Value="{Binding WhisperModule.Settings.NoiseGateThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock
                                                Width="auto"
                                                Padding="5,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF7D7397"
                                                Text="{Binding WhisperModule.Settings.NoiseGateThreshold, UpdateSourceTrigger=PropertyChanged}" />

                                        </StackPanel>


                                    </StackPanel>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Other AI functions" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Here u can change the model of the IntelliChat AI function" />


                                        <TextBlock
                                            Width="auto"
                                            Padding="2,7,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Conversation starter OpenAI Model:" />
                                        <ComboBox
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding IntelliChatModule.AvailableChatModels}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding IntelliChatModule.Settings.GenerateConversationStarterModel, Mode=TwoWay}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,7,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Shorten text OpenAI Model:" />
                                        <ComboBox
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding IntelliChatModule.AvailableChatModels}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding IntelliChatModule.Settings.PerformShortenTextModel, Mode=TwoWay}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,7,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Spelling / grammar correction OpenAI Model" />
                                        <ComboBox
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding IntelliChatModule.AvailableChatModels}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding IntelliChatModule.Settings.PerformSpellingCheckModel, Mode=TwoWay}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,7,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF9983AD"
                                            Text="Next word prediction OpenAI Model" />
                                        <ComboBox
                                            Width="200"
                                            Height="25"
                                            Margin="2,4"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding IntelliChatModule.AvailableChatModels}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding IntelliChatModule.Settings.PerformTextCompletionModel, Mode=TwoWay}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>



                                    </StackPanel>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <CheckBox
                                            x:Name="HideOpenAITools"
                                            Height="20"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding HideOpenAITools, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Hide OpenAI toolbar in chatting tab
                                        </CheckBox>

                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </Grid>
                    </Grid>
                    <Grid
                        x:Name="CompLayer"
                        Grid.Row="4"
                        Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_ComponentStats, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Component stats options"
                                TextOptions.TextRenderingMode="ClearType" />
                        </Grid>


                        <StackPanel
                            x:Name="Settings_ComponentStats_Grid"
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            d:Visibility="Visible"
                            Visibility="{Binding Settings_ComponentStats, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <Border
                                Margin="0,0,0,5"
                                Background="#FF3B3054"
                                CornerRadius="5,0,0,5">

                                <StackPanel>
                                    <CheckBox
                                        x:Name="IsTemperatureSwitchEnabled_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Autoswitch temperature units"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding IsTemperatureSwitchEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="UseEmojisForTempAndPower_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Use emojis for temperature and power"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding UseEmojisForTempAndPower, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="ComponentStatAutoSelectGPU_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Auto-select GPU"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding AutoSelectGPU, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="This option will automatically select the GPU." />
                                    <ComboBox
                                        x:Name="ComponentStatSelectedGPUComboBox"
                                        Width="186"
                                        Height="25"
                                        Margin="5,5"
                                        HorizontalAlignment="Left"
                                        ItemsSource="{Binding GPUList, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        Opacity="0.3"
                                        SelectedItem="{Binding SelectedGPU, Mode=TwoWay}"
                                        Visibility="{Binding AutoSelectGPU, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="5,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="#BDAEE2"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="{Binding CPUHardwareName, StringFormat='CPU: {0}', UpdateSourceTrigger=PropertyChanged}">


                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="10"
                                                Direction="0"
                                                Opacity="0.9"
                                                ShadowDepth="0"
                                                Color="#63A8F9" />
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <CheckBox
                                        x:Name="ComponentStatCPUWattageVisible_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show CPU wattage"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatCPUWattageVisible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="ComponentStatCPUTempVisible_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show CPU temperature"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatCPUTempVisible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="CPU_SmallName_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Stylized uppercase letters"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding CPU_SmallName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />

                                    <CheckBox
                                        x:Name="CPU_EnableHardwareTitle_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Display model name instead of 'CPU'"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding CPU_EnableHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the CPU usage label will display the model name of the CPU (e.g., 'Intel Core i7') instead of just 'CPU'." />
                                    <CheckBox
                                        x:Name="CPU_NumberTrailingZeros_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Round off CPU usage percentage"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding CPU_NumberTrailingZeros, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When enabled, the CPU usage percentage will be rounded off to the nearest whole number (e.g., displays as '7%' instead of '7.2%')."
                                        Unchecked="Update_Click" />
                                    <StackPanel Margin="5" IsEnabled="{Binding CPU_EnableHardwareTitle, UpdateSourceTrigger=PropertyChanged}">
                                        <CheckBox
                                            x:Name="CPU_PrefixHardwareTitle_checkbox"
                                            Height="20"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            Content="Set custom CPU model name"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding CPU_PrefixHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            ToolTip="Specify your custom model name for the CPU. Note: This option requires 'Display model name instead of 'CPU'' to be enabled."
                                            Unchecked="Update_Click" />
                                        <StackPanel Margin="0,10,0,0" Visibility="{Binding CPU_PrefixHardwareTitle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Custom hardware name" />
                                                <TextBox
                                                    x:Name="CPUCustomHardwareName"
                                                    Width="auto"
                                                    MinWidth="50"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding CPUCustomHardwareName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border
                                Margin="0,0,0,5"
                                Background="#FF3B3054"
                                CornerRadius="5,0,0,5">
                                <StackPanel>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="5,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="#BDAEE2"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="{Binding GPUHardwareName, StringFormat='GPU: {0}', UpdateSourceTrigger=PropertyChanged}">

                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="10"
                                                Direction="0"
                                                Opacity="0.9"
                                                ShadowDepth="0"
                                                Color="#63A8F9" />
                                        </TextBlock.Effect>
                                    </TextBlock>

                                    <CheckBox
                                        x:Name="ComponentStatGPUWattageVisible_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show GPU wattage"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatGPUWattageVisible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="ComponentStatGPUTempVisible_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show GPU temperature"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatGPUTempVisible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="ComponentStatGPUHotSpotVisible_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show GPU hotspot temperature"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatGPUHotSpotVisible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="GPU_SmallName_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Stylized uppercase letters"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding GPU_SmallName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="GPU_Core3DHook_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Utilization is based on the 3D usage"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatsGPU3DHook, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="GPU_EnableHardwareTitle_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Display model name instead of 'GPU'"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding GPU_EnableHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the GPU usage label will display the model name of the GPU (e.g., 'NVIDIA RTX 4090') instead of just 'GPU'." />
                                    <CheckBox
                                        x:Name="GPU_NumberTrailingZeros_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Round off CPU usage percentage"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding GPU_NumberTrailingZeros, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When enabled, the GPU usage percentage will be rounded off to the nearest whole number (e.g., displays as '7%' instead of '7.2%')."
                                        Unchecked="Update_Click" />
                                    <StackPanel Margin="5" IsEnabled="{Binding GPU_EnableHardwareTitle, UpdateSourceTrigger=PropertyChanged}">
                                        <CheckBox
                                            x:Name="GPU_PrefixHardwareTitle_checkbox"
                                            Height="20"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            Content="Set custom GPU model name"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding GPU_PrefixHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            ToolTip="Specify your custom model name for the GPU. Note: This option requires 'Display model name instead of 'GPU'' to be enabled."
                                            Unchecked="Update_Click" />
                                        <StackPanel Margin="0,10,0,0" Visibility="{Binding GPU_PrefixHardwareTitle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Custom hardware name" />
                                                <TextBox
                                                    x:Name="GPUCustomHardwareName"
                                                    Width="auto"
                                                    MinWidth="50"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding GPUCustomHardwareName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border
                                Margin="0,0,0,5"
                                Background="#FF3B3054"
                                CornerRadius="5,0,0,5">
                                <StackPanel>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="5,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="#BDAEE2"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="{Binding VRAMHardwareName, StringFormat='VRAM: {0}', UpdateSourceTrigger=PropertyChanged}">

                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="10"
                                                Direction="0"
                                                Opacity="0.9"
                                                ShadowDepth="0"
                                                Color="#63A8F9" />
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <CheckBox
                                        x:Name="VRAM_SmallName_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Stylized uppercase letters"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding VRAM_SmallName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="ComponentStatsGPU3DVRAMHook_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="VRAM usage is based on the 3D usage"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding ComponentStatsGPU3DVRAMHook, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="VRAM_EnableHardwareTitle_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Display model name instead of 'VRAM'"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding VRAM_EnableHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the VRAM usage label will display the model name of ur GPU." />
                                    <CheckBox
                                        x:Name="VRAM_ShowMaxValue_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show max VRAM capacity"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding VRAM_ShowMaxValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the VRAM usage label will display the model name of ur GPU." />
                                    <CheckBox
                                        x:Name="VRAM_NumberTrailingZeros_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Round off GPU VRAM usage in GBs"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding VRAM_NumberTrailingZeros, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When enabled, the VRAM usage will be rounded off to the nearest whole number (e.g., displays as '6 GB' instead of '5.7 GB')."
                                        Unchecked="Update_Click" />
                                    <StackPanel Margin="5" IsEnabled="{Binding VRAM_EnableHardwareTitle, UpdateSourceTrigger=PropertyChanged}">
                                        <CheckBox
                                            x:Name="VRAM_PrefixHardwareTitle_checkbox"
                                            Height="20"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            Content="Set custom VRAM name"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding VRAM_PrefixHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            ToolTip="Specify your custom model name for your GPU. Note: This option requires 'Display model name instead of 'VRAM'' to be enabled."
                                            Unchecked="Update_Click" />
                                        <StackPanel Margin="0,10,0,0" Visibility="{Binding VRAM_PrefixHardwareTitle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Custom hardware name" />
                                                <TextBox
                                                    x:Name="VRAMCustomHardwareName"
                                                    Width="auto"
                                                    MinWidth="50"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding VRAMCustomHardwareName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            <Border
                                Margin="0,0,0,5"
                                Background="#FF3B3054"
                                CornerRadius="5,0,0,5">
                                <StackPanel>
                                    <TextBlock
                                        Grid.Row="0"
                                        Margin="5,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="#BDAEE2"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="{Binding RAMHardwareName, StringFormat='RAM: {0}', UpdateSourceTrigger=PropertyChanged}">

                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="10"
                                                Direction="0"
                                                Opacity="0.9"
                                                ShadowDepth="0"
                                                Color="#63A8F9" />
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <CheckBox
                                        x:Name="RAM_SmallName_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Stylized uppercase letters"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding RAM_SmallName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="" />
                                    <CheckBox
                                        x:Name="RAM_EnableHardwareTitle_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Display model name instead of 'RAM'"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding RAM_EnableHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the RAM usage label will display the model name of ur RAM." />
                                    <CheckBox
                                        x:Name="RAM_ShowMaxValue_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show max RAM capacity"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding RAM_ShowMaxValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the VRAM usage label will display the model name of ur GPU." />
                                    <CheckBox
                                        x:Name="RAM_ShowDDRVersion_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Show RAM DDR version"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding RAM_ShowDDRVersion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When checked, the DDR version of the RAM will be displayed." />
                                    <CheckBox
                                        x:Name="RAM_NumberTrailingZeros_checkbox"
                                        Height="20"
                                        Margin="5,5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        Content="Round off RAM usage in GBs"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding RAM_NumberTrailingZeros, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        ToolTip="When enabled, the GPU usage percentage will be rounded off to the nearest whole number (e.g., displays as '7%' instead of '7.2%')."
                                        Unchecked="Update_Click" />
                                    <StackPanel Margin="5" IsEnabled="{Binding RAM_EnableHardwareTitle, UpdateSourceTrigger=PropertyChanged}">
                                        <CheckBox
                                            x:Name="RAM_PrefixHardwareTitle_checkbox"
                                            Height="20"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            Content="Set custom GPU model name"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding RAM_PrefixHardwareTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            ToolTip="Specify your custom model name for your RAM. Note: This option requires 'Display model name instead of 'RAM'' to be enabled."
                                            Unchecked="Update_Click" />
                                        <StackPanel Margin="0,10,0,0" Visibility="{Binding RAM_PrefixHardwareTitle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <StackPanel
                                                Margin="0,5,0,5"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                                <TextBlock
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="15"
                                                    Foreground="#FF9983AD"
                                                    Text="Custom hardware name" />
                                                <TextBox
                                                    x:Name="RAMCustomHardwareName"
                                                    Width="auto"
                                                    MinWidth="50"
                                                    Margin="5,0"
                                                    Padding="3,0"
                                                    VerticalAlignment="Center"
                                                    Background="#FF7B7195"
                                                    BorderThickness="0"
                                                    FontSize="15"
                                                    Foreground="#FF240E54"
                                                    Text="{Binding RAMCustomHardwareName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                    <Grid Grid.Row="5" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_NetworkStatistics, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="NetworkStatistics options"
                                TextOptions.TextRenderingMode="ClearType" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,0,0,0"
                            Visibility="{Binding Settings_NetworkStatistics, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_UseInterfaceMaxSpeed"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_UseInterfaceMaxSpeed, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Use network interface as the max speed
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowCurrentDown_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowCurrentDown, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show current download speed
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowCurrentUp_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowCurrentUp, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show current upload speed
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowMaxDown_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowMaxDown, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show max download speed
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowMaxUp_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowMaxUp, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show max upload speed
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowTotalDown_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowTotalDown, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show total download
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowTotalUp_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowTotalUp, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show total upload
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_ShowNetworkUtilization_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_ShowNetworkUtilization, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show network utilization
                                    </CheckBox>
                                </Border>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <CheckBox
                                        x:Name="NetworkStats_StyledCharacters_checkbox"
                                        Height="20"
                                        Margin="5"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding NetworkStats_StyledCharacters, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Stylized characters
                                    </CheckBox>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="6" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_Chatting, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Chatting options"
                                TextOptions.TextRenderingMode="ClearType" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            Visibility="{Binding Settings_Chatting, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <TextBlock
                                    Grid.Column="0"
                                    Padding="0,0,0,0"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="15"
                                    Foreground="#FF9983AD"
                                    Text="Chat timeout" />
                                <TextBox
                                    x:Name="ScanPauseCountDown"
                                    Width="40"
                                    Height="26"
                                    Margin="0,3,0,12"
                                    Padding="5,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalContentAlignment="Center"
                                    Background="#FF7B7195"
                                    BorderThickness="0"
                                    FontSize="15"
                                    Foreground="#FF240E54"
                                    Text="{Binding ScanPauseTimeout, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />



                                <CheckBox
                                    x:Name="ChatIconPrefix_checkbox"
                                    Height="22"
                                    Margin="0,0,0,10"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding PrefixChat, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Add 💬 as prefix for chat messages
                                </CheckBox>


                                <Grid Visibility="{Binding PrefixChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <CheckBox
                                        x:Name="EnableEmojiShuffleInChat_checkbox"
                                        Height="20"
                                        Margin="0,0,0,10"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding EnableEmojiShuffleInChats, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click"
                                        Visibility="{Binding EnableEmojiShuffle, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        Use your custom icon shuffle as a prefix for chat messages
                                    </CheckBox>
                                </Grid>



                                <CheckBox
                                    x:Name="ChatFX_checkbox"
                                    Height="22"
                                    Margin="0,0,0,10"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ChatFX, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Play FX sound for VRChat users when sending message
                                </CheckBox>
                                <CheckBox
                                    x:Name="ChatSendAgainFX_checkbox"
                                    Height="22"
                                    Margin="0,0,0,10"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ChatSendAgainFX, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Visibility="{Binding ChatFX, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    Play FX when clicking resend
                                </CheckBox>
                                <CheckBox
                                    x:Name="ChatAddSmallDelay_checkbox"
                                    Height="22"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ChatAddSmallDelay, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Small delay when sending message (prevents timeout)
                                </CheckBox>

                                <StackPanel Visibility="{Binding ChatAddSmallDelay, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <TextBlock
                                        Width="auto"
                                        Padding="0,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="Delay before sending" />
                                    <StackPanel Margin="0,0,0,7" Orientation="Horizontal">
                                        <Slider
                                            x:Name="ChatAddSmallDelaySensitivitySlider"
                                            Width="134.5"
                                            Height="12"
                                            Margin="2.2,0,4.5,0"
                                            IsSnapToTickEnabled="True"
                                            Maximum="2"
                                            Minimum="0.1"
                                            Style="{StaticResource CustomSlider}"
                                            TickFrequency="0.1"
                                            Value="{Binding Path=ChatAddSmallDelayTIME, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Width="auto"
                                            Padding="5,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF7D7397"
                                            Text="{Binding ChatAddSmallDelayTIME, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Width="auto"
                                            Margin="-2,5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF7D7397"
                                            Text="sec" />
                                    </StackPanel>
                                </StackPanel>
                                <CheckBox
                                    x:Name="KeepUpdatingChat_checkbox"
                                    Height="22"
                                    Margin="0,0,0,10"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding KeepUpdatingChat, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Overide display time for chat messages (keep updating)
                                </CheckBox>
                                <StackPanel Visibility="{Binding KeepUpdatingChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <TextBlock
                                        Width="auto"
                                        Padding="0,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="Update rate of active chat message" />
                                    <StackPanel Margin="0,0,0,7" Orientation="Horizontal">
                                        <Slider
                                            x:Name="ChattingUpdateRateSensitivitySlider"
                                            Width="134.5"
                                            Height="12"
                                            Margin="2.2,0,4.5,0"
                                            IsSnapToTickEnabled="True"
                                            Maximum="10"
                                            Minimum="2"
                                            Style="{StaticResource CustomSlider}"
                                            TickFrequency="0.1"
                                            Value="{Binding Path=ChattingUpdateRate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Width="auto"
                                            Padding="5,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF7D7397"
                                            Text="{Binding ChattingUpdateRate, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Width="auto"
                                            Margin="-2,5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            Foreground="#FF7D7397"
                                            Text="sec" />
                                    </StackPanel>
                                </StackPanel>
                                <CheckBox
                                    x:Name="ChatEdit_checkbox"
                                    Height="22"
                                    Margin="0,0,0,10"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ChatLiveEdit, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Visibility="{Binding KeepUpdatingChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    Edit chat messages
                                </CheckBox>
                                <Grid Visibility="{Binding ChatLiveEdit, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <CheckBox
                                        x:Name="ChatLiveEdit_checkbox"
                                        Height="22"
                                        Margin="0,0,0,10"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding RealTimeChatEdit, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Visibility="{Binding KeepUpdatingChat, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        Live editing
                                    </CheckBox>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="7" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_TTS, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Text to speech options"
                                TextOptions.TextRenderingMode="ClearType" />
                            <TextBlock
                                x:Name="LearnMoreAboutTTSbtn"
                                Width="auto"
                                Margin="188,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FF31B7B4"
                                MouseUp="LearnMoreAboutTTSbtn_MouseUp"
                                Text="Learn more"
                                TextDecorations="Underline" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            Visibility="{Binding Settings_TTS, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <CheckBox
                                    x:Name="TTSCutOff"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding TTSCutOff, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Stop current playing TTS on new chat
                                </CheckBox>
                                <CheckBox
                                    x:Name="TTSOnResendChat"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding TTSOnResendChat, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Replay TTS on resend
                                </CheckBox>
                                <CheckBox
                                    x:Name="TTSAutoUnmute"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding AutoUnmuteTTS, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Autotoggle VRChat voice on TTS
                                </CheckBox>

                                <StackPanel
                                    Width="auto"
                                    Height="22"
                                    Margin="0,0,0,15"
                                    HorizontalAlignment="Left"
                                    Orientation="Horizontal">
                                    <ComboBox
                                        x:Name="PlaybackOutputDeviceComboBox"
                                        Width="186"
                                        Height="25"
                                        Margin="0"
                                        DisplayMemberPath="FriendlyName"
                                        ItemsSource="{Binding PlaybackOutputDevices, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                        Opacity="0.4"
                                        SelectedItem="{Binding SelectedPlaybackOutputDevice, Mode=TwoWay}"
                                        SelectionChanged="PlaybackOutputDeviceComboBox_SelectionChanged" />
                                    <TextBlock
                                        Margin="8,0,5,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="TTS Output" />
                                </StackPanel>
                            </StackPanel>
                        </Grid>

                    </Grid>
                    <Grid Grid.Row="8" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_MediaLink, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="MediaLink options"
                                TextOptions.TextRenderingMode="ClearType" />
                            <TextBlock
                                x:Name="LearnMoreAboutSpotifybtn"
                                Width="auto"
                                Margin="162,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FF31B7B4"
                                MouseUp="LearnMoreAboutSpotifybtn_MouseUp"
                                Text="Learn more"
                                TextDecorations="Underline" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            Visibility="{Binding Settings_MediaLink, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Basic options" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Customize here how you want your media to look like in your chatbox" />

                                        <CheckBox
                                            Height="20"
                                            Margin="3,7"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding DisableMediaLink, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Use old Spotify integration (deprecated)
                                        </CheckBox>
                                        <CheckBox
                                            Height="21"
                                            Margin="3,7"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding PrefixIconMusic, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Change 'listening to:' prefix to 🎵
                                        </CheckBox>
                                        <CheckBox
                                            Height="21"
                                            Margin="3,7"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding PauseIconMusic, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click"
                                            Visibility="{Binding PrefixIconMusic, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            Show ⏸ when  music is paused
                                        </CheckBox>


                                    </StackPanel>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="MediaLink behavior" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,0,5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Here u can adjust the way MadiaLink handles sessions" />

                                        <CheckBox
                                            x:Name="MediaSession_AutoSwitch_checkbox"
                                            Height="20"
                                            Margin="3,7"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding MediaSession_AutoSwitch, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Auto switch when media state is changed (must check button on integration page)
                                        </CheckBox>
                                        <CheckBox
                                            x:Name="MediaSession_AutoSwitchSpawn_checkbox"
                                            Height="20"
                                            Margin="3,7"
                                            BorderBrush="#FF2D1265"
                                            Checked="Update_Click"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding MediaSession_AutoSwitchSpawn, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}"
                                            Unchecked="Update_Click">
                                            Turn autoswitch on when new session detected
                                        </CheckBox>

                                        <StackPanel Margin="3,7" Orientation="Horizontal">
                                            <TextBlock
                                                Padding="0,0,5,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="Forget session" />
                                            <TextBox
                                                Width="auto"
                                                Height="auto"
                                                Margin="0,0,0,0"
                                                Padding="5,0"
                                                HorizontalAlignment="Left"
                                                VerticalContentAlignment="Center"
                                                Background="#FF7B7195"
                                                BorderThickness="0"
                                                FontSize="15"
                                                Foreground="#FF240E54"
                                                Text="{Binding MediaSession_Timeout, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                TextAlignment="Center" />
                                            <TextBlock
                                                Padding="5,0,5,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="seconds after disconnect" />

                                        </StackPanel>




                                    </StackPanel>
                                </Border>

                                <Border
                                    Margin="0,0,0,5"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Padding="2,0,0,0"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="20"
                                            Foreground="#FF9983AD"
                                            Text="Media progress bar" />

                                        <TextBlock
                                            Width="auto"
                                            Padding="2,3,2,5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="13"
                                            FontStyle="Italic"
                                            Foreground="#FF9983AD"
                                            Opacity="0.5"
                                            Text="Customize how your seek bar looks like" />


                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,5,0,0"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="Seekbar Style"
                                            Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />


                                        <ComboBox
                                            Width="130"
                                            Height="auto"
                                            Margin="0,3"
                                            HorizontalAlignment="Left"
                                            ItemsSource="{Binding AvailableTimeSeekbarStyles}"
                                            Opacity="0.3"
                                            SelectedValue="{Binding MediaLinkTimeSeekStyle, Mode=TwoWay}"
                                            Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>

                                        <StackPanel Visibility="{Binding MediaLinkTimeSeekStyleIsNumbersAndSeekBar, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <CheckBox
                                                Height="20"
                                                Margin="3,7"
                                                BorderBrush="#FF2D1265"
                                                Checked="Update_Click"
                                                FontFamily="Comfortaa Light"
                                                FontSize="18"
                                                Foreground="#FFB9B5C1"
                                                IsChecked="{Binding AutoDowngradeSeekbar, Mode=TwoWay}"
                                                Style="{DynamicResource SettingsCheckbox}"
                                                Unchecked="Update_Click"
                                                Visibility="{Binding MediaLinkTimeSeekStyleIsNone, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                Auto-Style Downgrade if not fitting
                                            </CheckBox>

                                            <TextBlock
                                                Grid.Column="0"
                                                Padding="0,5,0,0"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="15"
                                                Foreground="#FF9983AD"
                                                Text="System and custom styles"
                                                Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                            <StackPanel Orientation="Horizontal">
                                                <ComboBox
                                                    Width="auto"
                                                    Height="30"
                                                    Margin="0,3"
                                                    HorizontalAlignment="Left"
                                                    DisplayMemberPath="StyleName"
                                                    FontSize="16"
                                                    ItemsSource="{Binding MediaLinkSeekbarStyles, UpdateSourceTrigger=PropertyChanged}"
                                                    Opacity="0.3"
                                                    SelectedItem="{Binding SelectedMediaLinkSeekbarStyle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                                <Button
                                                    x:Name="CreateNewSeekbar_btn"
                                                    Width="auto"
                                                    Height="30"
                                                    Margin="5,0,0,0"
                                                    Padding="5"
                                                    Click="CreateNewSeekbar_btn_Click"
                                                    Style="{StaticResource Status_Button_style}">
                                                    <Button.ContentTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image
                                                                    Width="21"
                                                                    Height="18"
                                                                    Margin="0,0,3,0"
                                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                                    Source="/Img/Icons/Add.png" />
                                                                <TextBlock
                                                                    Margin="0,-2,5,0"
                                                                    VerticalAlignment="Center"
                                                                    FontSize="14"
                                                                    Text="New custom Seekbar" />
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </Button.ContentTemplate>
                                                </Button>
                                                <Button
                                                    x:Name="DeleteSeekbar_btn"
                                                    Height="30"
                                                    Margin="5,0,0,0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Background="#6B0000"
                                                    BorderThickness="0"
                                                    Click="DeleteSeekbar_btn_Click"
                                                    Cursor="Hand"
                                                    Style="{DynamicResource CancelEditbutton}"
                                                    Visibility="{Binding SelectedMediaLinkSeekbarStyle.SystemDefault, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                    <Grid>
                                                        <Image
                                                            Width="15"
                                                            Height="15"
                                                            RenderOptions.BitmapScalingMode="Linear"
                                                            Source="/Img/Icons/Cross_ico.png" />
                                                    </Grid>
                                                </Button>

                                            </StackPanel>


                                            <StackPanel Margin="0,10,0,0" IsEnabled="{Binding SelectedMediaLinkSeekbarStyle.SystemDefault, Converter={StaticResource InvertBooleanConverter}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">

                                                <StackPanel Margin="0,0,0,0">
                                                    <TextBlock
                                                        Padding="0,5,0,3"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="18"
                                                        Foreground="#FF9983AD"
                                                        Text="Customize Characters" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock
                                                            Width="auto"
                                                            Padding="2,0,2,0"
                                                            VerticalAlignment="Center"
                                                            FontFamily="Albert Sans Thin"
                                                            FontSize="13"
                                                            Foreground="#FF9983AD"
                                                            Text="Filled:" />
                                                        <TextBox
                                                            Width="30"
                                                            Height="auto"
                                                            Margin="2,0,3,0"
                                                            Padding="5,0,5,5"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Center"
                                                            Background="#FF7B7195"
                                                            BorderThickness="0"
                                                            FontSize="19"
                                                            Foreground="#FF240E54"
                                                            Text="{Binding SelectedMediaLinkSeekbarStyle.FilledCharacter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        <TextBlock
                                                            Width="auto"
                                                            Padding="2,0,2,0"
                                                            VerticalAlignment="Center"
                                                            FontFamily="Albert Sans Thin"
                                                            FontSize="13"
                                                            Foreground="#FF9983AD"
                                                            Text="Middle:" />
                                                        <TextBox
                                                            Width="30"
                                                            Height="auto"
                                                            Margin="2,0,3,0"
                                                            Padding="5,0,5,5"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Center"
                                                            Background="#FF7B7195"
                                                            BorderThickness="0"
                                                            FontSize="19"
                                                            Foreground="#FF240E54"
                                                            Text="{Binding SelectedMediaLinkSeekbarStyle.MiddleCharacter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        <TextBlock
                                                            Width="auto"
                                                            Padding="2,0,2,0"
                                                            VerticalAlignment="Center"
                                                            FontFamily="Albert Sans Thin"
                                                            FontSize="13"
                                                            Foreground="#FF9983AD"
                                                            Text="Non Filled:" />
                                                        <TextBox
                                                            Width="30"
                                                            Height="auto"
                                                            Margin="2,0,3,0"
                                                            Padding="5,0,5,5"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Center"
                                                            Background="#FF7B7195"
                                                            BorderThickness="0"
                                                            FontSize="19"
                                                            Foreground="#FF240E54"
                                                            Text="{Binding SelectedMediaLinkSeekbarStyle.NonFilledCharacter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                </StackPanel>

                                                <StackPanel Margin="0,5,0,10" Orientation="Horizontal">
                                                    <TextBlock
                                                        Height="25"
                                                        Padding="0,6,2,0"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="13"
                                                        Foreground="#FF9983AD"
                                                        Text="Time Prefix:" />
                                                    <TextBox
                                                        Width="30"
                                                        MinWidth="20"
                                                        Margin="2,3,0,0"
                                                        Padding="5,0,5,0"
                                                        HorizontalAlignment="Left"
                                                        VerticalContentAlignment="Center"
                                                        Background="#FF7B7195"
                                                        BorderThickness="0"
                                                        FontSize="15"
                                                        Foreground="#FF240E54"
                                                        Text="{Binding SelectedMediaLinkSeekbarStyle.TimePrefix, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    <TextBlock
                                                        Height="25"
                                                        Padding="5,6,2,0"
                                                        VerticalAlignment="Center"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="13"
                                                        Foreground="#FF9983AD"
                                                        Text="Time Suffix:" />
                                                    <TextBox
                                                        Width="30"
                                                        Height="25"
                                                        MinWidth="20"
                                                        Margin="2,3,0,0"
                                                        Padding="5,0,5,0"
                                                        HorizontalAlignment="Left"
                                                        VerticalContentAlignment="Center"
                                                        Background="#FF7B7195"
                                                        BorderThickness="0"
                                                        FontSize="15"
                                                        Foreground="#FF240E54"
                                                        Text="{Binding SelectedMediaLinkSeekbarStyle.TimeSuffix, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                                <StackPanel Margin="0,0,0,0" Orientation="Horizontal">
                                                    <TextBlock
                                                        Height="25"
                                                        Padding="0,5,5,0"
                                                        VerticalAlignment="Center"
                                                        FontFamily="Albert Sans Thin"
                                                        FontSize="15"
                                                        Foreground="#FF9983AD"
                                                        Text="Progress bar length:" />
                                                    <TextBox
                                                        Width="auto"
                                                        Height="20"
                                                        MinWidth="25"
                                                        Padding="5,0,5,0"
                                                        Background="#FF7B7195"
                                                        BorderThickness="0"
                                                        FontSize="15"
                                                        Foreground="#FF240E54"
                                                        Text="{Binding SelectedMediaLinkSeekbarStyle.ProgressBarLength, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                                <CheckBox
                                                    Height="20"
                                                    Margin="3,7"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding SelectedMediaLinkSeekbarStyle.DisplayTime, Mode=TwoWay}"
                                                    Style="{DynamicResource SettingsCheckbox}">
                                                    Show current and max song time
                                                </CheckBox>
                                                <CheckBox
                                                    Height="20"
                                                    Margin="3,7"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding SelectedMediaLinkSeekbarStyle.TimePreSuffixOnTheInside, Mode=TwoWay}"
                                                    Style="{DynamicResource SettingsCheckbox}">
                                                    Place Pre-Suffix inside time
                                                </CheckBox>
                                                <CheckBox
                                                    Height="20"
                                                    Margin="3,7"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding SelectedMediaLinkSeekbarStyle.ShowTimeInSuperscript, Mode=TwoWay}"
                                                    Style="{DynamicResource SettingsCheckbox}">
                                                    Show time in stylized small numbers
                                                </CheckBox>
                                                <CheckBox
                                                    Height="20"
                                                    Margin="3,7"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding SelectedMediaLinkSeekbarStyle.SpaceAgainObjects, Mode=TwoWay}"
                                                    Style="{DynamicResource SettingsCheckbox}">
                                                    Automatically add space between objects
                                                </CheckBox>
                                                <CheckBox
                                                    Height="20"
                                                    Margin="3,7"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding SelectedMediaLinkSeekbarStyle.SpaceBetweenPreSuffixAndTime, Mode=TwoWay}"
                                                    Style="{DynamicResource SettingsCheckbox}">
                                                    Add space between pre-suffix and time
                                                </CheckBox>
                                                <CheckBox
                                                    Height="20"
                                                    Margin="3,7"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding SelectedMediaLinkSeekbarStyle.ProgressBarOnTop, Mode=TwoWay}"
                                                    Style="{DynamicResource SettingsCheckbox}">
                                                    Place progress bar above media info
                                                </CheckBox>




                                            </StackPanel>

                                        </StackPanel>



                                    </StackPanel>
                                </Border>



                            </StackPanel>
                        </Grid>

                    </Grid>
                    <Grid Grid.Row="9" Margin="0,5,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_AppOptions, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="App options"
                                TextOptions.TextRenderingMode="ClearType" />
                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Height="Auto"
                            Margin="34,10,0,0"
                            Visibility="{Binding Settings_AppOptions, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel>
                                <StackPanel>
                                    <TextBlock
                                        Grid.Column="0"
                                        Padding="0,0,0,3"
                                        HorizontalAlignment="Left"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="Local IP address" />
                                    <StackPanel Orientation="Horizontal">
                                        <TextBox
                                            x:Name="OSCIPBox"
                                            Width="100"
                                            Height="26"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding OSCIP, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <Button
                                            x:Name="ResetIP_btn"
                                            Width="auto"
                                            Height="26"
                                            Margin="5,0,0,0"
                                            Padding="5"
                                            Click="ResetIP_btn_Click"
                                            Style="{StaticResource Status_Button_style}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">

                                                        <Image
                                                            Width="15"
                                                            Height="15"
                                                            Margin="0,0,3,0"
                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                            Source="/Img/Icons/Load_ico.png" />
                                                        <TextBlock
                                                            Margin="0,-1,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            FontWeight="DemiBold"
                                                            Foreground="#9B90D1"
                                                            Text="Default" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                    </StackPanel>

                                    <TextBlock
                                        Grid.Column="0"
                                        Padding="0,10,0,3"
                                        HorizontalAlignment="Left"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="Port (outgoing)" />
                                    <StackPanel Margin="0,0,0,10" Orientation="Horizontal">
                                        <TextBox
                                            x:Name="OSCPortOut"
                                            Width="100"
                                            Height="26"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding OSCPortOut, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <Button
                                            x:Name="ResetOSCPortOut_btn"
                                            Width="auto"
                                            Height="26"
                                            Margin="5,0,0,0"
                                            Padding="5"
                                            Click="ResetOSCPortOut_btn_Click"
                                            Style="{StaticResource Status_Button_style}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">

                                                        <Image
                                                            Width="15"
                                                            Height="15"
                                                            Margin="0,0,3,0"
                                                            RenderOptions.BitmapScalingMode="HighQuality"
                                                            Source="/Img/Icons/Load_ico.png" />
                                                        <TextBlock
                                                            Margin="0,-1,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            FontWeight="DemiBold"
                                                            Foreground="#9B90D1"
                                                            Text="Default" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                    </StackPanel>
                                    <CheckBox
                                        x:Name="UnmuteMainOutput_checkbox"
                                        Height="21"
                                        Margin="0,0,0,15"
                                        BorderBrush="#FF2D1265"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding UnmuteMainOutput, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}">
                                        Toggle voice on main output
                                    </CheckBox>
                                </StackPanel>
                                <TextBlock
                                    Width="auto"
                                    Padding="0,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="15"
                                    Foreground="#FF9983AD"
                                    Text="OSC update rate" />
                                <StackPanel Margin="0,0,0,7" Orientation="Horizontal">
                                    <Slider
                                        x:Name="ScanningIntervalSensitivitySlider"
                                        Width="134.5"
                                        Height="12"
                                        Margin="2.2,0,4.5,0"
                                        IsSnapToTickEnabled="True"
                                        Maximum="10"
                                        Minimum="1.6"
                                        Style="{StaticResource CustomSlider}"
                                        TickFrequency="0.1"
                                        Value="{Binding Path=ScanningInterval, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Width="auto"
                                        Padding="5,0"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="13"
                                        Foreground="#FF7D7397"
                                        Text="{Binding ScanningInterval}" />
                                    <TextBlock
                                        Width="auto"
                                        Margin="-2,5"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="13"
                                        Foreground="#FF7D7397"
                                        Text="sec" />
                                </StackPanel>

                                <CheckBox
                                    x:Name="SecOSC_checkbox"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding SecOSC, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    2nd VRChat output
                                </CheckBox>
                                <Border
                                    Margin="0,0,0,15"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding SecOSC, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,0,0,0"
                                            HorizontalAlignment="Left"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="2nd IP address" />
                                        <TextBox
                                            x:Name="SecOSCIP"
                                            Width="100"
                                            Height="26"
                                            Margin="0,3,0,5"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding SecOSCIP, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,0,0,0"
                                            HorizontalAlignment="Left"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="2nd VRChat port (outgoing)" />
                                        <TextBox
                                            x:Name="SecOSCPort"
                                            Width="100"
                                            Height="26"
                                            Margin="0,3,0,0"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding SecOSCPort, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <CheckBox
                                            x:Name="ToggleVoiceSec"
                                            Height="21"
                                            Margin="0,10,0,0"
                                            BorderBrush="#FF2D1265"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding UnmuteSecOutput, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Toggle voice on this output
                                        </CheckBox>
                                    </StackPanel>
                                </Border>

                                <CheckBox
                                    x:Name="ThirdOSC_checkbox"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ThirdOSC, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    3rd VRChat output
                                </CheckBox>
                                <Border
                                    Margin="0,0,0,15"
                                    Background="#FF3B3054"
                                    CornerRadius="5,0,0,5"
                                    Visibility="{Binding ThirdOSC, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <StackPanel Margin="5">
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,0,0,0"
                                            HorizontalAlignment="Left"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="3rd IP address" />
                                        <TextBox
                                            x:Name="ThirdOSCIP"
                                            Width="100"
                                            Height="26"
                                            Margin="0,3,0,5"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding ThirdOSCIP, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,0,0,0"
                                            HorizontalAlignment="Left"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="3rd VRChat port (outgoing)" />
                                        <TextBox
                                            x:Name="ThirdOSCPort"
                                            Width="100"
                                            Height="26"
                                            Margin="0,3,0,0"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding ThirdOSCPort, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <CheckBox
                                            x:Name="ToggleVoiceThird"
                                            Height="21"
                                            Margin="0,10,0,0"
                                            BorderBrush="#FF2D1265"
                                            FontFamily="Comfortaa Light"
                                            FontSize="18"
                                            Foreground="#FFB9B5C1"
                                            IsChecked="{Binding UnmuteThirdOutput, Mode=TwoWay}"
                                            Style="{DynamicResource SettingsCheckbox}">
                                            Toggle voice on this output
                                        </CheckBox>
                                    </StackPanel>
                                </Border>
                                <CheckBox
                                    x:Name="CountOculusSystemAsVR_checkbox"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding CountOculusSystemAsVR, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Count Oculus System as VR running (experimental)
                                </CheckBox>

                                <CheckBox
                                    x:Name="WindowOnTop_checkbox"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding Topmost, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Always on top
                                </CheckBox>
                                <CheckBox
                                    x:Name="SeperateWithENTERS_checkbox"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding SeperateWithENTERS, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Separate integrations using 'ENTER' instead of '┆'
                                </CheckBox>
                                <CheckBox
                                    x:Name="ToggleVoiceWithV"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ToggleVoiceWithV, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Toggle VRChat voice with 'V'
                                </CheckBox>
                                <CheckBox
                                    x:Name="CheckUpdateOnStartup"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding CheckUpdateOnStartup, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    Auto check for updates on startup (recommended)
                                </CheckBox>
                                <CheckBox
                                    x:Name="ToggleJoinedApha"
                                    Height="21"
                                    Margin="0,0,0,15"
                                    BorderBrush="#FF2D1265"
                                    Content="Beta channel updates"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="{Binding VersionTxtColor}"
                                    IsChecked="{Binding JoinedAlphaChannel, Mode=TwoWay}"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Style="{DynamicResource SettingsCheckbox}">
                                    <CheckBox.Effect>
                                        <DropShadowEffect
                                            BlurRadius="15"
                                            Opacity="0.7"
                                            ShadowDepth="0"
                                            Color="{Binding VersionTxtColor}" />
                                    </CheckBox.Effect>
                                </CheckBox>

                                <Button
                                    x:Name="Rollback"
                                    Width="auto"
                                    Height="30"
                                    Margin="0,0,0,5"
                                    Padding="5"
                                    HorizontalAlignment="Left"
                                    Click="Rollback_Click"
                                    Opacity="0.7"
                                    Style="{StaticResource UpdatedGreenButtonStyle}"
                                    Visibility="{Binding RollBackUpdateAvailable, Converter={StaticResource InverseBoolToHiddenConverter}}">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image
                                                    Height="18"
                                                    Margin="0,0,4,0"
                                                    RenderOptions.BitmapScalingMode="HighQuality"
                                                    Source="/Img/Icons/downgrade.png" />
                                                <TextBlock
                                                    x:Name="RollBackVersion"
                                                    Margin="0,-2,5,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="15"
                                                    Text="{Binding DataContext.RollBackVersion, StringFormat='Rollback to {0}', RelativeSource={RelativeSource AncestorType={x:Type Window}}, UpdateSourceTrigger=PropertyChanged}" />


                                            </StackPanel>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>

                                <Button
                                    x:Name="UpdateByZipFile"
                                    Width="auto"
                                    Height="30"
                                    Margin="0,0,0,15"
                                    Padding="5"
                                    HorizontalAlignment="Left"
                                    Click="UpdateByZipFile_Click"
                                    Opacity="0.7"
                                    Style="{StaticResource UpdatedGreenButtonStyle}">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image
                                                    Height="18"
                                                    Margin="0,0,4,0"
                                                    Source="/Img/Icons/Upload.png" />
                                                <TextBlock
                                                    Margin="0,-2,5,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="15"
                                                    Text="Update with ZIP" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>

                                <StackPanel Orientation="Horizontal">
                                    <Button
                                        x:Name="ResetFavorites"
                                        Width="85"
                                        Height="25"
                                        Margin="0,0,5,15"
                                        HorizontalAlignment="Left"
                                        Click="ResetFavorites_Click"
                                        Content="Reset Status"
                                        Style="{DynamicResource Status_Button_style}" />
                                    <Button
                                        x:Name="OpenConfigFolder"
                                        Width="120"
                                        Height="25"
                                        Margin="5,0,5,15"
                                        Click="OpenConfigFolder_Click"
                                        Content="Open config folder"
                                        Style="{DynamicResource Status_Button_style}" />
                                    <Button
                                        x:Name="OpenLogFolder"
                                        Width="101"
                                        Height="25"
                                        Margin="5,0,5,15"
                                        Click="OpenLogFolder_Click"
                                        Content="Open log folder"
                                        Style="{DynamicResource Status_Button_style}" />

                                </StackPanel>
                            </StackPanel>
                        </Grid>


                    </Grid>
                    <Grid
                        Grid.Row="10"
                        Margin="0,5,0,0"
                        Visibility="{Binding Egg_Dev, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,0">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#EA005E" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_Dev, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyleDEV}"
                                Tag="EGG options"
                                TextOptions.TextRenderingMode="ClearType" />

                        </Grid>


                        <Grid
                            x:Name="Settings_Dev_Grid"
                            Grid.Row="1"
                            Height="Auto"
                            Margin="35,10,0,0"
                            Visibility="{Binding Settings_Dev, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <CheckBox
                                x:Name="BlankEgg_checkbox"
                                Height="20"
                                Margin="0,0,0,15"
                                BorderBrush="#FF2D1265"
                                Checked="Update_Click"
                                FontFamily="Comfortaa Light"
                                FontSize="18"
                                Foreground="#FFB9B5C1"
                                IsChecked="{Binding BlankEgg, Mode=TwoWay}"
                                Style="{DynamicResource SettingsCheckbox}"
                                Unchecked="Update_Click">
                                ItsByMe MODE
                            </CheckBox>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="11" Margin="0,5,0,10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.Background>
                            <LinearGradientBrush SpreadMethod="Pad" StartPoint="1,1" EndPoint="0,1">
                                <GradientStop Color="#FF3A3053" />
                                <GradientStop Offset="1" Color="#FF40365B" />
                            </LinearGradientBrush>
                        </Grid.Background>
                        <Grid Grid.Row="0">
                            <ToggleButton
                                Width="Auto"
                                Height="30"
                                HorizontalAlignment="Left"
                                FontSize="15"
                                FontWeight="Bold"
                                Foreground="#BDAEE2"
                                IsChecked="{Binding Settings_WindowActivity, Mode=TwoWay}"
                                Style="{StaticResource ExpandCollapseToggleButtonStyle}"
                                Tag="Window activity options"
                                TextOptions.TextRenderingMode="ClearType" />
                        </Grid>


                        <Grid
                            Grid.Row="1"
                            Width="auto"
                            Margin="10,0,2,0"
                            Visibility="{Binding Settings_WindowActivity, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <StackPanel>
                                <TextBlock
                                    Width="auto"
                                    Padding="0,10,0,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="15"
                                    Foreground="PaleVioletRed"
                                    Text="{Binding ErrorInWindowActivityMsg, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding ErrorInWindowActivity, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                <CheckBox
                                    x:Name="enhancedapp_checkbox"
                                    Height="20"
                                    Margin="0,15,0,0"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding ApplicationHookV2, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Enhanced hook for better app names
                                </CheckBox>
                                <CheckBox
                                    x:Name="WindowActivityTitleScan_checkbox"
                                    Height="20"
                                    Margin="0,15,0,0"
                                    BorderBrush="#FF2D1265"
                                    Checked="Update_Click"
                                    FontFamily="Comfortaa Light"
                                    FontSize="18"
                                    Foreground="#FFB9B5C1"
                                    IsChecked="{Binding WindowActivityTitleScan, Mode=TwoWay}"
                                    Style="{DynamicResource SettingsCheckbox}"
                                    Unchecked="Update_Click">
                                    Show more info about focusing app
                                </CheckBox>
                                <StackPanel Visibility="{Binding WindowActivityTitleScan, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                    <CheckBox
                                        x:Name="AutoShowTitleOnNewAppn_checkbox"
                                        Height="20"
                                        Margin="0,15,0,0"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding AutoShowTitleOnNewApp, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Auto show info on new app
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="TitleOnAppVR_checkbox"
                                        Height="20"
                                        Margin="0,15,0,0"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding TitleOnAppVR, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show info in VR mode
                                    </CheckBox>
                                    <CheckBox
                                        x:Name="LimitTitleOnApp_checkbox"
                                        Height="20"
                                        Margin="0,15,0,0"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding LimitTitleOnApp, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Limit info length on app
                                    </CheckBox>
                                    <StackPanel Margin="0,10,0,-10" Visibility="{Binding LimitTitleOnApp, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <TextBlock
                                            Grid.Column="0"
                                            Padding="0,0,0,0"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="15"
                                            Foreground="#FF9983AD"
                                            Text="max title length" />
                                        <TextBox
                                            x:Name="MaxShowTitleCount_INT"
                                            Width="40"
                                            Height="26"
                                            Margin="0,3,0,10"
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding MaxShowTitleCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <CheckBox
                                        x:Name="LimitTitleOnsApp_checkbox"
                                        Height="20"
                                        Margin="0,15,0,0"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding WindowActivityShowFocusedApp, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show desktop focused app
                                    </CheckBox>
                                    <TextBlock
                                        Width="auto"
                                        Padding="0,10,0,0"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="Desktop mode style" />
                                    <StackPanel Orientation="Horizontal">
                                        <TextBox
                                            x:Name="WindowActivityDesktopTitle"
                                            Width="auto"
                                            Height="26"
                                            Margin="0,3,0,0"
                                            Padding="5,0,5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding WindowActivityDesktopTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox
                                            x:Name="WindowActivityDesktopFocusTitle"
                                            Width="auto"
                                            Height="26"
                                            Margin="5,3,0,0"
                                            Padding="5,0,5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding WindowActivityDesktopFocusTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Visibility="{Binding WindowActivityShowFocusedApp, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox
                                            x:Name="PrivateAppCustom"
                                            Width="auto"
                                            Height="26"
                                            Margin="4,3,0,0"
                                            Padding="5,0,5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding WindowActivityPrivateName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Visibility="{Binding WindowActivityShowFocusedApp, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <CheckBox
                                        x:Name="IntgrScanFsorc_checkbox"
                                        Height="20"
                                        Margin="0,15,0,0"
                                        BorderBrush="#FF2D1265"
                                        Checked="Update_Click"
                                        FontFamily="Comfortaa Light"
                                        FontSize="18"
                                        Foreground="#FFB9B5C1"
                                        IsChecked="{Binding IntgrScanForce, Mode=TwoWay}"
                                        Style="{DynamicResource SettingsCheckbox}"
                                        Unchecked="Update_Click">
                                        Show VR focused app
                                    </CheckBox>
                                    <TextBlock
                                        Width="auto"
                                        Padding="0,10,0,0"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="15"
                                        Foreground="#FF9983AD"
                                        Text="VR mode style" />
                                    <StackPanel Orientation="Horizontal">
                                        <TextBox
                                            x:Name="WindowActivityVRTitle"
                                            Width="auto"
                                            Height="26"
                                            Margin="0,3,0,0"
                                            Padding="5,0,5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding WindowActivityVRTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox
                                            x:Name="WindowActivityVRFocusTitle"
                                            Width="auto"
                                            Height="26"
                                            Margin="5,3,0,0"
                                            Padding="5,0,5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding WindowActivityVRFocusTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Visibility="{Binding IntgrScanForce, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox
                                            x:Name="PrivateAppCustomVR"
                                            Width="auto"
                                            Height="26"
                                            Margin="4,3,0,0"
                                            Padding="5,0,5,0"
                                            HorizontalAlignment="Left"
                                            VerticalContentAlignment="Center"
                                            Background="#FF7B7195"
                                            BorderThickness="0"
                                            FontSize="15"
                                            Foreground="#FF240E54"
                                            Text="{Binding WindowActivityPrivateNameVR, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Visibility="{Binding IntgrScanForce, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                </StackPanel>

                            </StackPanel>
                            <TextBlock
                                Grid.Row="2"
                                Margin="0,15,0,5"
                                FontFamily="Albert Sans Thin"
                                FontSize="15"
                                Foreground="#FF9983AD"
                                Text="Cleanup action" />
                            <StackPanel Grid.Row="3" Orientation="Horizontal">
                                <Button
                                    x:Name="SmartClearnup"
                                    Width="60"
                                    Height="25"
                                    Margin="0,0,5,0"
                                    HorizontalAlignment="Left"
                                    Click="SmartClearnup_Click"
                                    Content="Smart"
                                    Style="{DynamicResource Status_Button_style}" />
                                <Button
                                    x:Name="ClearnupKeepSettings"
                                    Width="150"
                                    Height="25"
                                    Margin="0,0,5,0"
                                    HorizontalAlignment="Left"
                                    Click="ClearnupKeepSettings_Click"
                                    Content="Keep apps with settings"
                                    Style="{DynamicResource Status_Button_style}" />
                                <Button
                                    x:Name="ResetWindowActivity"
                                    Width="50"
                                    Height="25"
                                    Margin="0,0,5,0"
                                    HorizontalAlignment="Left"
                                    Click="ResetWindowActivity_Click"
                                    Content="Reset"
                                    Style="{DynamicResource Status_Button_style}" />
                                <TextBlock
                                    Grid.Column="0"
                                    Margin="0,3,0,0"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="16"
                                    Foreground="#FF9983AD"
                                    Text="{Binding DeletedAppslabel, UpdateSourceTrigger=PropertyChanged}" />
                            </StackPanel>
                            <Border
                                Grid.Row="4"
                                Width="745"
                                Margin="0,15,1,0"
                                HorizontalAlignment="Left"
                                Background="DarkSlateBlue"
                                CornerRadius="5">
                                <Grid Margin="10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="150" />
                                        <ColumnDefinition Width="80" />
                                        <ColumnDefinition Width="125" />
                                        <ColumnDefinition Width="100" />
                                        <ColumnDefinition Width="65" />
                                        <ColumnDefinition Width="185" />
                                    </Grid.ColumnDefinitions>

                                    <Button
                                        Grid.Column="0"
                                        Margin="3,0"
                                        Command="{Binding SortScannedAppsByProcessNameCommand}"
                                        Style="{StaticResource Sort_Button_style}">
                                        <TextBlock
                                            Padding="5"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Text="App" />
                                    </Button>
                                    <Button
                                        Grid.Column="1"
                                        Margin="3,0"
                                        Command="{Binding SortScannedAppsByFocusCountCommand}"
                                        Style="{StaticResource Sort_Button_style}">
                                        <TextBlock
                                            Padding="5"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Text="Focused" />
                                    </Button>
                                    <Button
                                        Grid.Column="2"
                                        Margin="3,0"
                                        Command="{Binding SortScannedAppsByUsedNewMethodCommand}"
                                        Style="{StaticResource Sort_Button_style}">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Text="Enhanced hook" />
                                    </Button>
                                    <Button
                                        Grid.Column="3"
                                        Margin="3,0"
                                        Command="{Binding SortScannedAppsByIsShowInfoAppCommand}"
                                        Style="{StaticResource Sort_Button_style}">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Text="Show info" />
                                    </Button>
                                    <Button
                                        Grid.Column="4"
                                        Margin="3,0"
                                        Command="{Binding SortScannedAppsByIsPrivateAppCommand}"
                                        Style="{StaticResource Sort_Button_style}">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Text="Private" />
                                    </Button>
                                    <Button
                                        Grid.Column="5"
                                        Margin="3,0"
                                        Command="{Binding SortScannedAppsByApplyCustomAppNameCommand}"
                                        Style="{StaticResource Sort_Button_style}">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            Text="Custom app name" />
                                    </Button>
                                </Grid>
                                <Border.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Direction="0"
                                        Opacity="0.5"
                                        RenderingBias="Performance"
                                        ShadowDepth="0"
                                        Color="black" />
                                </Border.Effect>
                            </Border>
                            <ItemsControl
                                Grid.Row="5"
                                Width="745"
                                HorizontalAlignment="Left"
                                ItemsSource="{Binding ScannedApps, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type vm:ProcessInfo}">
                                        <Border
                                            Margin="0,15,0,0"
                                            Background="DarkSlateBlue"
                                            CornerRadius="5"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor">

                                            <Grid Margin="10">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="150" />
                                                    <ColumnDefinition Width="80" />
                                                    <ColumnDefinition Width="125" />
                                                    <ColumnDefinition Width="100" />
                                                    <ColumnDefinition Width="65" />
                                                    <ColumnDefinition Width="180" />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock
                                                    Grid.Column="0"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="16"
                                                    Foreground="#FFB9B5C1"
                                                    Text="{Binding ProcessName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Grid.Column="1"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="16"
                                                    Foreground="#FFB9B5C1"
                                                    Text="{Binding FocusCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock
                                                    Grid.Column="2"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="16"
                                                    Foreground="#FFB9B5C1"
                                                    Text="{Binding UsedNewMethod, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <CheckBox
                                                    x:Name="ShowTitle"
                                                    Grid.Column="3"
                                                    Width="23"
                                                    Height="20"
                                                    HorizontalAlignment="Center"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding ShowTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{DynamicResource SettingsCheckbox}" />
                                                <CheckBox
                                                    x:Name="IsPrivateApp"
                                                    Grid.Column="4"
                                                    Width="23"
                                                    Height="20"
                                                    HorizontalAlignment="Center"
                                                    BorderBrush="#FF2D1265"
                                                    FontFamily="Comfortaa Light"
                                                    FontSize="18"
                                                    Foreground="#FFB9B5C1"
                                                    IsChecked="{Binding IsPrivateApp, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Style="{DynamicResource SettingsCheckbox}" />
                                                <StackPanel
                                                    Grid.Column="5"
                                                    Width="auto"
                                                    Orientation="Horizontal">
                                                    <CheckBox
                                                        x:Name="ApplyCustomAppName"
                                                        Width="23"
                                                        Height="20"
                                                        Margin="5,0,0,0"
                                                        BorderBrush="#FF2D1265"
                                                        FontFamily="Comfortaa Light"
                                                        FontSize="18"
                                                        Foreground="#FFB9B5C1"
                                                        IsChecked="{Binding ApplyCustomAppName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        Style="{DynamicResource SettingsCheckbox}" />
                                                    <TextBox
                                                        Width="800"
                                                        Margin="5,0,0,0"
                                                        Padding="5,0,0,0"
                                                        VerticalAlignment="Center"
                                                        VerticalContentAlignment="Center"
                                                        Background="#FF7B7195"
                                                        BorderThickness="0"
                                                        FontSize="15"
                                                        Foreground="#FF240E54"
                                                        Text="{Binding CustomAppName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                        <TextBox.Style>
                                                            <Style TargetType="{x:Type TextBox}">
                                                                <Setter Property="Opacity" Value="0.3" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding ApplyCustomAppName}" Value="True">
                                                                        <Setter Property="Opacity" Value="1" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBox.Style>

                                                    </TextBox>
                                                </StackPanel>
                                            </Grid>
                                            <Border.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="10"
                                                    Direction="0"
                                                    Opacity="0.5"
                                                    RenderingBias="Performance"
                                                    ShadowDepth="0"
                                                    Color="black" />
                                            </Border.Effect>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Grid>
                    </Grid>
                </Grid>
            </ScrollViewer>
            <Grid
                Grid.Row="1"
                d:Visibility="Visible"
                Background="#FF3B3054"
                Visibility="{Binding MenuItem_2_Visibility}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="31" />
                    <RowDefinition Height="35" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="60" />
                </Grid.RowDefinitions>
                <Border
                    Margin="3"
                    BorderThickness="0"
                    CornerRadius="5">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                            <LinearGradientBrush.RelativeTransform>
                                <TransformGroup>
                                    <ScaleTransform CenterX="0.5" CenterY="0.5" />
                                    <SkewTransform CenterX="0.5" CenterY="0.5" />
                                    <RotateTransform Angle="90" CenterX="0.5" CenterY="0.5" />
                                    <TranslateTransform />
                                </TransformGroup>
                            </LinearGradientBrush.RelativeTransform>
                            <GradientStop Color="#FFC950EF" />
                            <GradientStop Offset="1" Color="#FFA550EF" />
                        </LinearGradientBrush>
                    </Border.Background>

                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ChatTopBarTxt.Length}" Value="0">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock
                        Grid.Column="0"
                        Margin="4"
                        Padding="4,0,50,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        d:Text="You're soaring past the 140 char limit by {overmax}."
                        FontFamily="Albert Sans Thin"
                        FontSize="14"
                        Foreground="#FFF3E8FF"
                        Text="{Binding ChatTopBarTxt}">
                        <TextBlock.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </TextBlock.Effect>
                    </TextBlock>
                </Border>

                <Grid
                    Grid.Row="4"
                    Width="758"
                    Height="68"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="672" />
                        <ColumnDefinition Width="150" />
                    </Grid.ColumnDefinitions>
                    <Button
                        x:Name="ButtonChattingTxt"
                        Grid.ColumnSpan="2"
                        Width="84"
                        Margin="666,14,0,14"
                        HorizontalAlignment="Left"
                        Click="ButtonChattingTxt_Click"
                        Content="Send"
                        Style="{DynamicResource Status_Button_style}" />
                    <TextBox
                        x:Name="NewChattingTxt"
                        Height="40"
                        Margin="5,0,0,0"
                        Padding="8,0,93,0"
                        HorizontalContentAlignment="Left"
                        VerticalContentAlignment="Center"
                        Background="#FF7B7195"
                        BorderThickness="0"
                        FontSize="15"
                        Foreground="#FF240E54"
                        KeyDown="NewChattingTxt_KeyDown"
                        Text="{Binding NewChattingTxt, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        TextAlignment="Left"
                        TextChanged="NewChattingTxt_TextChanged"
                        TextWrapping="Wrap">
                        <TextBox.Resources>
                            <Style TargetType="{x:Type Border}">
                                <Setter Property="CornerRadius" Value="5" />
                            </Style>
                        </TextBox.Resources>
                        <TextBox.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </TextBox.Effect>
                    </TextBox>

                    <StackPanel
                        Margin="0,0,3,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">

                        <TextBlock
                            Grid.Column="0"
                            Padding="0,0,3,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="12"
                            Foreground="{Binding ChatBoxColor}"
                            Text="{Binding ChatBoxCount}" />

                        <Button
                            x:Name="Paste_Chatting"
                            Width="auto"
                            Height="35"
                            Margin="0,0,1,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Click="Paste_Chatting_Click"
                            Style="{DynamicResource Textblock_Button_style}"
                            ToolTip="Paste"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="18"
                                    Margin="0,0,0,0"
                                    Source="/Img/Icons/PasteChat_ico.png" />
                            </StackPanel>
                        </Button>




                        <Grid>
                            <Button
                                x:Name="CleanChatting_btn"
                                Width="auto"
                                Height="35"
                                Margin="0,0,0,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Click="CleanChatting_btn_Click"
                                Style="{DynamicResource Textblock_Button_style}"
                                ToolTip="Clear chat"
                                WindowChrome.IsHitTestVisibleInChrome="True">
                                <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                    <Image
                                        Width="18"
                                        Margin="0,0,0,0"
                                        Opacity="1"
                                        Source="/Img/Icons/Remove_icon.png" />
                                </StackPanel>
                            </Button>
                            <Grid.Style>
                                <Style TargetType="{x:Type Grid}">
                                    <Setter Property="Visibility" Value="Visible" />
                                    <Style.Triggers>
                                        <!--  Trigger to make the Grid visible when NewChattingTxt has text  -->
                                        <DataTrigger Binding="{Binding Text, ElementName=NewChattingTxt}" Value="">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                        <!--  Trigger to keep the Grid collapsed when NewChattingTxt has no text  -->
                                        <DataTrigger Binding="{Binding Text, ElementName=NewChattingTxt}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                        <!--  Default state when there is content in the Text  -->
                                        <DataTrigger Binding="{Binding Text, ElementName=NewChattingTxt}">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>




                        </Grid>



                    </StackPanel>


                    <TextBlock
                        Height="40"
                        Margin="5,0,55,0"
                        Padding="8,9,5,0"
                        VerticalAlignment="Center"
                        FontSize="15"
                        Foreground="#FF3D2F5F"
                        IsHitTestVisible="False"
                        Text="Send a chat message"
                        TextAlignment="Left">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Text, ElementName=NewChattingTxt}" Value="">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding ElementName=NewChattingTxt, Path=IsFocused}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>

                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
                <Grid Grid.Row="1" Background="#FF493F65">
                    <Grid.Effect>
                        <DropShadowEffect
                            BlurRadius="10"
                            Direction="-90"
                            Opacity="0.5"
                            RenderingBias="Performance"
                            ShadowDepth="5"
                            Color="#FF7F759A" />
                    </Grid.Effect>
                    <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                        <TextBlock
                            Margin="8,0,0,0"
                            d:Text="Chat feedback"
                            FontFamily="Albert Sans Thin"
                            FontSize="16"
                            Foreground="#FF9983AD"
                            Text="{Binding ChatFeedbackTxt}"
                            Visibility="{Binding IntelliChatModule.Settings.IntelliChatUILabel, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock
                            Padding="8,0,15,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            d:Text="Connecting with OpenAI..."
                            FontFamily="Albert Sans Thin"
                            FontSize="16"
                            Text="{Binding IntelliChatModule.Settings.IntelliChatUILabelTxt, UpdateSourceTrigger=PropertyChanged}"
                            Visibility="{Binding IntelliChatModule.Settings.IntelliChatUILabel, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <TextBlock.Foreground>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <LinearGradientBrush.RelativeTransform>
                                        <TransformGroup>
                                            <ScaleTransform CenterX="0.5" CenterY="0.5" />
                                            <SkewTransform CenterX="0.5" CenterY="0.5" />
                                            <RotateTransform Angle="79.54" CenterX="0.5" CenterY="0.5" />
                                            <TranslateTransform />
                                        </TransformGroup>
                                    </LinearGradientBrush.RelativeTransform>
                                    <GradientStop Color="#FF21C161" />
                                    <GradientStop Offset="1" Color="#FFC1BEC7" />
                                </LinearGradientBrush>
                            </TextBlock.Foreground>
                        </TextBlock>


                    </StackPanel>

                    <StackPanel
                        HorizontalAlignment="Right"
                        d:Visibility="Visible"
                        Orientation="Horizontal"
                        Visibility="{Binding CountDownUI, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                        <TextBlock
                            Grid.Column="0"
                            Margin="4,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="14"
                            Foreground="#FF9983AD"
                            Text="Visible for " />
                        <TextBlock
                            Grid.Column="0"
                            Margin="0,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="14"
                            Foreground="#FF9983AD"
                            Text="{Binding ScanPauseCountDown, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBlock
                            Grid.Column="0"
                            Margin="0,0,157,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="14"
                            Foreground="#FF9983AD"
                            Text=" seconds"
                            Visibility="{Binding CountDownUI, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />

                    </StackPanel>

                    <Button
                        x:Name="ClearChat"
                        Width="80"
                        Margin="0,5,20,5"
                        HorizontalAlignment="Right"
                        Click="ClearChat_Click"
                        Content="Clear history"
                        Style="{DynamicResource Status_Button_style}" />
                    <Button
                        x:Name="StopChat"
                        Width="40"
                        Margin="0,5,105,5"
                        HorizontalAlignment="Right"
                        Click="StopChat_Click"
                        Content="Stop"
                        Style="{DynamicResource Status_Button_style}" />
                </Grid>
                <Grid Grid.Row="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <ScrollViewer
                        Name="RecentScroll"
                        Margin="7,0,0,0"
                        Visibility="Visible">
                        <ItemsControl
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            ItemsSource="{Binding LastMessages, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Vertical" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Width="735"
                                        Height="auto"
                                        Margin="8,0,0,8"
                                        BorderThickness="0"
                                        CornerRadius="5"
                                        Opacity="{Binding Opacity}">
                                        <Grid>
                                            <Border
                                                Width="auto"
                                                Height="auto"
                                                BorderThickness="0"
                                                CornerRadius="5"
                                                Opacity="{Binding Opacity}"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor">
                                                <Border.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="10"
                                                        Direction="0"
                                                        Opacity="0.5"
                                                        RenderingBias="Performance"
                                                        ShadowDepth="0"
                                                        Color="black" />
                                                </Border.Effect>
                                                <Border.Background>
                                                    <LinearGradientBrush SpreadMethod="Reflect" StartPoint="1,1" EndPoint="1,0">
                                                        <GradientStop Color="DarkSlateBlue" />
                                                        <GradientStop Offset="1" Color="#524D75" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                            <Grid
                                                Width="auto"
                                                Height="auto"
                                                VerticalAlignment="Center">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="auto" />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock
                                                    Grid.Column="0"
                                                    Width="auto"
                                                    Height="Auto"
                                                    Padding="15,15,0,15"
                                                    HorizontalAlignment="Stretch"
                                                    Background="Transparent"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="18"
                                                    Foreground="LightGray"
                                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                    Text="{Binding Msg, UpdateSourceTrigger=PropertyChanged}"
                                                    TextWrapping="Wrap"
                                                    Visibility="{Binding CanLiveEditRun, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                    <TextBlock.Effect>
                                                        <DropShadowEffect
                                                            BlurRadius="20"
                                                            Opacity="0.9"
                                                            RenderingBias="Performance"
                                                            ShadowDepth="0"
                                                            Color="WhiteSmoke" />
                                                    </TextBlock.Effect>
                                                </TextBlock>
                                                <TextBox
                                                    x:Name="EditChatTextBox"
                                                    Grid.Column="0"
                                                    Width="auto"
                                                    Height="Auto"
                                                    Padding="13,15,0,15"
                                                    HorizontalAlignment="Stretch"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    FontFamily="Albert Sans Thin"
                                                    FontSize="18"
                                                    FontWeight="DemiBold"
                                                    Foreground="#6FC2EC"
                                                    IsReadOnly="{Binding CanLiveEditRun, Converter={StaticResource InvertBooleanConverter}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                    KeyDown="EditChatTextBox_KeyDown"
                                                    Text="{Binding MsgReplace, UpdateSourceTrigger=PropertyChanged}"
                                                    TextChanged="EditChatTextBox_TextChanged"
                                                    TextWrapping="Wrap"
                                                    Visibility="{Binding CanLiveEditRun, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                    <TextBox.Effect>
                                                        <DropShadowEffect
                                                            BlurRadius="20"
                                                            Opacity="0.9"
                                                            RenderingBias="Performance"
                                                            ShadowDepth="0"
                                                            Color="#B0E6FC" />
                                                    </TextBox.Effect>
                                                </TextBox>
                                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                    <Grid>
                                                        <Button
                                                            x:Name="CancelEditChatbutton"
                                                            Grid.Row="0"
                                                            Grid.Column="1"
                                                            Width="20"
                                                            Height="40"
                                                            Margin="0,0,0,0"
                                                            HorizontalAlignment="Right"
                                                            VerticalAlignment="Center"
                                                            Background="#6B0000"
                                                            BorderThickness="0"
                                                            Click="CancelEditChatbutton_Click"
                                                            Cursor="Hand"
                                                            Style="{DynamicResource CancelEditbutton}"
                                                            Tag="{Binding}"
                                                            Visibility="{Binding CanLiveEditRun, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                            <Grid>
                                                                <Image
                                                                    Width="15"
                                                                    Height="15"
                                                                    RenderOptions.BitmapScalingMode="Linear"
                                                                    Source="/Img/Icons/Cross_ico.png" />
                                                            </Grid>
                                                        </Button>
                                                    </Grid>

                                                    <ToggleButton
                                                        Width="auto"
                                                        Margin="5,5,0,5"
                                                        Padding="5,0"
                                                        HorizontalAlignment="Right"
                                                        Checked="ToggleButton_Checked"
                                                        Content="{Binding LiveEditButtonTxt}"
                                                        IsChecked="{Binding CanLiveEditRun, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                        Style="{DynamicResource Status_Toggle_style}"
                                                        Tag="{Binding}"
                                                        Unchecked="ToggleButton_Checked"
                                                        Visibility="{Binding CanLiveEdit, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                                    <Button
                                                        Width="auto"
                                                        Margin="5,5,0,5"
                                                        Padding="5,0"
                                                        HorizontalAlignment="Right"
                                                        Click="OnSendAgain"
                                                        Content="Resend"
                                                        IsEnabled="{Binding CanLiveEditRun, Converter={StaticResource InvertBooleanConverter}, UpdateSourceTrigger=PropertyChanged}"
                                                        Style="{DynamicResource Status_Button_style}"
                                                        Tag="{Binding}" />
                                                    <Button
                                                        Width="auto"
                                                        Margin="5"
                                                        Padding="5,0"
                                                        HorizontalAlignment="Right"
                                                        Command="{Binding CopyToClipboardCommand}"
                                                        CommandParameter="{Binding Msg}"
                                                        Style="{DynamicResource Status_Button_style}">
                                                        <Image Width="18" Source="/Img/Icons/Copy_ico.png" />
                                                    </Button>

                                                </StackPanel>

                                            </Grid>

                                        </Grid>



                                    </Border>

                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    <Grid
                        x:Name="AIResponse"
                        Grid.Row="1"
                        Height="auto"
                        Margin="6,0,7,7"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Bottom"
                        d:Visibility="Collapsed"
                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                        Visibility="{Binding IntelliChatModule.Settings.IntelliChatWaitingToAccept, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                        <Border Margin="10,0" CornerRadius="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="#3E5750" />
                                    <GradientStop Offset="1" Color="#403670" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="35"
                                    Direction="-90"
                                    Opacity="0.5"
                                    RenderingBias="Performance"
                                    ShadowDepth="5"
                                    Color="LightGreen" />
                            </Border.Effect>
                            <Grid Margin="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="55" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="Auto" MinHeight="40" />
                                </Grid.RowDefinitions>


                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Width="auto"
                                    Height="Auto"
                                    Margin="0,0,95,0"
                                    Padding="15,0,0,15"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="15"
                                    Foreground="AntiqueWhite"
                                    Text="{Binding IntelliChatModule.Settings.IntelliChatTxt, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="Wrap">
                                    <TextBlock.Effect>
                                        <DropShadowEffect
                                            BlurRadius="20"
                                            Opacity="1"
                                            RenderingBias="Performance"
                                            ShadowDepth="0"
                                            Color="Black" />
                                    </TextBlock.Effect>
                                </TextBlock>



                                <!--  Image  -->
                                <Image
                                    Grid.RowSpan="2"
                                    Grid.Column="1"
                                    Width="30"
                                    Height="auto"
                                    Margin="5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Effect="{StaticResource ImageShadowEffect}"
                                    Opacity="0.5"
                                    RenderOptions.BitmapScalingMode="HighQuality"
                                    Source="/Img/Icons/OpenAI.png" />

                                <StackPanel Height="auto" Orientation="Horizontal">

                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="15,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="18"
                                        Foreground="#94CCBF"
                                        Text="IntelliChat">
                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="20"
                                                Opacity="0.9"
                                                RenderingBias="Performance"
                                                ShadowDepth="0"
                                                Color="Purple" />
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="5,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Foreground="#94CCBF"
                                        Opacity="0.6"
                                        Text="Tokens:" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="2,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Foreground="#94CCBF"
                                        Opacity="0.6"
                                        Text="{Binding IntelliChatModule.Settings.TokenUsageData.LastRequestTotalTokens, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="5,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Foreground="#94CCBF"
                                        Opacity="0.6"
                                        Text="Model:" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="2,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Foreground="#94CCBF"
                                        Opacity="0.6"
                                        Text="{Binding IntelliChatModule.Settings.TokenUsageData.LastRequestModelName, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="5,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Foreground="#94CCBF"
                                        Opacity="0.3"
                                        Text="Today tokens:" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="2,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Foreground="#94CCBF"
                                        Opacity="0.3"
                                        Text="{Binding IntelliChatModule.Settings.TokenUsageData.TotalDailyTokens, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="5,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Style="{StaticResource CharacterCountTextStyle}"
                                        Text="Characters:" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="5,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Style="{StaticResource CharacterCountTextStyle}"
                                        Text="{Binding IntelliChatModule.Settings.IntelliChatTxt.Length, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock
                                        Width="auto"
                                        Height="Auto"
                                        Padding="0,10,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="12"
                                        Style="{StaticResource CharacterCountTextStyle}"
                                        Text="/144" />


                                </StackPanel>
                                <TextBlock
                                    Width="auto"
                                    Height="Auto"
                                    Margin="0,0,-10,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="12"
                                    Foreground="#94CCBF"
                                    Opacity="0.3"
                                    Text="Powered by OpenAI" />

                                <StackPanel
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Margin="-70,5,0,5"
                                    Orientation="Horizontal">
                                    <Button
                                        x:Name="AcceptAndSentIntelliChat"
                                        Width="auto"
                                        Margin="2"
                                        Padding="2"
                                        Click="AcceptAndSentIntelliChat_Click"
                                        Style="{DynamicResource Status_Button_style}">
                                        <StackPanel Orientation="Horizontal">
                                            <Image
                                                Width="18"
                                                Margin="2"
                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                Source="/Img/Icons/Accept_ico.png" />
                                            <TextBlock
                                                Padding="3,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="13"
                                                Foreground="#FF8D7DB9"
                                                Text="Sent" />
                                        </StackPanel>

                                    </Button>
                                    <Button
                                        x:Name="NotAcceptIntelliChat"
                                        Width="auto"
                                        Margin="2"
                                        Padding="2"
                                        Click="NotAcceptIntelliChat_Click"
                                        Style="{DynamicResource Status_Button_style}">
                                        <Image
                                            Width="18"
                                            Margin="1"
                                            RenderOptions.BitmapScalingMode="HighQuality"
                                            Source="/Img/Icons/NotAccept_ico.png" />
                                    </Button>
                                    <Button
                                        x:Name="AcceptIntelliChat"
                                        Width="auto"
                                        Margin="2"
                                        Padding="2"
                                        Click="AcceptIntelliChat_Click"
                                        Style="{DynamicResource Status_Button_style}">
                                        <Image
                                            Width="18"
                                            Margin="1"
                                            RenderOptions.BitmapScalingMode="HighQuality"
                                            Source="/Img/Icons/Accept_ico.png" />
                                    </Button>
                                </StackPanel>

                            </Grid>

                        </Border>
                    </Grid>
                    <Grid
                        x:Name="AIErrorResponse"
                        Grid.Row="1"
                        Height="auto"
                        Margin="6,0,7,7"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Bottom"
                        d:Visibility="Collapsed"
                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                        Visibility="{Binding IntelliChatModule.Settings.IntelliChatError, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                        <Border Margin="10,0" CornerRadius="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="MediumVioletRed" />
                                    <GradientStop Offset="1" Color="#403670" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="35"
                                    Direction="-90"
                                    Opacity="0.9"
                                    RenderingBias="Performance"
                                    ShadowDepth="5"
                                    Color="MediumVioletRed" />
                            </Border.Effect>
                            <Grid Margin="3">

                                <StackPanel
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Width="auto"
                                        Height="Auto"
                                        Padding="15,15,0,15"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        FontFamily="Albert Sans Thin"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Foreground="MediumVioletRed"
                                        Text="{Binding IntelliChatModule.Settings.IntelliChatErrorTxt, UpdateSourceTrigger=PropertyChanged}"
                                        TextWrapping="Wrap">
                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="20"
                                                Opacity="1"
                                                RenderingBias="Performance"
                                                ShadowDepth="0"
                                                Color="Black" />
                                        </TextBlock.Effect>
                                    </TextBlock>


                                </StackPanel>

                                <Button
                                    x:Name="CloseIntelliErrorPanel"
                                    Width="auto"
                                    Padding="6"
                                    HorizontalAlignment="Right"
                                    Click="CloseIntelliErrorPanel_Click"
                                    Opacity="0.8"
                                    Style="{DynamicResource Status_Button_style}">
                                    <Image
                                        Width="18"
                                        RenderOptions.BitmapScalingMode="HighQuality"
                                        Source="/Img/Icons/NotAccept_ico.png" />
                                </Button>





                            </Grid>

                        </Border>
                    </Grid>
                </Grid>
                <Grid
                    Grid.Row="3"
                    Height="auto"
                    HorizontalAlignment="Stretch"
                    Background="#FF493F65">
                    <Grid.Effect>
                        <DropShadowEffect
                            BlurRadius="10"
                            Direction="90"
                            Opacity="0.5"
                            RenderingBias="Performance"
                            ShadowDepth="5"
                            Color="#FF7F759A" />
                    </Grid.Effect>
                    <StackPanel
                        Margin="15,5,0,5"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Orientation="Horizontal"
                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                        Visibility="{Binding HideOpenAITools, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                        <StackPanel.Style>
                            <Style TargetType="StackPanel">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IntelliChatRequesting}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </StackPanel.Style>
                        <Button
                            x:Name="SpellingCheck"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="SpellingCheck_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Spelling check by AI"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="25"
                                    Margin="3,0,0,0"
                                    Source="/Img/Icons/SpellingCheck.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    Text="Spel/Grammer check" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="RebuildChat"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="RebuildChat_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Rebuild chat by AI"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="25"
                                    Margin="3,0,0,0"
                                    Source="/Img/Icons/RebuildChat.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Magic Improve" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="TranslateChat"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="TranslateChat_click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Translate anything with the help of AI"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="25"
                                    Margin="3,0,0,0"
                                    Opacity="0.5"
                                    Source="/Img/Icons/Translate_ico.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Translate" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="ShortenChat"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="ShortenChat_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Shorten chat by AI"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="25"
                                    Margin="3,0,0,0"
                                    Opacity="0.5"
                                    Source="/Img/Icons/Cut_ico.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Shorten" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="ConvoStarterChat"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="ConvoStarterChat_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Start a conversation by AI"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="22"
                                    Margin="3,0,0,0"
                                    Opacity="0.5"
                                    Source="/Img/Icons/Wand_ico.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Convo starter" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="Record"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="Record_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Speech to text using AI"
                            Visibility="{Binding WhisperModule.Settings.IsRecording, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="22"
                                    Margin="3,0,0,0"
                                    Opacity="0.5"
                                    Source="/Img/Icons/SpeechToText.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Speech to text" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="StopRecord"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="StopRecord_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Stop recording"
                            Visibility="{Binding WhisperModule.Settings.IsRecording, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="22"
                                    Margin="3,0,0,0"
                                    Opacity="0.5"
                                    Source="/Img/Icons/SpeechToText.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Stop STT" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>
                        <Button
                            x:Name="NextwordPredict"
                            Width="auto"
                            Height="34"
                            Margin="3,0"
                            Click="NextwordPredict_Click"
                            Style="{DynamicResource LINK_Button_style}"
                            ToolTip="Predict next word by AI"
                            Visibility="Collapsed"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                            <StackPanel Orientation="Horizontal" RenderOptions.BitmapScalingMode="HighQuality">
                                <Image
                                    Width="22"
                                    Margin="3,0,0,0"
                                    Opacity="0.5"
                                    Source="/Img/Icons/Wand_ico.png" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Albert Sans Thin"
                                    FontSize="13"
                                    Foreground="#FF8D7DB9"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Predict next word" />

                            </StackPanel>
                            <Button.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="0"
                                    Opacity="0.3"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="LightGray" />
                            </Button.Effect>
                        </Button>

                    </StackPanel>

                </Grid>
            </Grid>

            <Grid Margin="-10,0,0,0" Visibility="{Binding Char_Limit}">
                <Grid.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Offset="1" Color="#FF3B3054" />
                        <GradientStop Offset="0" Color="#FF41375C" />
                    </LinearGradientBrush>
                </Grid.Background>
                <StackPanel
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    RenderOptions.BitmapScalingMode="NearestNeighbor">
                    <TextBlock
                        Grid.Column="0"
                        Margin="0,3,0,0"
                        FontFamily="Albert Sans Thin"
                        FontSize="16"
                        Foreground="#FF9983AD"
                        Text="Some integrations can't be showed because a limit on characters">
                        <TextBlock.Effect>
                            <DropShadowEffect
                                BlurRadius="10"
                                Opacity="1"
                                ShadowDepth="0"
                                Color="#251153" />
                        </TextBlock.Effect>
                    </TextBlock>
                </StackPanel>
            </Grid>





            <Grid Grid.ColumnSpan="2" Background="#FF2D1267">

                <Grid.Effect>
                    <DropShadowEffect
                        BlurRadius="12"
                        Direction="-120"
                        Opacity="0.2"
                        RenderingBias="Performance"
                        ShadowDepth="5"
                        Color="black" />
                </Grid.Effect>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="143" />
                    <ColumnDefinition Width="123" />
                    <ColumnDefinition Width="123" />
                    <ColumnDefinition Width="122" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border>
                    <Grid x:Name="Drag_area" MouseDown="Drag_area_MouseDown">
                        <TextBlock
                            Grid.Column="0"
                            Padding="0,12,0,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="16"
                            Foreground="White"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Text="MagicChatbox">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="315"
                                    Opacity="1"
                                    ShadowDepth="0"
                                    Color="LightBlue" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock
                            Grid.Column="0"
                            Padding="20,12,0,0"
                            HorizontalAlignment="left"
                            VerticalAlignment="top"
                            FontFamily="Albert Sans Thin"
                            FontSize="10"
                            Foreground="MediumPurple"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Text="VRC OSC">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="15"
                                    Direction="315"
                                    Opacity="1"
                                    ShadowDepth="0"
                                    Color="LightBlue" />
                            </TextBlock.Effect>
                        </TextBlock>
                    </Grid>
                </Border>

                <Grid
                    Grid.Column="1"
                    Margin="3,0,3,0"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button
                        Name="MenuButton_0"
                        Margin="0,0,0,0"
                        Background="#FF240E55"
                        BorderThickness="0"
                        Click="MenuButton_0_Click"
                        Content="Integrations"
                        Cursor="Hand"
                        FontFamily="Comfortaa Light"
                        FontSize="18"
                        FontWeight="Normal"
                        Foreground="White"
                        Style="{DynamicResource MenuItemStyle}" />
                    <Border
                        Height="4"
                        VerticalAlignment="Top"
                        Background="#FFAEA7ED"
                        IsHitTestVisible="False"
                        Visibility="{Binding MenuItem_0_Visibility}" />
                </Grid>
                <Grid
                    Grid.Column="2"
                    Margin="3,0,3,0"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button
                        Name="MenuButton_1"
                        Margin="0,0,0,0"
                        Background="#FF240E55"
                        BorderThickness="0"
                        Click="MenuButton_1_Click"
                        Content="Status"
                        Cursor="Hand"
                        FontFamily="Comfortaa Light"
                        FontSize="18"
                        FontWeight="Normal"
                        Foreground="White"
                        Style="{DynamicResource MenuItemStyle}" />
                    <Border
                        Height="4"
                        VerticalAlignment="Top"
                        Background="#FFAEA7ED"
                        IsHitTestVisible="False"
                        Visibility="{Binding MenuItem_1_Visibility}" />
                </Grid>
                <Grid
                    Grid.Column="3"
                    Margin="3,0,3,0"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button
                        Name="MenuButton_2"
                        Margin="0,0,0,0"
                        Background="#FF240E55"
                        BorderThickness="0"
                        Click="MenuButton_2_Click"
                        Content="Chatting"
                        Cursor="Hand"
                        FontFamily="Comfortaa Light"
                        FontSize="18"
                        FontWeight="Normal"
                        Foreground="White"
                        Style="{DynamicResource MenuItemStyle}" />
                    <Border
                        Height="4"
                        VerticalAlignment="Top"
                        Background="#FFAEA7ED"
                        IsHitTestVisible="False"
                        Visibility="{Binding MenuItem_2_Visibility}" />
                </Grid>
                <Grid
                    Grid.Column="4"
                    Margin="3,0,3,0"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button
                        Name="MenuButton_3"
                        Margin="0,0,0,0"
                        Background="#FF240E55"
                        BorderThickness="0"
                        Click="MenuButton_3_Click"
                        Content="Options"
                        Cursor="Hand"
                        FontFamily="Comfortaa Light"
                        FontSize="18"
                        FontWeight="Normal"
                        Foreground="White"
                        Style="{DynamicResource MenuItemStyle}" />
                    <Border
                        Height="4"
                        VerticalAlignment="Top"
                        Background="#FFAEA7ED"
                        IsHitTestVisible="False"
                        Visibility="{Binding MenuItem_3_Visibility}" />
                </Grid>

                <Grid Grid.Column="6" HorizontalAlignment="Right">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="130" />
                        <ColumnDefinition Width="45" />
                        <ColumnDefinition Width="50" />
                    </Grid.ColumnDefinitions>
                    <Button
                        Name="Button_close"
                        Grid.Column="2"
                        Width="45"
                        Height="22"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        Background="#004D0606"
                        BorderThickness="0"
                        Click="Button_close_Click"
                        Cursor="Hand"
                        Style="{DynamicResource CloseButtonStyle}"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                        <Image Margin="2" Source="img/icons/Close_ico.png" />
                    </Button>
                    <Button
                        Name="Button_minimize"
                        Grid.Column="1"
                        Width="45"
                        Height="22"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        Background="#00473C89"
                        BorderThickness="0"
                        Click="Button_minimize_Click"
                        Cursor="Hand"
                        Style="{DynamicResource SubtractButtonStyle}"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                        <Image Margin="2" Source="img/icons/subtract_ico.png" />
                    </Button>
                    <Grid
                        Grid.Column="1"
                        Grid.ColumnSpan="2"
                        Margin="-5,22,0,0">
                        <Grid.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <LinearGradientBrush.RelativeTransform>
                                    <TransformGroup>
                                        <ScaleTransform CenterX="0.5" CenterY="0.5" />
                                        <SkewTransform CenterX="0.5" CenterY="0.5" />
                                        <RotateTransform Angle="180" CenterX="0.5" CenterY="0.5" />
                                        <TranslateTransform />
                                    </TransformGroup>
                                </LinearGradientBrush.RelativeTransform>
                                <GradientStop Color="#FF431F91" />
                                <GradientStop Offset="1" Color="#FF2D1265" />
                            </LinearGradientBrush>
                        </Grid.Background>

                        <StackPanel
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            Orientation="Vertical">
                            <TextBlock
                                Width="53"
                                VerticalAlignment="Center"
                                FontSize="14"
                                FontWeight="DemiBold"
                                Text="Running">
                                <TextBlock.Foreground>
                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                        <GradientStop Offset="0.006" Color="#FF411E8C" />
                                        <GradientStop Offset="1" Color="#FFA28FCE" />
                                    </LinearGradientBrush>
                                </TextBlock.Foreground>
                            </TextBlock>
                            <TextBlock
                                Width="18"
                                Margin="0,-5,0,0"
                                VerticalAlignment="Center"
                                FontSize="14"
                                FontWeight="Bold"
                                Text="VR"
                                Visibility="{Binding IsVRRunning, Converter={StaticResource InverseBoolToHiddenConverter}}">
                                <TextBlock.Foreground>
                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                        <GradientStop Offset="0.106" Color="#FF3A1A7E" />
                                        <GradientStop Offset="0.627" Color="#FFCA577C" />
                                    </LinearGradientBrush>
                                </TextBlock.Foreground>
                            </TextBlock>
                            <TextBlock
                                Margin="0,-5,0,0"
                                FontSize="18"
                                FontWeight="Bold"
                                Text="DESKTOP"
                                Visibility="{Binding IsVRRunning, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                <TextBlock.Foreground>
                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                        <GradientStop Offset="0.109" Color="#FF38197C" />
                                        <GradientStop Offset="0.827" Color="#FF54B955" />
                                    </LinearGradientBrush>
                                </TextBlock.Foreground>
                            </TextBlock>
                        </StackPanel>

                    </Grid>

                    <Grid Grid.Column="0" WindowChrome.IsHitTestVisibleInChrome="True">
                        <StackPanel
                            Margin="0,0,5,0"
                            Background="#FF3B2075"
                            Orientation="Vertical">
                            <TextBlock
                                Margin="0,5,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="#FFB3B0B9"
                                Text="Send to VRChat" />
                            <CheckBox
                                Name="MasterSwitch"
                                Width="62"
                                Margin="0,5,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="MasterSwitch_Click"
                                IsChecked="{Binding MasterSwitch, Mode=TwoWay}"
                                Opacity="0.90"
                                Style="{DynamicResource Switch}" />
                        </StackPanel>

                    </Grid>
                </Grid>

            </Grid>
            <Grid
                Grid.Row="1"
                Grid.Column="1"
                Width="225"
                Background="#FF42385D">
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                    <RowDefinition Height="auto" />
                    <RowDefinition />

                </Grid.RowDefinitions>
                <Grid.Effect>
                    <DropShadowEffect
                        BlurRadius="5"
                        Direction="-100"
                        Opacity="0.1"
                        RenderingBias="Performance"
                        ShadowDepth="15"
                        Color="DarkBlue" />
                </Grid.Effect>
                <Grid
                    Grid.Row="3"
                    Height="auto"
                    VerticalAlignment="Bottom">
                    <TextBlock
                        Padding="0,0,0,30"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Stretch"
                        FontFamily="Albert Sans Thin"
                        FontSize="12"
                        Foreground="#FF7D7397"
                        Text="{Binding UpdateStatustxt}" />

                    <StackPanel VerticalAlignment="Bottom">
                        <TextBlock
                            x:Name="GitHubChanges"
                            Width="auto"
                            Margin="0,0,0,10"
                            HorizontalAlignment="Center"
                            Cursor="Hand"
                            FontFamily="Albert Sans Thin"
                            FontSize="8.5"
                            Foreground="#26A1FA"
                            MouseUp="GitHubChanges_MouseUp"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Text="View changes on GitHub"
                            TextDecorations="Underline"
                            Visibility="{Binding CanUpdateLabel, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="10"
                                    Opacity="0.3"
                                    ShadowDepth="0"
                                    Color="#251153" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                            <Button
                                x:Name="CheckUpdateBtnn"
                                Margin="0,-3"
                                Padding="0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Click="CheckUpdateBtnn_Click"
                                Style="{StaticResource CircleButton}">
                                <Image
                                    Width="12"
                                    Height="12"
                                    RenderOptions.BitmapScalingMode="Linear"
                                    Source="/Img/Icons/Load_ico.png" />

                            </Button>
                            <TextBlock
                                Margin="5,0.5,5,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Stretch"
                                FontFamily="Albert Sans Thin"
                                FontSize="13"
                                Foreground="#9D91D2"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Text="{Binding AppVersion.VersionNumber}">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="15"
                                        Opacity="0.9"
                                        ShadowDepth="0"
                                        Color="{Binding VersionTxtColor}" />
                                </TextBlock.Effect>

                            </TextBlock>
                            <TextBlock
                                Name="NewVersion"
                                Margin="0,0.5,5,8"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Bottom"
                                Cursor="Hand"
                                FontFamily="Albert Sans Thin"
                                FontSize="12"
                                Foreground="{Binding VersionTxtColor}"
                                MouseUp="NewVersion_MouseUp"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Text="{Binding VersionTxt}">
                                <TextBlock.Style>
                                    <Style TargetType="{x:Type TextBlock}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding VersionTxtUnderLine}" Value="True">
                                                <Setter Property="TextDecorations" Value="Underline" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>

                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="15"
                                        Opacity="0.7"
                                        ShadowDepth="0"
                                        Color="{Binding VersionTxtColor}" />
                                </TextBlock.Effect>
                            </TextBlock>
                        </StackPanel>
                    </StackPanel>

                </Grid>
                <TextBlock
                    Grid.Column="0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontFamily="Albert Sans Thin"
                    FontSize="16"
                    Foreground="White"
                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                    Text="Preview">
                    <TextBlock.Effect>
                        <DropShadowEffect
                            BlurRadius="10"
                            Opacity="1"
                            ShadowDepth="0"
                            Color="#251153" />
                    </TextBlock.Effect>
                </TextBlock>
                <TextBlock
                    Grid.Column="0"
                    Margin="0,0,10,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    FontFamily="Albert Sans Thin"
                    FontSize="12"
                    Foreground="#FF8D7DB9"
                    Text="{Binding OSCmsg_countUI}">
                    <TextBlock.Effect>
                        <DropShadowEffect
                            BlurRadius="10"
                            Opacity="1"
                            ShadowDepth="0"
                            Color="#251153" />
                    </TextBlock.Effect>
                </TextBlock>
                <StackPanel Grid.Row="3" VerticalAlignment="Top">

                    <StackPanel
                        Width="214"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        Orientation="Vertical">
                        <Border CornerRadius="0,0,15,15" Visibility="{Binding AfkModule.Settings.EnableAfkDetection, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="#FF2E1565" />
                                    <GradientStop Offset="1" Color="#FF523E64" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Column="0">
                                    <StackPanel
                                        Margin="5,3,0,3"
                                        HorizontalAlignment="Center"
                                        Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            FontWeight="SemiBold"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="Away from keyboard:">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <!--  Default values  -->
                                                    <Setter Property="Foreground" Value="#B49AD1" />
                                                    <Setter Property="Text" Value="Inactive" />
                                                    <Setter Property="Opacity" Value="0.7" />
                                                    <Setter Property="Effect">
                                                        <Setter.Value>
                                                            <DropShadowEffect
                                                                BlurRadius="5"
                                                                Direction="315"
                                                                Opacity="1"
                                                                ShadowDepth="0"
                                                                Color="Black" />
                                                        </Setter.Value>
                                                    </Setter>
                                                    <!--  Change values based on AfkModule.IsAfk  -->
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding AfkModule.IsAfk}" Value="True">
                                                            <Setter Property="Foreground" Value="#7DD9AA" />
                                                            <Setter Property="Text" Value="Active" />
                                                            <Setter Property="Opacity" Value="0.9" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                            <TextBlock.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="5"
                                                    Direction="315"
                                                    Opacity="1"
                                                    ShadowDepth="0"
                                                    Color="Black" />
                                            </TextBlock.Effect>
                                        </TextBlock>
                                        <TextBlock
                                            Padding="5,0,0,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            FontFamily="Albert Sans Thin"
                                            FontSize="14"
                                            FontWeight="SemiBold"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <!--  Default values  -->
                                                    <Setter Property="Foreground" Value="#D38D9C" />
                                                    <Setter Property="Text" Value="Inactive" />
                                                    <Setter Property="Opacity" Value="0.7" />
                                                    <Setter Property="Effect">
                                                        <Setter.Value>
                                                            <DropShadowEffect
                                                                BlurRadius="5"
                                                                Direction="315"
                                                                Opacity="1"
                                                                ShadowDepth="0"
                                                                Color="Black" />
                                                        </Setter.Value>
                                                    </Setter>
                                                    <!--  Change values based on AfkModule.IsAfk  -->
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding AfkModule.IsAfk}" Value="True">
                                                            <Setter Property="Foreground" Value="#7DF8AA" />
                                                            <Setter Property="Text" Value="Active" />
                                                            <Setter Property="Opacity" Value="1" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>

                                    </StackPanel>
                                    <Grid.Style>
                                        <Style TargetType="Grid">
                                            <!--  Default values  -->
                                            <Setter Property="Background" Value="#391E72" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding AfkModule.IsAfk}" Value="True">
                                                    <Setter Property="Background" Value="#562EAD" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>
                                </Grid>
                                <Grid Grid.Row="1">
                                    <StackPanel
                                        Margin="0,5,0,5"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <StackPanel
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Visibility="{Binding AfkModule.VRModeLabelActive, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Padding="0,0,1,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="12"
                                                FontWeight="SemiBold"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <!--  Default values  -->
                                                        <Setter Property="Foreground" Value="#B49AD1" />
                                                        <Setter Property="Text" Value="Will be AFK in:" />
                                                        <Setter Property="Opacity" Value="0.7" />
                                                        <Setter Property="Effect">
                                                            <Setter.Value>
                                                                <DropShadowEffect
                                                                    BlurRadius="5"
                                                                    Direction="315"
                                                                    Opacity="1"
                                                                    ShadowDepth="0"
                                                                    Color="Black" />
                                                            </Setter.Value>
                                                        </Setter>
                                                        <!--  Change values based on AfkModule.IsAfk  -->
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding AfkModule.IsAfk}" Value="True">
                                                                <Setter Property="Text" Value="You are AFK for:" />
                                                                <Setter Property="Opacity" Value="0.9" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="5"
                                                        Direction="315"
                                                        Opacity="1"
                                                        ShadowDepth="0"
                                                        Color="Black" />
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock
                                                Padding="3,0,5,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Albert Sans Thin"
                                                FontSize="12"
                                                FontWeight="SemiBold"
                                                RenderOptions.BitmapScalingMode="NearestNeighbor">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <!--  Default values  -->
                                                        <Setter Property="Foreground" Value="#BEBED3" />
                                                        <Setter Property="Text" Value="{Binding AfkModule.RemainingTimeUntilAFK}" />
                                                        <Setter Property="Opacity" Value="0.7" />
                                                        <Setter Property="Effect">
                                                            <Setter.Value>
                                                                <DropShadowEffect
                                                                    BlurRadius="5"
                                                                    Direction="315"
                                                                    Opacity="1"
                                                                    ShadowDepth="0"
                                                                    Color="Black" />
                                                            </Setter.Value>
                                                        </Setter>
                                                        <!--  Change values based on AfkModule.IsAfk  -->
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding AfkModule.IsAfk}" Value="True">
                                                                <Setter Property="Text" Value="{Binding AfkModule.TimeCurrentlyAFK}" />
                                                                <Setter Property="Opacity" Value="0.9" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="5"
                                                        Direction="315"
                                                        Opacity="1"
                                                        ShadowDepth="0"
                                                        Color="Black" />
                                                </TextBlock.Effect>
                                            </TextBlock>
                                        </StackPanel>

                                        <StackPanel
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Visibility="{Binding AfkModule.VRModeLabelActive, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock
                                                Padding="5,0"
                                                FontSize="12"
                                                Foreground="#B49AD1"
                                                Text="Paused, VR active" />
                                        </StackPanel>


                                        <CheckBox
                                            Width="50"
                                            Height="18"
                                            Margin="0,0,0,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            Checked="Update_Click"
                                            Content="AFK now"
                                            IsChecked="{Binding AfkModule.Settings.OverrideAfk}"
                                            Style="{DynamicResource GlowyToggleButton}"
                                            Unchecked="Update_Click"
                                            Visibility="{Binding AfkModule.OverrideButtonVisible, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>


                                </Grid>


                            </Grid>
                        </Border>
                        <Button
                            x:Name="ToggleVoicebtn"
                            Width="101"
                            Height="27"
                            Margin="0,5,0,0"
                            HorizontalAlignment="Right"
                            local:ButtonProperties.ShadowTrigger="{Binding TTSBtnShadow}"
                            Click="ToggleVoicebtn_Click"
                            Content="{Binding ToggleVoiceText}"
                            Style="{DynamicResource Status_Button_style_Shadow}" />

                    </StackPanel>


                    <StackPanel
                        Width="80"
                        Height="20"
                        Margin="0,5"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top"
                        Orientation="Horizontal">
                        <TextBlock
                            Margin="0,2,5,0"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="13"
                            Foreground="#FF7D7397"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Text="TopMost">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="10"
                                    Opacity="0.5"
                                    ShadowDepth="0"
                                    Color="#251153" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <CheckBox
                            Width="20"
                            BorderBrush="#FF2D1265"
                            FontFamily="Comfortaa Light"
                            FontSize="12"
                            Foreground="#FFB9B5C1"
                            IsChecked="{Binding Topmost, Mode=TwoWay}"
                            Style="{DynamicResource SettingsCheckbox}" />
                    </StackPanel>
                    <StackPanel
                        Width="auto"
                        Height="auto"
                        Margin="5,0"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal"
                        Visibility="{Binding MenuItem_2_Visibility}">
                        <StackPanel Visibility="{Binding ChatLiveEdit, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">


                            <TextBlock
                                Margin="0,3,5,0"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="13"
                                Foreground="#FF7D7397"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Text="Live edit chats">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Opacity="0.5"
                                        ShadowDepth="0"
                                        Color="#251153" />
                                </TextBlock.Effect>
                            </TextBlock>
                        </StackPanel>

                        <CheckBox
                            Width="20"
                            BorderBrush="#FF2D1265"
                            FontFamily="Comfortaa Light"
                            FontSize="12"
                            Foreground="#FFB9B5C1"
                            IsChecked="{Binding RealTimeChatEdit, Mode=TwoWay}"
                            Style="{DynamicResource SettingsCheckbox}"
                            Visibility="{Binding ChatLiveEdit, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                    <StackPanel
                        Width="auto"
                        Height="auto"
                        Margin="5,5"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal"
                        Visibility="{Binding MenuItem_2_Visibility}">
                        <TextBlock
                            Margin="0,0,5,0"
                            VerticalAlignment="Center"
                            FontFamily="Albert Sans Thin"
                            FontSize="13"
                            Foreground="#FF7D7397"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Text="Text to speech">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="10"
                                    Opacity="0.5"
                                    ShadowDepth="0"
                                    Color="#251153" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <CheckBox
                            Width="20"
                            BorderBrush="#FF2D1265"
                            FontFamily="Comfortaa Light"
                            FontSize="12"
                            Foreground="#FFB9B5C1"
                            IsChecked="{Binding TTSTikTokEnabled, Mode=TwoWay}"
                            Style="{DynamicResource SettingsCheckbox}" />
                    </StackPanel>

                    <StackPanel Visibility="{Binding TTSTikTokEnabled, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                        <StackPanel
                            Width="176"
                            Height="22"
                            Margin="0,5"
                            HorizontalAlignment="Right"
                            Orientation="Horizontal"
                            Visibility="{Binding MenuItem_2_Visibility}">
                            <TextBlock
                                Margin="0,0,5,0"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="13"
                                Foreground="#FF7D7397"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Text="Voice">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Opacity="0.5"
                                        ShadowDepth="0"
                                        Color="#251153" />
                                </TextBlock.Effect>
                            </TextBlock>
                            <ComboBox
                                x:Name="TikTokTTSVoices_combo"
                                Width="135"
                                Height="21"
                                BorderBrush="#FF020000"
                                DisplayMemberPath="DisplayName"
                                FontSize="11.5"
                                ItemsSource="{Binding TikTokTTSVoices, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                Opacity="0.4"
                                SelectedItem="{Binding SelectedTikTokTTSVoice, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedValuePath="ApiName"
                                SelectionChanged="TikTokTTSVoices_combo_SelectionChanged" />
                        </StackPanel>

                        <StackPanel
                            Width="211"
                            Height="22"
                            Margin="0,0,0,0"
                            HorizontalAlignment="Right"
                            Orientation="Horizontal"
                            Visibility="{Binding MenuItem_2_Visibility}">
                            <TextBlock
                                Width="69"
                                Margin="0,0,0,3"
                                VerticalAlignment="Center"
                                FontFamily="Albert Sans Thin"
                                FontSize="13"
                                Foreground="#FF7D7397"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Text="TTS volume">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Opacity="0.5"
                                        ShadowDepth="0"
                                        Color="#251153" />
                                </TextBlock.Effect>
                            </TextBlock>
                            <Slider
                                x:Name="VolumeSlider"
                                Width="134.5"
                                Height="12"
                                Margin="2.2,0,4.5,0"
                                Maximum="1"
                                Minimum="0"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Style="{StaticResource CustomSlider}"
                                Value="{Binding Path=TTSVolume, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <Slider.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Opacity="0.3"
                                        ShadowDepth="0"
                                        Color="#251153" />
                                </Slider.Effect>
                            </Slider>
                        </StackPanel>
                    </StackPanel>

                </StackPanel>

                <Grid
                    Grid.Row="1"
                    Height="157"
                    Margin="5,0,6,0"
                    VerticalAlignment="Top">
                    <Border Background="#FF7F759A">
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                    </Border>
                    <TextBox
                        Margin="8,8,8,5"
                        d:Text="This song is paused 💖💬⏸🎵"
                        AllowDrop="False"
                        Background="Transparent"
                        BorderThickness="0"
                        Focusable="False"
                        FontFamily="Albert Sans Thin"
                        FontSize="14"
                        Foreground="#7E7498"
                        IsHitTestVisible="False"
                        IsReadOnly="True"
                        IsTabStop="False"
                        MaxLength="144"
                        Text="{Binding OSCtoSent}"
                        TextAlignment="Center"
                        TextWrapping="Wrap">
                        <TextBox.Effect>
                            <DropShadowEffect
                                BlurRadius="13"
                                Opacity="0.8"
                                ShadowDepth="0"
                                Color="white" />
                        </TextBox.Effect>
                    </TextBox>
                    <TextBox
                        Margin="8,8,8,5"
                        d:Text="This song is paused 💖💬⏸🎵"
                        AllowDrop="False"
                        Background="Transparent"
                        BorderThickness="0"
                        Focusable="False"
                        FontFamily="Albert Sans Thin"
                        FontSize="14"
                        Foreground="#FFDFDDE2"
                        IsHitTestVisible="False"
                        IsReadOnly="True"
                        IsTabStop="False"
                        MaxLength="144"
                        Text="{Binding OSCtoSent}"
                        TextAlignment="Center"
                        TextWrapping="Wrap" />



                </Grid>
                <Grid
                    Grid.Row="2"
                    Height="auto"
                    Margin="5,2,6,15"
                    VerticalAlignment="Top"
                    Visibility="{Binding AfkModule.Settings.EnableAfkDetection, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />





                <Button
                    x:Name="Discord"
                    Width="auto"
                    Margin="6,3,195,5"
                    Click="Discord_Click"
                    Opacity="0.6"
                    Style="{DynamicResource LINK_Button_style}">
                    <StackPanel Orientation="Horizontal">
                        <Image
                            Width="20"
                            Height="20"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Source="/Img/Icons/Discord.png" />
                    </StackPanel>
                </Button>
                <Button
                    x:Name="Github"
                    Width="auto"
                    Margin="32,3,169,5"
                    Click="Github_Click"
                    Opacity="0.4"
                    Style="{DynamicResource LINK_Button_style}">
                    <StackPanel Orientation="Horizontal">
                        <Image
                            Width="20"
                            Height="20"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Source="/Img/Icons/GitHub.png" />
                    </StackPanel>
                </Button>

            </Grid>
            <ListBox
                x:Name="IntegrationsList"
                Grid.Row="1"
                Grid.Column="0"
                HorizontalAlignment="Stretch"
                d:Visibility="Hidden"
                Background="Transparent"
                BorderThickness="0"
                RenderOptions.BitmapScalingMode="NearestNeighbor"
                ScrollViewer.CanContentScroll="False"
                ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                Visibility="{Binding MenuItem_0_Visibility}">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border
                                        Width="{Binding ActualWidth, ElementName=IntegrationsList}"
                                        Padding="10,0,19,0"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}">
                                        <ContentPresenter />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBoxItem Name="StatusItem" Opacity="{Binding Status_Opacity}">
                    <Border Margin="5" CornerRadius="5">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Color="DarkSlateBlue" />
                                <GradientStop Offset="1" Color="#FF302573" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Image  -->
                            <Image
                                Grid.Column="0"
                                Width="35"
                                Margin="5"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Effect="{StaticResource ImageShadowEffect}"
                                Source="/Img/Icons/PersonalMsg_ico.png" />
                            <!--  Text Content  -->
                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center">
                                <StackPanel
                                    Margin="0,3,0,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Personal status"
                                        TextWrapping="Wrap" />
                                    <ToggleButton
                                        Grid.Column="1"
                                        Width="60"
                                        Height="19"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="DESKTOP"
                                        IsChecked="{Binding IntgrStatus_DESKTOP, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonDT}" />
                                    <ToggleButton
                                        Grid.Column="1"
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="VR"
                                        IsChecked="{Binding IntgrStatus_VR, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonVR}" />
                                    <Button
                                        Margin="10,0,0,0"
                                        Command="{Binding ActivateSettingCommand}"
                                        CommandParameter="Settings_Status"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Style="{StaticResource CircleButton}">
                                        <Image
                                            Width="15"
                                            Height="15"
                                            Source="/Img/Icons/Next_ico.png" />
                                        <Button.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Opacity="0.4"
                                                ShadowDepth="0"
                                                Color="#251153" />
                                        </Button.Effect>
                                    </Button>
                                </StackPanel>

                                <TextBlock
                                    Margin="0,3,0,0"
                                    Effect="{StaticResource TextBlockShadowEffect}"
                                    FontFamily="Comfortaa Light"
                                    FontSize="13"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="With this integration, you can write an epic status message that will be displayed in the chatbox.."
                                    TextWrapping="Wrap">
                                    <TextBlock.Foreground>
                                        <RadialGradientBrush>
                                            <GradientStop Color="White" />
                                            <GradientStop Offset="1" Color="#FFC3A9FF" />
                                        </RadialGradientBrush>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                            <!--  Toggle Button  -->
                            <Grid Grid.Column="2">
                                <CheckBox
                                    Name="Status_switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrStatus, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />
                            </Grid>
                        </Grid>
                    </Border>
                </ListBoxItem>
                <ListBoxItem Name="WindowActivityItem" Opacity="{Binding Window_Opacity}">
                    <Border Margin="5,0,5,5" CornerRadius="5">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Color="DarkSlateBlue" />
                                <GradientStop Offset="1" Color="#FF302573" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Image  -->
                            <Image
                                Grid.Column="0"
                                Width="45"
                                Margin="1"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Effect="{StaticResource ImageShadowEffect}"
                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                Source="/Img/Icons/WindowActivity_ico.png" />
                            <!--  Text Content  -->
                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center">
                                <StackPanel
                                    Margin="0,3,0,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Window activity"
                                        TextWrapping="Wrap" />
                                    <ToggleButton
                                        Width="60"
                                        Height="19"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="DESKTOP"
                                        IsChecked="{Binding IntgrWindowActivity_DESKTOP, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonDT}" />
                                    <ToggleButton
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="VR"
                                        IsChecked="{Binding IntgrWindowActivity_VR, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonVR}" />
                                    <ToggleButton
                                        Width="57"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="Force VR"
                                        IsChecked="{Binding IntgrScanForce, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButton}"
                                        Visibility="{Binding IntgrWindowActivity_VR, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />

                                    <Button
                                        Margin="10,0,0,0"
                                        Command="{Binding ActivateSettingCommand}"
                                        CommandParameter="Settings_WindowActivity"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Style="{StaticResource CircleButton}">
                                        <Image
                                            Width="15"
                                            Height="15"
                                            Source="/Img/Icons/Next_ico.png" />
                                        <Button.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Opacity="0.4"
                                                ShadowDepth="0"
                                                Color="#251153" />
                                        </Button.Effect>
                                    </Button>
                                </StackPanel>

                                <TextBlock
                                    Margin="0,3,0,0"
                                    Effect="{StaticResource TextBlockShadowEffect}"
                                    FontFamily="Comfortaa Light"
                                    FontSize="13"
                                    RenderTransformOrigin="0.5,0.5"
                                    Text="With this integration, you can show if you're in VR or desktop mode, and in desktop mode, it displays the currently focused application."
                                    TextWrapping="Wrap">
                                    <TextBlock.Foreground>
                                        <RadialGradientBrush>
                                            <GradientStop Color="White" />
                                            <GradientStop Offset="1" Color="#FFC3A9FF" />
                                        </RadialGradientBrush>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                            <!--  Toggle Button  -->
                            <Grid Grid.Column="2">
                                <CheckBox
                                    Name="WindowActivity_switch"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrScanWindowActivity, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />
                            </Grid>
                        </Grid>
                    </Border>
                </ListBoxItem>
                <ListBoxItem Name="HeartRateItem" Opacity="{Binding HeartRate_Opacity}">
                    <Border Margin="5,0,5,5" CornerRadius="5">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Color="DarkSlateBlue" />
                                <GradientStop Offset="1" Color="#FF302573" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Image  -->
                            <Image
                                Grid.Column="0"
                                Width="35"
                                Margin="5"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Effect="{StaticResource ImageShadowEffect}"
                                RenderOptions.BitmapScalingMode="Linear"
                                Source="/Img/Icons/HeartRate_ico.png" />
                            <!--  Text Content  -->
                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center">
                                <StackPanel
                                    Margin="0,3,0,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Pulsoid Heart Rate"
                                        TextWrapping="Wrap" />
                                    <ToggleButton
                                        Width="60"
                                        Height="19"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="DESKTOP"
                                        IsChecked="{Binding IntgrHeartRate_DESKTOP, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonDT}" />
                                    <ToggleButton
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="VR"
                                        IsChecked="{Binding IntgrHeartRate_VR, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonVR}" />
                                    <ToggleButton
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="OSC"
                                        IsChecked="{Binding IntgrHeartRate_OSC, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButton}" />
                                    <Button
                                        Margin="10,0,0,0"
                                        Command="{Binding ActivateSettingCommand}"
                                        CommandParameter="Settings_HeartRate"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Style="{StaticResource CircleButton}">
                                        <Image
                                            Width="15"
                                            Height="15"
                                            Source="/Img/Icons/Next_ico.png" />
                                        <Button.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Opacity="0.4"
                                                ShadowDepth="0"
                                                Color="#251153" />
                                        </Button.Effect>
                                    </Button>
                                    <Border
                                        x:Name="MainDiscoundButton_grid"
                                        Width="auto"
                                        Height="20"
                                        Margin="8,0,0,0"
                                        CornerRadius="5"
                                        Cursor="Hand"
                                        MouseUp="MainDiscoundButton_grid_MouseUp">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0.4,0" EndPoint="0.5,1">
                                                <GradientStop Color="LightSeaGreen" />
                                                <GradientStop Offset="1" Color="#FF302573" />
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock
                                                Padding="5,0,0,0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="15"
                                                FontWeight="DemiBold"
                                                Foreground="AliceBlue"
                                                Opacity="0.9"
                                                Text="-15%">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="5"
                                                        Direction="0"
                                                        Opacity="0.5"
                                                        ShadowDepth="0"
                                                        Color="Black" />
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock
                                                Padding="1,0,3,0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Top"
                                                FontSize="10"
                                                FontWeight="DemiBold"
                                                Foreground="AliceBlue"
                                                Opacity="0.8"
                                                Text="always">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="5"
                                                        Direction="0"
                                                        Opacity="0.5"
                                                        ShadowDepth="0"
                                                        Color="Black" />
                                                </TextBlock.Effect>
                                            </TextBlock>
                                        </StackPanel>


                                        <Border.Effect>
                                            <DropShadowEffect
                                                BlurRadius="10"
                                                Direction="0"
                                                Opacity="0.9"
                                                ShadowDepth="0"
                                                Color="LightSeaGreen" />
                                        </Border.Effect>
                                    </Border>
                                    <Border Visibility="{Binding HeartRateConnector.PulsoidAccessError, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <TextBlock
                                            Margin="5,0,0,0"
                                            VerticalAlignment="Center"
                                            Effect="{StaticResource TextBlockShadowEffect}"
                                            FontFamily="Comfortaa Light"
                                            FontSize="12"
                                            Foreground="#ABA4B8"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="{Binding HeartRateConnector.HeartRateLastUpdate, StringFormat='{}{0:T}'}"
                                            Visibility="{Binding IntgrHeartRate, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </Border>


                                    <TextBlock
                                        Margin="5,0,0,0"
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="12"
                                        Foreground="PaleVioletRed"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Something went wrong, check settings"
                                        Visibility="{Binding HeartRateConnector.PulsoidAccessError, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    <Border Visibility="{Binding HeartRateConnector.PulsoidAccessError, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <TextBlock
                                            Margin="5,0,0,0"
                                            VerticalAlignment="Center"
                                            Effect="{StaticResource TextBlockShadowEffect}"
                                            FontFamily="Comfortaa Light"
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Foreground="LightSeaGreen"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="No device connected"
                                            Visibility="{Binding HeartRateConnector.PulsoidDeviceOnline, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </Border>

                                </StackPanel>

                                <TextBlock
                                    Margin="0,3,0,0"
                                    Effect="{StaticResource TextBlockShadowEffect}"
                                    FontFamily="Comfortaa Light"
                                    FontSize="13"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="This integration displays your heart rate in the chatbox and can send it to OSC, similar to the retired 'HRtoVRChat.' Compatible only with Pulsoid."
                                    TextWrapping="Wrap">
                                    <TextBlock.Foreground>
                                        <RadialGradientBrush>
                                            <GradientStop Color="White" />
                                            <GradientStop Offset="1" Color="#FFC3A9FF" />
                                        </RadialGradientBrush>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                            <!--  Toggle Button  -->
                            <Grid Grid.Column="2">
                                <CheckBox
                                    Name="NewHR_Switch"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrHeartRate, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />
                            </Grid>
                        </Grid>
                    </Border>
                </ListBoxItem>
                <ListBoxItem Name="ComponentStatsItem" Opacity="{Binding ComponentStat_Opacity}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <Border
                            Grid.Row="1"
                            Margin="10,-15,10,5"
                            d:Visibility="Visible"
                            Background="#230E52"
                            CornerRadius="0,0,5,5"
                            Visibility="{Binding ComponentStatsRunning, Converter={StaticResource InverseBoolToHiddenConverter}}">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Border Margin="5,15,5,5" CornerRadius="5">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                        <GradientStop Color="DarkSlateBlue" />
                                        <GradientStop Offset="1" Color="#FF302573" />
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Grid>
                                    <StackPanel Margin="4,4" Orientation="Horizontal">
                                        <CheckBox
                                            Height="23"
                                            Margin="3,0"
                                            Content="CPU"
                                            IsChecked="{Binding IsCPUEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="{Binding isCPUAvailable, Converter={StaticResource BoolToOpacityConverter}}"
                                            Style="{StaticResource GlowyToggleButtonMediaLink}" />
                                        <CheckBox
                                            Height="23"
                                            Margin="3,0"
                                            Content="GPU"
                                            IsChecked="{Binding IsGPUEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="{Binding IsGPUAvailable, Converter={StaticResource BoolToOpacityConverter}}"
                                            Style="{StaticResource GlowyToggleButtonMediaLink}" />
                                        <CheckBox
                                            Height="23"
                                            Margin="3,0"
                                            Content="VRAM"
                                            IsChecked="{Binding IsVRAMEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="{Binding isVRAMAvailable, Converter={StaticResource BoolToOpacityConverter}}"
                                            Style="{StaticResource GlowyToggleButtonMediaLink}" />
                                        <CheckBox
                                            Height="23"
                                            Margin="3,0"
                                            Content="RAM"
                                            IsChecked="{Binding IsRAMEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Opacity="{Binding isRAMAvailable, Converter={StaticResource BoolToOpacityConverter}}"
                                            Style="{StaticResource GlowyToggleButtonMediaLink}" />

                                        <TextBlock
                                            Margin="7,0,0,0"
                                            VerticalAlignment="Center"
                                            d:Text=":( sorry"
                                            d:Visibility="Visible"
                                            FontFamily="Comfortaa Light"
                                            FontSize="12"
                                            Foreground="#9B7FD9"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="{Binding ComponentStatsError, UpdateSourceTrigger=PropertyChanged}"
                                            TextWrapping="Wrap"
                                            Visibility="{Binding IsThereAComponentThatIsNotAvailable, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBlock.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="10"
                                                    Opacity="1"
                                                    ShadowDepth="0"
                                                    Color="#8B2FFA" />
                                            </TextBlock.Effect>
                                        </TextBlock>

                                    </StackPanel>
                                    <StackPanel
                                        HorizontalAlignment="Right"
                                        d:Visibility="Visible"
                                        Orientation="Horizontal"
                                        Visibility="{Binding IsThereAComponentThatIsNotGettingTempOrWattage, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <Button
                                            x:Name="RestartApplicationAsAdmin"
                                            Height="30"
                                            Margin="3"
                                            VerticalAlignment="Top"
                                            Click="RestartApplicationAsAdmin_Click"
                                            Opacity="0.7"
                                            Style="{StaticResource Status_Button_style}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image
                                                            Height="18"
                                                            Margin="4,0,4,0"
                                                            Source="/Img/Icons/admin.png" />
                                                        <TextBlock
                                                            Margin="0,-2,5,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="15"
                                                            Text="Some stats need admin rights" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                    </StackPanel>
                                </Grid>


                            </Border>
                        </Border>
                        <Border
                            Grid.Row="0"
                            Margin="5,0,5,5"
                            CornerRadius="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="DarkSlateBlue" />
                                    <GradientStop Offset="1" Color="#FF302573" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid Margin="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <!--  Image  -->
                                <Image
                                    Grid.Column="0"
                                    Width="35"
                                    Margin="5"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Effect="{StaticResource ImageShadowEffect}"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Source="/Img/Icons/ComponentStats_ico.png" />
                                <!--  Text Content  -->
                                <StackPanel
                                    Grid.Column="1"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Center">
                                    <StackPanel
                                        Margin="0,3,0,0"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Effect="{StaticResource TextBlockShadowEffect}"
                                            FontFamily="Comfortaa Light"
                                            FontSize="20"
                                            Foreground="White"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="Component ˢᵗᵃᵗˢ"
                                            TextWrapping="Wrap" />
                                        <ToggleButton
                                            Width="60"
                                            Height="19"
                                            Margin="10,2,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Content="DESKTOP"
                                            IsChecked="{Binding IntgrComponentStats_DESKTOP, Mode=TwoWay}"
                                            Style="{StaticResource GlowyToggleButtonDT}" />
                                        <ToggleButton
                                            Width="30"
                                            Height="19"
                                            Margin="5,2,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Content="VR"
                                            IsChecked="{Binding IntgrComponentStats_VR, Mode=TwoWay}"
                                            Style="{StaticResource GlowyToggleButtonVR}" />
                                        <Button
                                            Margin="10,0,0,0"
                                            Command="{Binding ActivateSettingCommand}"
                                            CommandParameter="Settings_ComponentStats"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource CircleButton}">
                                            <Image
                                                Width="15"
                                                Height="15"
                                                Source="/Img/Icons/Next_ico.png" />
                                            <Button.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="5"
                                                    Opacity="0.4"
                                                    ShadowDepth="0"
                                                    Color="#251153" />
                                            </Button.Effect>

                                        </Button>

                                        <TextBlock
                                            Margin="5,0,0,0"
                                            VerticalAlignment="Center"
                                            Effect="{StaticResource TextBlockShadowEffect}"
                                            FontFamily="Comfortaa Light"
                                            FontSize="12"
                                            Foreground="#ABA4B8"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="{Binding ComponentStatsLastUpdate, StringFormat='{}{0:T}'}"
                                            Visibility="{Binding IntgrComponentStats, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                    <TextBlock
                                        Margin="0,3,0,0"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="With this integration, you can display your CPU, GPU, RAM, and VRAM usage in real-time."
                                        TextWrapping="Wrap">
                                        <TextBlock.Foreground>
                                            <RadialGradientBrush>
                                                <GradientStop Color="White" />
                                                <GradientStop Offset="1" Color="#FFC3A9FF" />
                                            </RadialGradientBrush>
                                        </TextBlock.Foreground>
                                    </TextBlock>
                                </StackPanel>
                                <!--  Toggle Button  -->
                                <Grid Grid.Column="2">
                                    <CheckBox
                                        Name="ComponentStats_Switch"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Click="Update_Click"
                                        IsChecked="{Binding IntgrComponentStats, Mode=TwoWay}"
                                        Style="{DynamicResource Switch}" />
                                </Grid>
                            </Grid>
                        </Border>

                    </Grid>

                </ListBoxItem>
                <ListBoxItem Name="NetworkStatsItem" Opacity="{Binding NetworkStats_Opacity}">
                    <Border Margin="5,0,5,5" CornerRadius="5">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Offset="0" Color="DarkSlateBlue" />
                                <GradientStop Offset="1" Color="#FF302573" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Image  -->
                            <Image
                                Grid.Column="0"
                                Width="35"
                                Margin="5"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Effect="{StaticResource ImageShadowEffect}"
                                RenderOptions.BitmapScalingMode="Fant"
                                Source="/Img/Icons/NetworkStats_ico.png" />
                            <!--  Text Content  -->
                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center">
                                <StackPanel
                                    Margin="0,3,0,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Network ˢᵗᵃᵗˢ"
                                        TextWrapping="Wrap" />
                                    <ToggleButton
                                        Width="60"
                                        Height="19"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="DESKTOP"
                                        IsChecked="{Binding IntgrNetworkStatistics_DESKTOP, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonDT}" />
                                    <ToggleButton
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="VR"
                                        IsChecked="{Binding IntgrNetworkStatistics_VR, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonVR}" />
                                    <Button
                                        Margin="10,0,0,0"
                                        Command="{Binding ActivateSettingCommand}"
                                        CommandParameter="Settings_NetworkStatistics"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Style="{StaticResource CircleButton}">
                                        <Image
                                            Width="15"
                                            Height="15"
                                            Source="/Img/Icons/Next_ico.png" />
                                        <Button.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Opacity="0.4"
                                                ShadowDepth="0"
                                                Color="#251153" />
                                        </Button.Effect>
                                    </Button>
                                </StackPanel>

                                <TextBlock
                                    Margin="0,3,0,0"
                                    Effect="{StaticResource TextBlockShadowEffect}"
                                    FontFamily="Comfortaa Light"
                                    FontSize="13"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Display real-time network stats such as download and upload speeds."
                                    TextWrapping="Wrap">
                                    <TextBlock.Foreground>
                                        <RadialGradientBrush>
                                            <GradientStop Color="White" />
                                            <GradientStop Offset="1" Color="#FFC3A9FF" />
                                        </RadialGradientBrush>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                            <!--  Toggle Button  -->
                            <Grid Grid.Column="2">
                                <CheckBox
                                    Name="NetworkStats_switch"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrNetworkStatistics, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />
                            </Grid>
                        </Grid>
                    </Border>
                </ListBoxItem>
                <ListBoxItem Name="TimeItem" Opacity="{Binding Time_Opacity}">
                    <Border Margin="5,0,5,5" CornerRadius="5">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Offset="0" Color="DarkSlateBlue" />
                                <GradientStop Offset="1" Color="#FF302573" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Image  -->
                            <Image
                                Grid.Column="0"
                                Width="46"
                                Margin="0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Effect="{StaticResource ImageShadowEffect}"
                                RenderOptions.BitmapScalingMode="HighQuality"
                                Source="/Img/Icons/SystemTime_ico.png" />
                            <!--  Text Content  -->
                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center">
                                <StackPanel
                                    Margin="0,3,0,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Current time"
                                        TextWrapping="Wrap" />
                                    <ToggleButton
                                        Width="60"
                                        Height="19"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="DESKTOP"
                                        IsChecked="{Binding IntgrCurrentTime_DESKTOP, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonDT}" />
                                    <ToggleButton
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="VR"
                                        IsChecked="{Binding IntgrCurrentTime_VR, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonVR}" />
                                    <Button
                                        Margin="10,0,0,0"
                                        Command="{Binding ActivateSettingCommand}"
                                        CommandParameter="Settings_Time"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Style="{StaticResource CircleButton}">
                                        <Image
                                            Width="15"
                                            Height="15"
                                            Source="/Img/Icons/Next_ico.png" />
                                        <Button.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Opacity="0.4"
                                                ShadowDepth="0"
                                                Color="#251153" />
                                        </Button.Effect>
                                    </Button>
                                </StackPanel>

                                <TextBlock
                                    Margin="0,3,0,0"
                                    Effect="{StaticResource TextBlockShadowEffect}"
                                    FontFamily="Comfortaa Light"
                                    FontSize="13"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    Text="Displays local machine time and allows conversion to different time zones."
                                    TextWrapping="Wrap">
                                    <TextBlock.Foreground>
                                        <RadialGradientBrush>
                                            <GradientStop Color="White" />
                                            <GradientStop Offset="1" Color="#FFC3A9FF" />
                                        </RadialGradientBrush>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                            <!--  Toggle Button  -->
                            <Grid Grid.Column="2">
                                <CheckBox
                                    Name="SystemTime_switch"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrScanWindowTime, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />
                            </Grid>
                        </Grid>
                    </Border>
                </ListBoxItem>
                <ListBoxItem Name="SoundpadItem" Opacity="{Binding Soundpad_Opacity}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <Border
                            Grid.Row="1"
                            Margin="0"
                            d:Visibility="Visible"
                            Background="Transparent"
                            Visibility="{Binding SoundpadModule.EnablePanel, Converter={StaticResource InverseBoolToHiddenConverter}}">

                            <Border
                                Width="auto"
                                Height="35"
                                Margin="5,0,5,5"
                                VerticalAlignment="Stretch"
                                Background="#3A1F74"
                                CornerRadius="5">
                                <Border.Effect>
                                    <DropShadowEffect
                                        BlurRadius="5"
                                        Direction="-23"
                                        RenderingBias="Performance"
                                        ShadowDepth="0"
                                        Color="DarkBlue" />
                                </Border.Effect>
                                <Grid>
                                    <Border
                                        Margin="0"
                                        BorderThickness="2,2,0,2"
                                        CornerRadius="4"
                                        IsHitTestVisible="False">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.0,0">
                                                <GradientStop Color="#3A1F74" />
                                                <GradientStop Offset="1" Color="#651A72" />
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Border.BorderBrush>
                                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.0,0">
                                                <GradientStop Color="#3A1F74" />
                                                <GradientStop Offset="1" Color="#B61BC1" />
                                            </LinearGradientBrush>
                                        </Border.BorderBrush>

                                    </Border>
                                    <StackPanel
                                        Margin="4,4"
                                        IsEnabled="{Binding SoundpadModule.IsSoundpadRunning}"
                                        Orientation="Horizontal">
                                        <Button
                                            x:Name="SoundPadPrevious"
                                            Width="auto"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Click="SoundPadPrevious_Click"
                                            Content="⏮ Previous"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource GlowyButtonSoundpadWithText}" />
                                        <Button
                                            x:Name="SoundPadNext"
                                            Width="auto"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Click="SoundPadNext_Click"
                                            Content="⏭ Next"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource GlowyButtonSoundpadWithText}" />
                                        <Button
                                            x:Name="SoundPadRandon"
                                            Width="auto"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Click="SoundPadRandon_Click"
                                            Content="🔄 Random"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource GlowyButtonSoundpadWithText}" />
                                        <Button
                                            x:Name="SoundPadPlay"
                                            Width="auto"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Click="SoundPadPlay_Click"
                                            Content="▶ Paused"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource GlowyButtonSoundpadWithText}"
                                            Visibility="{Binding SoundpadModule.PlayingNow, Converter={StaticResource InverseBoolToVisibilityConverter}}" />
                                        <Button
                                            x:Name="SoundPadPause"
                                            Width="auto"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Click="SoundPadPause_Click"
                                            Content="⏸ playing"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource GlowyButtonSoundpadWithText}"
                                            Visibility="{Binding SoundpadModule.PlayingNow, Converter={StaticResource InverseBoolToHiddenConverter}}" />
                                        <Button
                                            x:Name="SoundPadStop"
                                            Width="auto"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Click="SoundPadStop_Click"
                                            Content="⏹️ Stop"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource GlowyButtonSoundpadWithText}"
                                            Visibility="{Binding SoundpadModule.Stopped, Converter={StaticResource InverseBoolToVisibilityConverter}}" />

                                        <TextBlock
                                            Margin="7,0,0,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            d:Text=":( sorry"
                                            d:Visibility="Visible"
                                            FontFamily="Comfortaa Light"
                                            FontSize="12"
                                            Foreground="#9B7FD9"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="{Binding SoundpadModule.ErrorString}"
                                            TextWrapping="Wrap"
                                            Visibility="{Binding SoundpadModule.Error, Converter={StaticResource InverseBoolToHiddenConverter}}">
                                            <TextBlock.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="10"
                                                    Opacity="1"
                                                    ShadowDepth="0"
                                                    Color="#8B2FFA" />
                                            </TextBlock.Effect>
                                        </TextBlock>
                                    </StackPanel>

                                </Grid>


                            </Border>
                        </Border>
                        <Border Margin="5,0,5,5" CornerRadius="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="DarkSlateBlue" />
                                    <GradientStop Offset="1" Color="#FF302573" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid Margin="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <!--  Image  -->
                                <Image
                                    Grid.Column="0"
                                    Width="35"
                                    Margin="5"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Effect="{StaticResource ImageShadowEffect}"
                                    Source="/Img/Icons/Soundpad.png" />
                                <!--  Text Content  -->
                                <StackPanel
                                    Grid.Column="1"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Center">
                                    <StackPanel
                                        Margin="0,3,0,0"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Effect="{StaticResource TextBlockShadowEffect}"
                                            FontFamily="Comfortaa Light"
                                            FontSize="20"
                                            Foreground="White"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="Soundpad"
                                            TextWrapping="Wrap" />
                                        <ToggleButton
                                            Width="60"
                                            Height="19"
                                            Margin="10,2,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Content="DESKTOP"
                                            IsChecked="{Binding IntgrSoundpad_DESKTOP, Mode=TwoWay}"
                                            Style="{StaticResource GlowyToggleButtonDT}" />
                                        <ToggleButton
                                            Width="30"
                                            Height="19"
                                            Margin="5,2,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Content="VR"
                                            IsChecked="{Binding IntgrSoundpad_VR, Mode=TwoWay}"
                                            Style="{StaticResource GlowyToggleButtonVR}" />
                                        <Button
                                            Margin="10,0,0,0"
                                            Command="{Binding ActivateSettingCommand}"
                                            CommandParameter="Settings_Soundpad"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource CircleButton}">
                                            <Image
                                                Width="15"
                                                Height="15"
                                                Source="/Img/Icons/Next_ico.png" />
                                            <Button.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="5"
                                                    Opacity="0.4"
                                                    ShadowDepth="0"
                                                    Color="#251153" />
                                            </Button.Effect>
                                        </Button>
                                    </StackPanel>

                                    <TextBlock
                                        Margin="0,3,0,0"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        TextWrapping="Wrap">
                                        <TextBlock.Foreground>
                                            <RadialGradientBrush>
                                                <GradientStop Color="White" />
                                                <GradientStop Offset="1" Color="#FFC3A9FF" />
                                            </RadialGradientBrush>
                                        </TextBlock.Foreground>
                                        <Run Text="Display audio clips from Soundpad during playback; hidden when paused or inactive." />
                                    </TextBlock>
                                </StackPanel>
                                <!--  Toggle Button  -->
                                <Grid Grid.Column="2">
                                    <CheckBox
                                        Name="Soundpad_switch"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Click="Update_Click"
                                        IsChecked="{Binding IntgrSoundpad, Mode=TwoWay}"
                                        Style="{DynamicResource Switch}" />
                                </Grid>
                            </Grid>
                        </Border>

                    </Grid>

                </ListBoxItem>

                <ListBoxItem
                    Name="SpotifyItem"
                    Margin="3"
                    Opacity="{Binding Spotify_Opacity}"
                    Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                    <Border Margin="5" CornerRadius="5">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Color="DarkSlateBlue" />
                                <GradientStop Offset="1" Color="#FF302573" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="5"
                                Direction="-23"
                                RenderingBias="Performance"
                                ShadowDepth="0"
                                Color="DarkBlue" />
                        </Border.Effect>
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Image  -->
                            <Image
                                Grid.Column="0"
                                Width="35"
                                Margin="5"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Effect="{StaticResource ImageShadowEffect}"
                                Source="/Img/Icons/spotify_ico.png" />
                            <!--  Text Content  -->
                            <StackPanel
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center">
                                <StackPanel
                                    Margin="0,3,0,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="20"
                                        Foreground="White"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="Spotify"
                                        TextWrapping="Wrap" />
                                    <ToggleButton
                                        Width="60"
                                        Height="19"
                                        Margin="10,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="DESKTOP"
                                        IsChecked="{Binding IntgrSpotifyStatus_DESKTOP, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonDT}" />
                                    <ToggleButton
                                        Width="30"
                                        Height="19"
                                        Margin="5,2,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Content="VR"
                                        IsChecked="{Binding IntgrSpotifyStatus_VR, Mode=TwoWay}"
                                        Style="{StaticResource GlowyToggleButtonVR}" />
                                    <Button
                                        Margin="10,0,0,0"
                                        Command="{Binding ActivateSettingCommand}"
                                        CommandParameter="Settings_MediaLink"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Style="{StaticResource CircleButton}">
                                        <Image
                                            Width="15"
                                            Height="15"
                                            Source="/Img/Icons/Next_ico.png" />
                                        <Button.Effect>
                                            <DropShadowEffect
                                                BlurRadius="5"
                                                Opacity="0.4"
                                                ShadowDepth="0"
                                                Color="#251153" />
                                        </Button.Effect>
                                    </Button>
                                </StackPanel>

                                <TextBlock
                                    Margin="0,3,0,0"
                                    Effect="{StaticResource TextBlockShadowEffect}"
                                    FontFamily="Comfortaa Light"
                                    FontSize="13"
                                    RenderOptions.BitmapScalingMode="NearestNeighbor"
                                    TextWrapping="Wrap">
                                    <TextBlock.Foreground>
                                        <RadialGradientBrush>
                                            <GradientStop Color="White" />
                                            <GradientStop Offset="1" Color="#FFC3A9FF" />
                                        </RadialGradientBrush>
                                    </TextBlock.Foreground>
                                    <Run Text="Control your Spotify music right from the stream. Display current playing song and artist information." />
                                </TextBlock>
                            </StackPanel>
                            <!--  Toggle Button  -->
                            <Grid Grid.Column="2">
                                <CheckBox
                                    Name="Spotify_switch"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Click="Update_Click"
                                    IsChecked="{Binding IntgrScanSpotify_OLD, Mode=TwoWay}"
                                    Style="{DynamicResource Switch}" />
                            </Grid>
                        </Grid>
                    </Border>
                </ListBoxItem>

                <ListBoxItem
                    Name="MediaLinkItem"
                    Margin="3"
                    Opacity="{Binding MediaLink_Opacity}"
                    Visibility="{Binding DisableMediaLink, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <Border Margin="5,0,5,5" CornerRadius="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                    <GradientStop Color="DarkSlateBlue" />
                                    <GradientStop Offset="1" Color="#FF302573" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <Grid Margin="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <!--  Image  -->
                                <Image
                                    Grid.Column="0"
                                    Width="35"
                                    Margin="5"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Effect="{StaticResource ImageShadowEffect}"
                                    RenderOptions.BitmapScalingMode="HighQuality"
                                    Source="/Img/Icons/MediaLink_ico.png" />
                                <!--  Text Content  -->
                                <StackPanel
                                    Grid.Column="1"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Center">
                                    <StackPanel
                                        Margin="0,3,0,0"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Effect="{StaticResource TextBlockShadowEffect}"
                                            FontFamily="Comfortaa Light"
                                            FontSize="20"
                                            Foreground="White"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Text="MediaLink"
                                            TextWrapping="Wrap" />
                                        <ToggleButton
                                            Width="60"
                                            Height="19"
                                            Margin="10,2,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Content="DESKTOP"
                                            IsChecked="{Binding IntgrMediaLink_DESKTOP, Mode=TwoWay}"
                                            Style="{StaticResource GlowyToggleButtonDT}" />
                                        <ToggleButton
                                            Width="30"
                                            Height="19"
                                            Margin="5,2,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Content="VR"
                                            IsChecked="{Binding IntgrMediaLink_VR, Mode=TwoWay}"
                                            Style="{StaticResource GlowyToggleButtonVR}" />
                                        <Button
                                            Margin="10,0,0,0"
                                            Command="{Binding ActivateSettingCommand}"
                                            CommandParameter="Settings_MediaLink"
                                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                                            Style="{StaticResource CircleButton}">
                                            <Image
                                                Width="15"
                                                Height="15"
                                                Source="/Img/Icons/Next_ico.png" />
                                            <Button.Effect>
                                                <DropShadowEffect
                                                    BlurRadius="5"
                                                    Opacity="0.4"
                                                    ShadowDepth="0"
                                                    Color="#251153" />
                                            </Button.Effect>
                                        </Button>
                                    </StackPanel>

                                    <TextBlock
                                        Margin="0,3,0,0"
                                        Effect="{StaticResource TextBlockShadowEffect}"
                                        FontFamily="Comfortaa Light"
                                        FontSize="13"
                                        Foreground="LightGray"
                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                        Text="With this integration, you can show the song and author on individual Media Sessions (Spotify, Chrome, etc)"
                                        TextWrapping="Wrap" />
                                </StackPanel>
                                <!--  Toggle Button  -->
                                <Grid Grid.Column="2">
                                    <CheckBox
                                        Name="MediaLink_switch"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Click="Update_Click"
                                        IsChecked="{Binding IntgrScanMediaLink, Mode=TwoWay}"
                                        Style="{DynamicResource Switch}" />
                                </Grid>
                            </Grid>
                        </Border>
                        <Border
                            Grid.Row="1"
                            Height="auto"
                            Margin="0,-3,0,0"
                            d:Visibility="Visible"
                            Background="Transparent"
                            CornerRadius="0,0,5,5"
                            Visibility="{Binding MediaSessions.Count, Converter={StaticResource CountToVisibilityConverter}}">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="5"
                                    Direction="-23"
                                    RenderingBias="Performance"
                                    ShadowDepth="0"
                                    Color="DarkBlue" />
                            </Border.Effect>
                            <ItemsControl
                                Height="auto"
                                Padding="0,0,0,5"
                                Background="Transparent"
                                ItemsSource="{Binding MediaSessions}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border
                                            Width="auto"
                                            Margin="5,5,5,0"
                                            VerticalAlignment="Stretch"
                                            Background="#3A1F74"
                                            CornerRadius="5">
                                            <Grid Margin="10,5">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition
                                                        Width="auto"
                                                        MinWidth="60"
                                                        MaxWidth="115" />
                                                    <ColumnDefinition Width="auto" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <!--  RadioButton linked to IsActive  -->

                                                <Border
                                                    Margin="-10,-5,-5,-5"
                                                    BorderThickness="3,3,0,3"
                                                    CornerRadius="4,0,0,4"
                                                    IsHitTestVisible="False"
                                                    Visibility="{Binding IsActive, Converter={StaticResource InverseBoolToHiddenConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.0,0">
                                                            <GradientStop Color="#3A1F74" />
                                                            <GradientStop Offset="1" Color="#230E53" />
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                    <Border.BorderBrush>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.0,0">
                                                            <GradientStop Color="#3A1F74" />
                                                            <GradientStop Offset="1" Color="#A38ED1" />
                                                        </LinearGradientBrush>
                                                    </Border.BorderBrush>

                                                </Border>
                                                <Border
                                                    Margin="-10,-5,-5,-5"
                                                    BorderThickness="3,3,0,3"
                                                    CornerRadius="4,0,0,4"
                                                    IsHitTestVisible="False"
                                                    Visibility="{Binding IsActive, Converter={StaticResource InverseBoolToVisibilityConverter}, UpdateSourceTrigger=PropertyChanged}">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.0,0">
                                                            <GradientStop Color="#3A1F74" />
                                                            <GradientStop Offset="1" Color="#2B165C" />
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                    <Border.BorderBrush>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.0,0">
                                                            <GradientStop Color="#3A1F74" />
                                                            <GradientStop Offset="1" Color="#482D7F" />
                                                        </LinearGradientBrush>
                                                    </Border.BorderBrush>

                                                </Border>
                                                <RadioButton
                                                    Grid.Column="0"
                                                    Width="auto"
                                                    Margin="0,-1,0,0"
                                                    VerticalAlignment="Center"
                                                    VerticalContentAlignment="Center"
                                                    Checked="Update_Click"
                                                    Content="{Binding FriendlyAppName}"
                                                    Cursor="Hand"
                                                    Foreground="#DBD9DE"
                                                    GroupName="MediaSessions"
                                                    IsChecked="{Binding IsActive}"
                                                    Unchecked="Update_Click">

                                                    <RadioButton.Template>
                                                        <ControlTemplate TargetType="RadioButton">
                                                            <ContentPresenter
                                                                x:Name="contentPresenter"
                                                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                Content="{TemplateBinding Content}"
                                                                ContentTemplate="{TemplateBinding ContentTemplate}" />

                                                            <ControlTemplate.Triggers>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding Path=IsChecked, RelativeSource={RelativeSource Self}}" Value="False" />
                                                                        <Condition Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="contentPresenter" Property="Effect">
                                                                        <Setter.Value>
                                                                            <DropShadowEffect
                                                                                BlurRadius="15"
                                                                                Opacity="1"
                                                                                ShadowDepth="0"
                                                                                Color="White" />
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </MultiDataTrigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </RadioButton.Template>
                                                </RadioButton>


                                                <!--  Label for FriendlyAppName  -->

                                                <!--  CheckBoxes for IsVideo, ShowArtist, ShowTitle  -->
                                                <StackPanel
                                                    Grid.Column="1"
                                                    Margin="7,0,0,0"
                                                    Orientation="Horizontal">
                                                    <CheckBox
                                                        Width="auto"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Checked="Update_Click"
                                                        Content="VIDEO"
                                                        IsChecked="{Binding IsVideo}"
                                                        Style="{DynamicResource GlowyToggleButtonMediaLink}"
                                                        Unchecked="Update_Click" />
                                                    <CheckBox
                                                        Width="auto"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Checked="Update_Click"
                                                        Content="ARTIST"
                                                        IsChecked="{Binding ShowArtist}"
                                                        Style="{DynamicResource GlowyToggleButtonMediaLink}"
                                                        Unchecked="Update_Click" />
                                                    <CheckBox
                                                        Width="auto"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Checked="Update_Click"
                                                        Content="TITLE"
                                                        IsChecked="{Binding ShowTitle}"
                                                        Style="{DynamicResource GlowyToggleButtonMediaLink}"
                                                        Unchecked="Update_Click" />
                                                    <Button
                                                        x:Name="MediaSessionPlay"
                                                        Width="25"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Click="MediaSessionPausePlay_Click"
                                                        Content="▶"
                                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                        Style="{StaticResource GlowyButtonMediaLinkWithText}"
                                                        Tag="{Binding}"
                                                        Visibility="{Binding PlayingNow, Converter={StaticResource InverseBoolToVisibilityConverter}}" />
                                                    <Button
                                                        x:Name="MediaSessionPause"
                                                        Width="25"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Click="MediaSessionPausePlay_Click"
                                                        Content="⏸"
                                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                        Style="{StaticResource GlowyButtonMediaLinkWithText}"
                                                        Tag="{Binding}"
                                                        Visibility="{Binding PlayingNow, Converter={StaticResource InverseBoolToHiddenConverter}}" />
                                                    <StackPanel
                                                        Width="170"
                                                        Margin="5,0,5,0"
                                                        VerticalAlignment="Center">
                                                        <Border Visibility="{Binding IsLiveTime, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                            <ProgressBar
                                                                x:Name="MediaProgressbar"
                                                                Margin="0,0,0,0"
                                                                BorderThickness="5"
                                                                Cursor="Hand"
                                                                Effect="{Binding TimePeekEnabled, Converter={StaticResource BoolToBlurEffectConverter}}"
                                                                MouseLeftButtonDown="MediaProgressbar_MouseLeftButtonDown"
                                                                Style="{StaticResource MediaPlayerProgress}"
                                                                Tag="{Binding}"
                                                                Value="{Binding TimePosition, Mode=OneWay}" />
                                                        </Border>
                                                        <Grid Visibility="{Binding IsLiveTime, Converter={StaticResource InverseBoolToHiddenConverter}}">
                                                            <Grid>
                                                                <ProgressBar
                                                                    Margin="0,0,0,0"
                                                                    BorderThickness="5"
                                                                    Style="{StaticResource MediaPlayerProgress}"
                                                                    Visibility="{Binding TimePeekEnabled, Converter={StaticResource InverseBoolToHiddenConverter}}"
                                                                    Value="69" />
                                                                <Grid.Effect>
                                                                    <BlurEffect Radius="10" />
                                                                </Grid.Effect>
                                                            </Grid>
                                                            <TextBox
                                                                Padding="0,2,0,0"
                                                                d:Text="LIVE"
                                                                AllowDrop="False"
                                                                Background="Transparent"
                                                                BorderThickness="0"
                                                                Focusable="False"
                                                                FontFamily="Albert Sans Thin"
                                                                FontSize="17"
                                                                FontWeight="Bold"
                                                                Foreground="#26FFFE"
                                                                IsHitTestVisible="False"
                                                                IsReadOnly="True"
                                                                Opacity="0.8"
                                                                RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                                Text="LIVE"
                                                                TextAlignment="Center">
                                                                <TextBox.Effect>
                                                                    <DropShadowEffect
                                                                        BlurRadius="25"
                                                                        Opacity="1"
                                                                        RenderingBias="Performance"
                                                                        ShadowDepth="0"
                                                                        Color="#25A0F9" />
                                                                </TextBox.Effect>
                                                            </TextBox>
                                                        </Grid>

                                                    </StackPanel>
                                                    <Button
                                                        x:Name="MediaSessionPrevious"
                                                        Width="25"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Click="MediaSessionPrevious_Click"
                                                        Content="⏮"
                                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                        Style="{StaticResource GlowyButtonMediaLinkWithText}"
                                                        Tag="{Binding}" />
                                                    <Button
                                                        x:Name="MediaSessionNext"
                                                        Width="25"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Click="MediaSessionNext_Click"
                                                        Content="⏭"
                                                        RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                        Style="{StaticResource GlowyButtonMediaLinkWithText}"
                                                        Tag="{Binding}" />

                                                </StackPanel>

                                                <StackPanel />
                                                <StackPanel
                                                    Grid.Column="2"
                                                    Margin="0,0,-6,0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">

                                                    <CheckBox
                                                        Height="25"
                                                        Margin="0,0,3,0"
                                                        Checked="Update_Click"
                                                        Content="AUTOSWITCH ON PLAY"
                                                        IsChecked="{Binding AutoSwitch}"
                                                        Style="{DynamicResource GlowyToggleButtonMediaLink}"
                                                        Unchecked="Update_Click" />
                                                    <CheckBox
                                                        Width="25"
                                                        Height="25"
                                                        Margin="3,0"
                                                        VerticalAlignment="Center"
                                                        Checked="Update_Click"
                                                        Content=""
                                                        IsChecked="{Binding KeepSaved}"
                                                        Style="{DynamicResource GlowyToggleButtonMediaLinkWithImage}"
                                                        Unchecked="Update_Click" />

                                                </StackPanel>

                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </Grid>


                </ListBoxItem>






            </ListBox>

        </Grid>
    </Border>
</Window>